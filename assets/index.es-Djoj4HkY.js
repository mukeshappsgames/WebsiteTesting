const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DQDEnq1p.js","assets/index-BTcfF13Z.js","assets/index-FkSTfN6C.css"])))=>i.map(i=>d[i]);
import{u as Ro,v as re,e as Ao,w as L0,x as ff,y as pf,z as kc,A as To,C as M0,D as Lr,E as Ei,V as z0,M as U0,N as G,F as H0,G as Pc,J as k0,K as K0,L as B0,O as Xh,P as F0,Q as V0,R as G0,S as el,$ as W0,T as J0,U as Q0,W as Xn,X as tl,Y as Y0,Z as Z0,a0 as df,a1 as qr,a2 as X0,a3 as rl,a4 as vn,a5 as At,a6 as Ft,a7 as bi,a8 as ar,a9 as ew,aa as mn,ab as gf,ac as tw,ad as rw,ae as iw,af as yf,ag as nw,ah as vf,ai as mf,aj as _n,ak as Sc,al as bo,am as bn,an as sw,ao as Eo,ap as ow,aq as aw,ar as cw,as as uw,at as po,au as hw,av as lw,aw as uc,ax as il,ay as fw,az as pw,aA as dw,aB as nl,aC as gw,aD as yw,aE as vw,aF as mw,aG as ww,aH as _w,aI as bw,aJ as Jn,aK as wf,aL as hc,aM as Ew,aN as Iw,_ as xw}from"./index-BTcfF13Z.js";import{e as yr,$ as Kc}from"./events-Cz1f4djm.js";const Pw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Sw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Ow=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Rw(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Aw(a);return}return t}function Aw(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function go(a,t={}){if(typeof a!="string")return a;const r=a.trim();if(a[0]==='"'&&a.endsWith('"')&&!a.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!Ow.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(Pw.test(a)||Sw.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,Rw)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function Tw(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function qt(a,...t){try{return Tw(a(...t))}catch(r){return Promise.reject(r)}}function Cw(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function $w(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function Io(a){if(Cw(a))return String(a);if($w(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return Io(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function _f(){if(typeof Buffer>"u")throw new TypeError("[unstorage] Buffer is not supported!")}const Oc="base64:";function Nw(a){if(typeof a=="string")return a;_f();const t=Buffer.from(a).toString("base64");return Oc+t}function Dw(a){return typeof a!="string"||!a.startsWith(Oc)?a:(_f(),Buffer.from(a.slice(Oc.length),"base64"))}function or(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function jw(...a){return or(a.join(":"))}function yo(a){return a=or(a),a?a+":":""}const qw="memory",Lw=()=>{const a=new Map;return{name:qw,getInstance:()=>a,hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,r){a.set(t,r)},setItemRaw(t,r){a.set(t,r)},removeItem(t){a.delete(t)},getKeys(){return[...a.keys()]},clear(){a.clear()},dispose(){a.clear()}}};function Mw(a={}){const t={mounts:{"":a.driver||Lw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const _ of t.mountpoints)if(p.startsWith(_))return{base:_,relativeKey:p.slice(_.length),driver:t.mounts[_]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,_)=>t.mountpoints.filter(x=>x.startsWith(p)||_&&p.startsWith(x)).map(x=>({relativeBase:p.length>x.length?p.slice(x.length):void 0,mountpoint:x,driver:t.mounts[x]})),o=(p,_)=>{if(t.watching){_=or(_);for(const x of t.watchListeners)x(p,_)}},c=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await sl(t.mounts[p],o,p)}},f=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},g=(p,_,x)=>{const T=new Map,D=A=>{let J=T.get(A.base);return J||(J={driver:A.driver,base:A.base,items:[]},T.set(A.base,J)),J};for(const A of p){const J=typeof A=="string",ee=or(J?A:A.key),ce=J?void 0:A.value,ae=J||!A.options?_:{..._,...A.options},oe=r(ee);D(oe).items.push({key:ee,value:ce,relativeKey:oe.relativeKey,options:ae})}return Promise.all([...T.values()].map(A=>x(A))).then(A=>A.flat())},v={hasItem(p,_={}){p=or(p);const{relativeKey:x,driver:T}=r(p);return qt(T.hasItem,x,_)},getItem(p,_={}){p=or(p);const{relativeKey:x,driver:T}=r(p);return qt(T.getItem,x,_).then(D=>go(D))},getItems(p,_){return g(p,_,x=>x.driver.getItems?qt(x.driver.getItems,x.items.map(T=>({key:T.relativeKey,options:T.options})),_).then(T=>T.map(D=>({key:jw(x.base,D.key),value:go(D.value)}))):Promise.all(x.items.map(T=>qt(x.driver.getItem,T.relativeKey,T.options).then(D=>({key:T.key,value:go(D)})))))},getItemRaw(p,_={}){p=or(p);const{relativeKey:x,driver:T}=r(p);return T.getItemRaw?qt(T.getItemRaw,x,_):qt(T.getItem,x,_).then(D=>Dw(D))},async setItem(p,_,x={}){if(_===void 0)return v.removeItem(p);p=or(p);const{relativeKey:T,driver:D}=r(p);D.setItem&&(await qt(D.setItem,T,Io(_),x),D.watch||o("update",p))},async setItems(p,_){await g(p,_,async x=>{if(x.driver.setItems)return qt(x.driver.setItems,x.items.map(T=>({key:T.relativeKey,value:Io(T.value),options:T.options})),_);x.driver.setItem&&await Promise.all(x.items.map(T=>qt(x.driver.setItem,T.relativeKey,Io(T.value),T.options)))})},async setItemRaw(p,_,x={}){if(_===void 0)return v.removeItem(p,x);p=or(p);const{relativeKey:T,driver:D}=r(p);if(D.setItemRaw)await qt(D.setItemRaw,T,_,x);else if(D.setItem)await qt(D.setItem,T,Nw(_),x);else return;D.watch||o("update",p)},async removeItem(p,_={}){typeof _=="boolean"&&(_={removeMeta:_}),p=or(p);const{relativeKey:x,driver:T}=r(p);T.removeItem&&(await qt(T.removeItem,x,_),(_.removeMeta||_.removeMata)&&await qt(T.removeItem,x+"$",_),T.watch||o("remove",p))},async getMeta(p,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),p=or(p);const{relativeKey:x,driver:T}=r(p),D=Object.create(null);if(T.getMeta&&Object.assign(D,await qt(T.getMeta,x,_)),!_.nativeOnly){const A=await qt(T.getItem,x+"$",_).then(J=>go(J));A&&typeof A=="object"&&(typeof A.atime=="string"&&(A.atime=new Date(A.atime)),typeof A.mtime=="string"&&(A.mtime=new Date(A.mtime)),Object.assign(D,A))}return D},setMeta(p,_,x={}){return this.setItem(p+"$",_,x)},removeMeta(p,_={}){return this.removeItem(p+"$",_)},async getKeys(p,_={}){p=yo(p);const x=n(p,!0);let T=[];const D=[];for(const A of x){const J=await qt(A.driver.getKeys,A.relativeBase,_);for(const ee of J){const ce=A.mountpoint+or(ee);T.some(ae=>ce.startsWith(ae))||D.push(ce)}T=[A.mountpoint,...T.filter(ee=>!ee.startsWith(A.mountpoint))]}return p?D.filter(A=>A.startsWith(p)&&A[A.length-1]!=="$"):D.filter(A=>A[A.length-1]!=="$")},async clear(p,_={}){p=yo(p),await Promise.all(n(p,!1).map(async x=>{if(x.driver.clear)return qt(x.driver.clear,x.relativeBase,_);if(x.driver.removeItem){const T=await x.driver.getKeys(x.relativeBase||"",_);return Promise.all(T.map(D=>x.driver.removeItem(D,_)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>ol(p)))},async watch(p){return await c(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(_=>_!==p),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(p,_){if(p=yo(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((x,T)=>T.length-x.length)),t.mounts[p]=_,t.watching&&Promise.resolve(sl(_,o,p)).then(x=>{t.unwatch[p]=x}).catch(console.error),v},async unmount(p,_=!0){p=yo(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),_&&await ol(t.mounts[p]),t.mountpoints=t.mountpoints.filter(x=>x!==p),delete t.mounts[p])},getMount(p=""){p=or(p)+":";const _=r(p);return{driver:_.driver,base:_.base}},getMounts(p="",_={}){return p=or(p),n(p,_.parents).map(T=>({driver:T.driver,base:T.mountpoint}))},keys:(p,_={})=>v.getKeys(p,_),get:(p,_={})=>v.getItem(p,_),set:(p,_,x={})=>v.setItem(p,_,x),has:(p,_={})=>v.hasItem(p,_),del:(p,_={})=>v.removeItem(p,_),remove:(p,_={})=>v.removeItem(p,_)};return v}function sl(a,t,r){return a.watch?a.watch((n,o)=>t(n,r+o)):()=>{}}async function ol(a){typeof a.dispose=="function"&&await qt(a.dispose)}function Fi(a){return new Promise((t,r)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>r(a.error)})}function bf(a,t){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Fi(r);return(o,c)=>n.then(f=>c(f.transaction(t,o).objectStore(t)))}let lc;function ns(){return lc||(lc=bf("keyval-store","keyval")),lc}function al(a,t=ns()){return t("readonly",r=>Fi(r.get(a)))}function zw(a,t,r=ns()){return r("readwrite",n=>(n.put(t,a),Fi(n.transaction)))}function Uw(a,t=ns()){return t("readwrite",r=>(r.delete(a),Fi(r.transaction)))}function Hw(a=ns()){return a("readwrite",t=>(t.clear(),Fi(t.transaction)))}function kw(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Fi(a.transaction)}function Kw(a=ns()){return a("readonly",t=>{if(t.getAllKeys)return Fi(t.getAllKeys());const r=[];return kw(t,n=>r.push(n.key)).then(()=>r)})}const Bw=a=>JSON.stringify(a,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Fw=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ss(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return Fw(a)}catch{return a}}function Bi(a){return typeof a=="string"?a:Bw(a)||""}const Vw="idb-keyval";var Gw=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",r=o=>t+o;let n;return a.dbName&&a.storeName&&(n=bf(a.dbName,a.storeName)),{name:Vw,options:a,async hasItem(o){return!(typeof await al(r(o),n)>"u")},async getItem(o){return await al(r(o),n)??null},setItem(o,c){return zw(r(o),c,n)},removeItem(o){return Uw(r(o),n)},getKeys(){return Kw(n)},clear(){return Hw(n)}}};const Ww="WALLET_CONNECT_V2_INDEXED_DB",Jw="keyvaluestorage";let Qw=class{constructor(){this.indexedDb=Mw({driver:Gw({dbName:Ww,storeName:Jw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Bi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,n){this[r]=String(n)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof fc<"u"&&fc.localStorage?xo.exports=fc.localStorage:typeof window<"u"&&window.localStorage?xo.exports=window.localStorage:xo.exports=new t})();function Yw(a){var t;return[a[0],ss((t=a[1])!=null?t:"")]}class Zw{constructor(){this.localStorage=xo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Yw)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ss(r)}async setItem(t,r){this.localStorage.setItem(t,Bi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Xw="wc_storage_version",cl=1,e_=async(a,t,r)=>{const n=Xw,o=await t.getItem(n);if(o&&o>=cl){r(t);return}const c=await a.getKeys();if(!c.length){r(t);return}const f=[];for(;c.length;){const g=c.shift();if(!g)continue;const v=g.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){const p=await a.getItem(g);await t.setItem(g,p),f.push(g)}}await t.setItem(n,cl),r(t),t_(a,f)},t_=async(a,t)=>{t.length&&t.forEach(async r=>{await a.removeItem(r)})};let r_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Zw;this.storage=t;try{const r=new Qw;e_(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var En={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Rc=function(a,t){return Rc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Rc(a,t)};function i_(a,t){Rc(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ac=function(){return Ac=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Ac.apply(this,arguments)};function n_(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(r[n[o]]=a[n[o]]);return r}function s_(a,t,r,n){var o=arguments.length,c=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function o_(a,t){return function(r,n){t(r,n,a)}}function a_(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function c_(a,t,r,n){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function g(_){try{p(n.next(_))}catch(x){f(x)}}function v(_){try{p(n.throw(_))}catch(x){f(x)}}function p(_){_.done?c(_.value):o(_.value).then(g,v)}p((n=n.apply(a,t||[])).next())})}function u_(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(_){return v([p,_])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(_){p=[6,_],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function h_(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function l_(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Tc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ef(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return c}function f_(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(Ef(arguments[t]));return a}function p_(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function es(a){return this instanceof es?(this.v=a,this):new es(a)}function d_(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(T){n[T]&&(o[T]=function(D){return new Promise(function(A,J){c.push([T,D,A,J])>1||g(T,D)})})}function g(T,D){try{v(n[T](D))}catch(A){x(c[0][3],A)}}function v(T){T.value instanceof es?Promise.resolve(T.value.v).then(p,_):x(c[0][2],T)}function p(T){g("next",T)}function _(T){g("throw",T)}function x(T,D){T(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function g_(a){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,c){t[o]=a[o]?function(f){return(r=!r)?{value:es(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function y_(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Tc=="function"?Tc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(f){return new Promise(function(g,v){f=a[c](f),o(g,v,f.done,f.value)})}}function o(c,f,g,v){Promise.resolve(v).then(function(p){c({value:p,done:g})},f)}}function v_(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function m_(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function w_(a){return a&&a.__esModule?a:{default:a}}function __(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function b_(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const E_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ac},__asyncDelegator:g_,__asyncGenerator:d_,__asyncValues:y_,__await:es,__awaiter:c_,__classPrivateFieldGet:__,__classPrivateFieldSet:b_,__createBinding:h_,__decorate:s_,__exportStar:l_,__extends:i_,__generator:u_,__importDefault:w_,__importStar:m_,__makeTemplateObject:v_,__metadata:a_,__param:o_,__read:Ef,__rest:n_,__spread:f_,__spreadArrays:p_,__values:Tc},Symbol.toStringTag,{value:"Module"})),Co=Ro(E_);var kn={},pc={},Kn={};class Vi{}const I_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),x_=Ro(I_);var ul;function P_(){if(ul)return Kn;ul=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.IHeartBeat=void 0;const a=x_;class t extends a.IEvents{constructor(n){super()}}return Kn.IHeartBeat=t,Kn}var hl;function If(){return hl||(hl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Co.__exportStar(P_(),a)}(pc)),pc}var dc={},ki={},ll;function S_(){if(ll)return ki;ll=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.HEARTBEAT_EVENTS=ki.HEARTBEAT_INTERVAL=void 0;const a=re;return ki.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,ki.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ki}var fl;function xf(){return fl||(fl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Co.__exportStar(S_(),a)}(dc)),dc}var pl;function O_(){if(pl)return kn;pl=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.HeartBeat=void 0;const a=Co,t=yr,r=re,n=If(),o=xf();class c extends n.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const v=new c(g);return yield v.init(),v})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,v){this.events.on(g,v)}once(g,v){this.events.once(g,v)}off(g,v){this.events.off(g,v)}removeListener(g,v){this.events.removeListener(g,v)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return kn.HeartBeat=c,kn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=Co;t.__exportStar(O_(),a),t.__exportStar(If(),a),t.__exportStar(xf(),a)})(En);function R_(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}var A_=T_;function T_(a,t,r){var n=r&&r.stringify||R_,o=1;if(typeof a=="object"&&a!==null){var c=t.length+o;if(c===1)return a;var f=new Array(c);f[0]=n(a);for(var g=1;g<c;g++)f[g]=n(t[g]);return f.join(" ")}if(typeof a!="string")return a;var v=t.length;if(v===0)return a;for(var p="",_=1-o,x=-1,T=a&&a.length||0,D=0;D<T;){if(a.charCodeAt(D)===37&&D+1<T){switch(x=x>-1?x:0,a.charCodeAt(D+1)){case 100:case 102:if(_>=v||t[_]==null)break;x<D&&(p+=a.slice(x,D)),p+=Number(t[_]),x=D+2,D++;break;case 105:if(_>=v||t[_]==null)break;x<D&&(p+=a.slice(x,D)),p+=Math.floor(Number(t[_])),x=D+2,D++;break;case 79:case 111:case 106:if(_>=v||t[_]===void 0)break;x<D&&(p+=a.slice(x,D));var A=typeof t[_];if(A==="string"){p+="'"+t[_]+"'",x=D+2,D++;break}if(A==="function"){p+=t[_].name||"<anonymous>",x=D+2,D++;break}p+=n(t[_]),x=D+2,D++;break;case 115:if(_>=v)break;x<D&&(p+=a.slice(x,D)),p+=String(t[_]),x=D+2,D++;break;case 37:x<D&&(p+=a.slice(x,D)),p+="%",x=D+2,D++,_--;break}++_}++D}return x===-1?a:(x<T&&(p+=a.slice(x)),p)}const dl=A_;var C_=Fr;const ts=H_().console||{},$_={mapHttpRequest:vo,mapHttpResponse:vo,wrapRequestSerializer:gc,wrapResponseSerializer:gc,wrapErrorSerializer:gc,req:vo,res:vo,err:L_};function N_(a,t){return Array.isArray(a)?a.filter(function(n){return n!=="!stdSerializers.err"}):a===!0?Object.keys(t):!1}function Fr(a){a=a||{},a.browser=a.browser||{};const t=a.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=a.browser.write||ts;a.browser.write&&(a.browser.asObject=!0);const n=a.serializers||{},o=N_(a.browser.serialize,n);let c=a.browser.serialize;Array.isArray(a.browser.serialize)&&a.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const f=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),a.enabled===!1&&(a.level="silent");const g=a.level||"info",v=Object.create(r);v.log||(v.log=rs),Object.defineProperty(v,"levelVal",{get:_}),Object.defineProperty(v,"level",{get:x,set:T});const p={transmit:t,serialize:o,asObject:a.browser.asObject,levels:f,timestamp:M_(a)};v.levels=Fr.levels,v.level=g,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=rs,v.serializers=n,v._serialize=o,v._stdErrSerialize=c,v.child=D,t&&(v._logEvent=Cc());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function T(A){if(A!=="silent"&&!this.levels.values[A])throw Error("unknown level "+A);this._level=A,gn(p,v,"error","log"),gn(p,v,"fatal","error"),gn(p,v,"warn","error"),gn(p,v,"info","log"),gn(p,v,"debug","log"),gn(p,v,"trace","log")}function D(A,J){if(!A)throw new Error("missing bindings for child Pino");J=J||{},o&&A.serializers&&(J.serializers=A.serializers);const ee=J.serializers;if(o&&ee){var ce=Object.assign({},n,ee),ae=a.browser.serialize===!0?Object.keys(ce):o;delete A.serializers,$o([A],ae,ce,this._stdErrSerialize)}function oe(te){this._childLevel=(te._childLevel|0)+1,this.error=yn(te,A,"error"),this.fatal=yn(te,A,"fatal"),this.warn=yn(te,A,"warn"),this.info=yn(te,A,"info"),this.debug=yn(te,A,"debug"),this.trace=yn(te,A,"trace"),ce&&(this.serializers=ce,this._serialize=ae),t&&(this._logEvent=Cc([].concat(te._logEvent.bindings,A)))}return oe.prototype=this,new oe(this)}return v}Fr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Fr.stdSerializers=$_;Fr.stdTimeFunctions=Object.assign({},{nullTime:Pf,epochTime:Sf,unixTime:z_,isoTime:U_});function gn(a,t,r,n){const o=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?rs:o[r]?o[r]:ts[r]||ts[n]||rs,D_(a,t,r)}function D_(a,t,r){!a.transmit&&t[r]===rs||(t[r]=function(n){return function(){const c=a.timestamp(),f=new Array(arguments.length),g=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ts?ts:this;for(var v=0;v<f.length;v++)f[v]=arguments[v];if(a.serialize&&!a.asObject&&$o(f,this._serialize,this.serializers,this._stdErrSerialize),a.asObject?n.call(g,j_(this,r,f,c)):n.apply(g,f),a.transmit){const p=a.transmit.level||t.level,_=Fr.levels.values[p],x=Fr.levels.values[r];if(x<_)return;q_(this,{ts:c,methodLevel:r,methodValue:x,transmitLevel:p,transmitValue:Fr.levels.values[a.transmit.level||t.level],send:a.transmit.send,val:t.levelVal},f)}}}(t[r]))}function j_(a,t,r,n){a._serialize&&$o(r,a._serialize,a.serializers,a._stdErrSerialize);const o=r.slice();let c=o[0];const f={};n&&(f.time=n),f.level=Fr.levels.values[t];let g=(a._childLevel|0)+1;if(g<1&&(g=1),c!==null&&typeof c=="object"){for(;g--&&typeof o[0]=="object";)Object.assign(f,o.shift());c=o.length?dl(o.shift(),o):void 0}else typeof c=="string"&&(c=dl(o.shift(),o));return c!==void 0&&(f.msg=c),f}function $o(a,t,r,n){for(const o in a)if(n&&a[o]instanceof Error)a[o]=Fr.stdSerializers.err(a[o]);else if(typeof a[o]=="object"&&!Array.isArray(a[o]))for(const c in a[o])t&&t.indexOf(c)>-1&&c in r&&(a[o][c]=r[c](a[o][c]))}function yn(a,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var o=1;o<n.length;o++)n[o]=arguments[o-1];return a[r].apply(this,n)}}function q_(a,t,r){const n=t.send,o=t.ts,c=t.methodLevel,f=t.methodValue,g=t.val,v=a._logEvent.bindings;$o(r,a._serialize||Object.keys(a.serializers),a.serializers,a._stdErrSerialize===void 0?!0:a._stdErrSerialize),a._logEvent.ts=o,a._logEvent.messages=r.filter(function(p){return v.indexOf(p)===-1}),a._logEvent.level.label=c,a._logEvent.level.value=f,n(c,a._logEvent,g),a._logEvent=Cc(v)}function Cc(a){return{ts:0,messages:[],bindings:a||[],level:{label:"",value:0}}}function L_(a){const t={type:a.constructor.name,msg:a.message,stack:a.stack};for(const r in a)t[r]===void 0&&(t[r]=a[r]);return t}function M_(a){return typeof a.timestamp=="function"?a.timestamp:a.timestamp===!1?Pf:Sf}function vo(){return{}}function gc(a){return a}function rs(){}function Pf(){return!1}function Sf(){return Date.now()}function z_(){return Math.round(Date.now()/1e3)}function U_(){return new Date(Date.now()).toISOString()}function H_(){function a(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return a(self)||a(window)||a(this)||{}}}const No=Ao(C_),k_={level:"info"},os="custom_context";var K_=Object.defineProperty,B_=Object.defineProperties,F_=Object.getOwnPropertyDescriptors,gl=Object.getOwnPropertySymbols,V_=Object.prototype.hasOwnProperty,G_=Object.prototype.propertyIsEnumerable,yl=(a,t,r)=>t in a?K_(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,W_=(a,t)=>{for(var r in t||(t={}))V_.call(t,r)&&yl(a,r,t[r]);if(gl)for(var r of gl(t))G_.call(t,r)&&yl(a,r,t[r]);return a},J_=(a,t)=>B_(a,F_(t));function Do(a){return J_(W_({},a),{level:(a==null?void 0:a.level)||k_.level})}function Q_(a,t=os){return a[t]||""}function Y_(a,t,r=os){return a[r]=t,a}function cr(a,t=os){let r="";return typeof a.bindings>"u"?r=Q_(a,t):r=a.bindings().context||"",r}function Z_(a,t,r=os){const n=cr(a,r);return n.trim()?`${n}/${t}`:t}function ur(a,t,r=os){const n=Z_(a,t,r),o=a.child({context:n});return Y_(o,n,r)}let X_=class extends Vi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},eb=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},tb=class{constructor(t,r){this.logger=t,this.core=r}},rb=class extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},ib=class extends Vi{constructor(t){super()}},nb=class{constructor(t,r,n,o){this.core=t,this.logger=r,this.name=n}},sb=class extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},ob=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r}},ab=class{constructor(t,r){this.projectId=t,this.logger=r}},cb=class{constructor(t,r){this.projectId=t,this.logger=r}},ub=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},hb=class{constructor(t){this.client=t}};var Bc={},Of={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=L0,r=ff;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(v,p){if(p===void 0&&(p=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=v[_++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(_=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,_,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=v[_++],p--;return this},g.prototype.finish=function(v){if(!this._finished){var p=this._bytesHashed,_=this._bufferLength,x=p/536870912|0,T=p<<3,D=p%128<112?128:256;this._buffer[_]=128;for(var A=_+1;A<D-8;A++)this._buffer[A]=0;t.writeUint32BE(x,this._buffer,D-8),t.writeUint32BE(T,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var A=0;A<this.digestLength/8;A++)t.writeUint32BE(this._stateHi[A],v,A*8),t.writeUint32BE(this._stateLo[A],v,A*8+4);return this},g.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},g}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(g,v,p,_,x,T,D){for(var A=p[0],J=p[1],ee=p[2],ce=p[3],ae=p[4],oe=p[5],te=p[6],he=p[7],pe=_[0],Y=_[1],ve=_[2],wt=_[3],nt=_[4],Ke=_[5],Lt=_[6],Mt=_[7],b,O,Q,le,k,H,K,B;D>=128;){for(var Xe=0;Xe<16;Xe++){var st=8*Xe+T;g[Xe]=t.readUint32BE(x,st),v[Xe]=t.readUint32BE(x,st+4)}for(var Xe=0;Xe<80;Xe++){var Oi=A,Ee=J,Rr=ee,j=ce,N=ae,C=oe,h=te,I=he,Z=pe,ue=Y,me=ve,Oe=wt,Ae=nt,Ie=Ke,_t=Lt,dt=Mt;if(b=he,O=Mt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=(ae>>>14|nt<<18)^(ae>>>18|nt<<14)^(nt>>>9|ae<<23),O=(nt>>>14|ae<<18)^(nt>>>18|ae<<14)^(ae>>>9|nt<<23),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=ae&oe^~ae&te,O=nt&Ke^~nt&Lt,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=o[Xe*2],O=o[Xe*2+1],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=g[Xe%16],O=v[Xe%16],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,Q=K&65535|B<<16,le=k&65535|H<<16,b=Q,O=le,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=(A>>>28|pe<<4)^(pe>>>2|A<<30)^(pe>>>7|A<<25),O=(pe>>>28|A<<4)^(A>>>2|pe<<30)^(A>>>7|pe<<25),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,b=A&J^A&ee^J&ee,O=pe&Y^pe&ve^Y&ve,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,I=K&65535|B<<16,dt=k&65535|H<<16,b=j,O=Oe,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=Q,O=le,k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,j=K&65535|B<<16,Oe=k&65535|H<<16,J=Oi,ee=Ee,ce=Rr,ae=j,oe=N,te=C,he=h,A=I,Y=Z,ve=ue,wt=me,nt=Oe,Ke=Ae,Lt=Ie,Mt=_t,pe=dt,Xe%16===15)for(var st=0;st<16;st++)b=g[st],O=v[st],k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=g[(st+9)%16],O=v[(st+9)%16],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,Q=g[(st+1)%16],le=v[(st+1)%16],b=(Q>>>1|le<<31)^(Q>>>8|le<<24)^Q>>>7,O=(le>>>1|Q<<31)^(le>>>8|Q<<24)^(le>>>7|Q<<25),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,Q=g[(st+14)%16],le=v[(st+14)%16],b=(Q>>>19|le<<13)^(le>>>29|Q<<3)^Q>>>6,O=(le>>>19|Q<<13)^(Q>>>29|le<<3)^(le>>>6|Q<<26),k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,g[st]=K&65535|B<<16,v[st]=k&65535|H<<16}b=A,O=pe,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[0],O=_[0],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[0]=A=K&65535|B<<16,_[0]=pe=k&65535|H<<16,b=J,O=Y,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[1],O=_[1],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[1]=J=K&65535|B<<16,_[1]=Y=k&65535|H<<16,b=ee,O=ve,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[2],O=_[2],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[2]=ee=K&65535|B<<16,_[2]=ve=k&65535|H<<16,b=ce,O=wt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[3],O=_[3],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[3]=ce=K&65535|B<<16,_[3]=wt=k&65535|H<<16,b=ae,O=nt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[4],O=_[4],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[4]=ae=K&65535|B<<16,_[4]=nt=k&65535|H<<16,b=oe,O=Ke,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[5],O=_[5],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[5]=oe=K&65535|B<<16,_[5]=Ke=k&65535|H<<16,b=te,O=Lt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[6],O=_[6],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[6]=te=K&65535|B<<16,_[6]=Lt=k&65535|H<<16,b=he,O=Mt,k=O&65535,H=O>>>16,K=b&65535,B=b>>>16,b=p[7],O=_[7],k+=O&65535,H+=O>>>16,K+=b&65535,B+=b>>>16,H+=k>>>16,K+=H>>>16,B+=K>>>16,p[7]=he=K&65535|B<<16,_[7]=Mt=k&65535|H<<16,T+=128,D-=128}return T}function f(g){var v=new n;v.update(g);var p=v.digest();return v.clean(),p}a.hash=f})(Of);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=pf,r=Of,n=ff;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(j){const N=new Float64Array(16);if(j)for(let C=0;C<j.length;C++)N[C]=j[C];return N}const c=new Uint8Array(32);c[0]=9;const f=o(),g=o([1]),v=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),T=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(j,N){for(let C=0;C<16;C++)j[C]=N[C]|0}function A(j){let N=1;for(let C=0;C<16;C++){let h=j[C]+N+65535;N=Math.floor(h/65536),j[C]=h-N*65536}j[0]+=N-1+37*(N-1)}function J(j,N,C){const h=~(C-1);for(let I=0;I<16;I++){const Z=h&(j[I]^N[I]);j[I]^=Z,N[I]^=Z}}function ee(j,N){const C=o(),h=o();for(let I=0;I<16;I++)h[I]=N[I];A(h),A(h),A(h);for(let I=0;I<2;I++){C[0]=h[0]-65517;for(let ue=1;ue<15;ue++)C[ue]=h[ue]-65535-(C[ue-1]>>16&1),C[ue-1]&=65535;C[15]=h[15]-32767-(C[14]>>16&1);const Z=C[15]>>16&1;C[14]&=65535,J(h,C,1-Z)}for(let I=0;I<16;I++)j[2*I]=h[I]&255,j[2*I+1]=h[I]>>8}function ce(j,N){let C=0;for(let h=0;h<32;h++)C|=j[h]^N[h];return(1&C-1>>>8)-1}function ae(j,N){const C=new Uint8Array(32),h=new Uint8Array(32);return ee(C,j),ee(h,N),ce(C,h)}function oe(j){const N=new Uint8Array(32);return ee(N,j),N[0]&1}function te(j,N){for(let C=0;C<16;C++)j[C]=N[2*C]+(N[2*C+1]<<8);j[15]&=32767}function he(j,N,C){for(let h=0;h<16;h++)j[h]=N[h]+C[h]}function pe(j,N,C){for(let h=0;h<16;h++)j[h]=N[h]-C[h]}function Y(j,N,C){let h,I,Z=0,ue=0,me=0,Oe=0,Ae=0,Ie=0,_t=0,dt=0,et=0,Ce=0,Be=0,Fe=0,tt=0,je=0,Ve=0,Re=0,Le=0,ot=0,Ne=0,bt=0,Tt=0,zt=0,Ut=0,Nt=0,Gt=0,Xt=0,Mr=0,Wt=0,Vr=0,hi=0,Ri=0,at=C[0],Je=C[1],ct=C[2],ut=C[3],rt=C[4],Qe=C[5],Et=C[6],It=C[7],ht=C[8],xt=C[9],lt=C[10],gt=C[11],ft=C[12],ke=C[13],Pt=C[14],St=C[15];h=N[0],Z+=h*at,ue+=h*Je,me+=h*ct,Oe+=h*ut,Ae+=h*rt,Ie+=h*Qe,_t+=h*Et,dt+=h*It,et+=h*ht,Ce+=h*xt,Be+=h*lt,Fe+=h*gt,tt+=h*ft,je+=h*ke,Ve+=h*Pt,Re+=h*St,h=N[1],ue+=h*at,me+=h*Je,Oe+=h*ct,Ae+=h*ut,Ie+=h*rt,_t+=h*Qe,dt+=h*Et,et+=h*It,Ce+=h*ht,Be+=h*xt,Fe+=h*lt,tt+=h*gt,je+=h*ft,Ve+=h*ke,Re+=h*Pt,Le+=h*St,h=N[2],me+=h*at,Oe+=h*Je,Ae+=h*ct,Ie+=h*ut,_t+=h*rt,dt+=h*Qe,et+=h*Et,Ce+=h*It,Be+=h*ht,Fe+=h*xt,tt+=h*lt,je+=h*gt,Ve+=h*ft,Re+=h*ke,Le+=h*Pt,ot+=h*St,h=N[3],Oe+=h*at,Ae+=h*Je,Ie+=h*ct,_t+=h*ut,dt+=h*rt,et+=h*Qe,Ce+=h*Et,Be+=h*It,Fe+=h*ht,tt+=h*xt,je+=h*lt,Ve+=h*gt,Re+=h*ft,Le+=h*ke,ot+=h*Pt,Ne+=h*St,h=N[4],Ae+=h*at,Ie+=h*Je,_t+=h*ct,dt+=h*ut,et+=h*rt,Ce+=h*Qe,Be+=h*Et,Fe+=h*It,tt+=h*ht,je+=h*xt,Ve+=h*lt,Re+=h*gt,Le+=h*ft,ot+=h*ke,Ne+=h*Pt,bt+=h*St,h=N[5],Ie+=h*at,_t+=h*Je,dt+=h*ct,et+=h*ut,Ce+=h*rt,Be+=h*Qe,Fe+=h*Et,tt+=h*It,je+=h*ht,Ve+=h*xt,Re+=h*lt,Le+=h*gt,ot+=h*ft,Ne+=h*ke,bt+=h*Pt,Tt+=h*St,h=N[6],_t+=h*at,dt+=h*Je,et+=h*ct,Ce+=h*ut,Be+=h*rt,Fe+=h*Qe,tt+=h*Et,je+=h*It,Ve+=h*ht,Re+=h*xt,Le+=h*lt,ot+=h*gt,Ne+=h*ft,bt+=h*ke,Tt+=h*Pt,zt+=h*St,h=N[7],dt+=h*at,et+=h*Je,Ce+=h*ct,Be+=h*ut,Fe+=h*rt,tt+=h*Qe,je+=h*Et,Ve+=h*It,Re+=h*ht,Le+=h*xt,ot+=h*lt,Ne+=h*gt,bt+=h*ft,Tt+=h*ke,zt+=h*Pt,Ut+=h*St,h=N[8],et+=h*at,Ce+=h*Je,Be+=h*ct,Fe+=h*ut,tt+=h*rt,je+=h*Qe,Ve+=h*Et,Re+=h*It,Le+=h*ht,ot+=h*xt,Ne+=h*lt,bt+=h*gt,Tt+=h*ft,zt+=h*ke,Ut+=h*Pt,Nt+=h*St,h=N[9],Ce+=h*at,Be+=h*Je,Fe+=h*ct,tt+=h*ut,je+=h*rt,Ve+=h*Qe,Re+=h*Et,Le+=h*It,ot+=h*ht,Ne+=h*xt,bt+=h*lt,Tt+=h*gt,zt+=h*ft,Ut+=h*ke,Nt+=h*Pt,Gt+=h*St,h=N[10],Be+=h*at,Fe+=h*Je,tt+=h*ct,je+=h*ut,Ve+=h*rt,Re+=h*Qe,Le+=h*Et,ot+=h*It,Ne+=h*ht,bt+=h*xt,Tt+=h*lt,zt+=h*gt,Ut+=h*ft,Nt+=h*ke,Gt+=h*Pt,Xt+=h*St,h=N[11],Fe+=h*at,tt+=h*Je,je+=h*ct,Ve+=h*ut,Re+=h*rt,Le+=h*Qe,ot+=h*Et,Ne+=h*It,bt+=h*ht,Tt+=h*xt,zt+=h*lt,Ut+=h*gt,Nt+=h*ft,Gt+=h*ke,Xt+=h*Pt,Mr+=h*St,h=N[12],tt+=h*at,je+=h*Je,Ve+=h*ct,Re+=h*ut,Le+=h*rt,ot+=h*Qe,Ne+=h*Et,bt+=h*It,Tt+=h*ht,zt+=h*xt,Ut+=h*lt,Nt+=h*gt,Gt+=h*ft,Xt+=h*ke,Mr+=h*Pt,Wt+=h*St,h=N[13],je+=h*at,Ve+=h*Je,Re+=h*ct,Le+=h*ut,ot+=h*rt,Ne+=h*Qe,bt+=h*Et,Tt+=h*It,zt+=h*ht,Ut+=h*xt,Nt+=h*lt,Gt+=h*gt,Xt+=h*ft,Mr+=h*ke,Wt+=h*Pt,Vr+=h*St,h=N[14],Ve+=h*at,Re+=h*Je,Le+=h*ct,ot+=h*ut,Ne+=h*rt,bt+=h*Qe,Tt+=h*Et,zt+=h*It,Ut+=h*ht,Nt+=h*xt,Gt+=h*lt,Xt+=h*gt,Mr+=h*ft,Wt+=h*ke,Vr+=h*Pt,hi+=h*St,h=N[15],Re+=h*at,Le+=h*Je,ot+=h*ct,Ne+=h*ut,bt+=h*rt,Tt+=h*Qe,zt+=h*Et,Ut+=h*It,Nt+=h*ht,Gt+=h*xt,Xt+=h*lt,Mr+=h*gt,Wt+=h*ft,Vr+=h*ke,hi+=h*Pt,Ri+=h*St,Z+=38*Le,ue+=38*ot,me+=38*Ne,Oe+=38*bt,Ae+=38*Tt,Ie+=38*zt,_t+=38*Ut,dt+=38*Nt,et+=38*Gt,Ce+=38*Xt,Be+=38*Mr,Fe+=38*Wt,tt+=38*Vr,je+=38*hi,Ve+=38*Ri,I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),j[0]=Z,j[1]=ue,j[2]=me,j[3]=Oe,j[4]=Ae,j[5]=Ie,j[6]=_t,j[7]=dt,j[8]=et,j[9]=Ce,j[10]=Be,j[11]=Fe,j[12]=tt,j[13]=je,j[14]=Ve,j[15]=Re}function ve(j,N){Y(j,N,N)}function wt(j,N){const C=o();let h;for(h=0;h<16;h++)C[h]=N[h];for(h=253;h>=0;h--)ve(C,C),h!==2&&h!==4&&Y(C,C,N);for(h=0;h<16;h++)j[h]=C[h]}function nt(j,N){const C=o();let h;for(h=0;h<16;h++)C[h]=N[h];for(h=250;h>=0;h--)ve(C,C),h!==1&&Y(C,C,N);for(h=0;h<16;h++)j[h]=C[h]}function Ke(j,N){const C=o(),h=o(),I=o(),Z=o(),ue=o(),me=o(),Oe=o(),Ae=o(),Ie=o();pe(C,j[1],j[0]),pe(Ie,N[1],N[0]),Y(C,C,Ie),he(h,j[0],j[1]),he(Ie,N[0],N[1]),Y(h,h,Ie),Y(I,j[3],N[3]),Y(I,I,p),Y(Z,j[2],N[2]),he(Z,Z,Z),pe(ue,h,C),pe(me,Z,I),he(Oe,Z,I),he(Ae,h,C),Y(j[0],ue,me),Y(j[1],Ae,Oe),Y(j[2],Oe,me),Y(j[3],ue,Ae)}function Lt(j,N,C){for(let h=0;h<4;h++)J(j[h],N[h],C)}function Mt(j,N){const C=o(),h=o(),I=o();wt(I,N[2]),Y(C,N[0],I),Y(h,N[1],I),ee(j,h),j[31]^=oe(C)<<7}function b(j,N,C){D(j[0],f),D(j[1],g),D(j[2],g),D(j[3],f);for(let h=255;h>=0;--h){const I=C[h/8|0]>>(h&7)&1;Lt(j,N,I),Ke(N,j),Ke(j,j),Lt(j,N,I)}}function O(j,N){const C=[o(),o(),o(),o()];D(C[0],_),D(C[1],x),D(C[2],g),Y(C[3],_,x),b(j,C,N)}function Q(j){if(j.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const N=(0,r.hash)(j);N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(32),h=[o(),o(),o(),o()];O(h,N),Mt(C,h);const I=new Uint8Array(64);return I.set(j),I.set(C,32),{publicKey:C,secretKey:I}}a.generateKeyPairFromSeed=Q;function le(j){const N=(0,t.randomBytes)(32,j),C=Q(N);return(0,n.wipe)(N),C}a.generateKeyPair=le;function k(j){if(j.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}a.extractPublicKeyFromSecretKey=k;const H=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(j,N){let C,h,I,Z;for(h=63;h>=32;--h){for(C=0,I=h-32,Z=h-12;I<Z;++I)N[I]+=C-16*N[h]*H[I-(h-32)],C=Math.floor((N[I]+128)/256),N[I]-=C*256;N[I]+=C,N[h]=0}for(C=0,I=0;I<32;I++)N[I]+=C-(N[31]>>4)*H[I],C=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=C*H[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,j[h]=N[h]&255}function B(j){const N=new Float64Array(64);for(let C=0;C<64;C++)N[C]=j[C];for(let C=0;C<64;C++)j[C]=0;K(j,N)}function Xe(j,N){const C=new Float64Array(64),h=[o(),o(),o(),o()],I=(0,r.hash)(j.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const Z=new Uint8Array(64);Z.set(I.subarray(32),32);const ue=new r.SHA512;ue.update(Z.subarray(32)),ue.update(N);const me=ue.digest();ue.clean(),B(me),O(h,me),Mt(Z,h),ue.reset(),ue.update(Z.subarray(0,32)),ue.update(j.subarray(32)),ue.update(N);const Oe=ue.digest();B(Oe);for(let Ae=0;Ae<32;Ae++)C[Ae]=me[Ae];for(let Ae=0;Ae<32;Ae++)for(let Ie=0;Ie<32;Ie++)C[Ae+Ie]+=Oe[Ae]*I[Ie];return K(Z.subarray(32),C),Z}a.sign=Xe;function st(j,N){const C=o(),h=o(),I=o(),Z=o(),ue=o(),me=o(),Oe=o();return D(j[2],g),te(j[1],N),ve(I,j[1]),Y(Z,I,v),pe(I,I,j[2]),he(Z,j[2],Z),ve(ue,Z),ve(me,ue),Y(Oe,me,ue),Y(C,Oe,I),Y(C,C,Z),nt(C,C),Y(C,C,I),Y(C,C,Z),Y(C,C,Z),Y(j[0],C,Z),ve(h,j[0]),Y(h,h,Z),ae(h,I)&&Y(j[0],j[0],T),ve(h,j[0]),Y(h,h,Z),ae(h,I)?-1:(oe(j[0])===N[31]>>7&&pe(j[0],f,j[0]),Y(j[3],j[0],j[1]),0)}function Oi(j,N,C){const h=new Uint8Array(32),I=[o(),o(),o(),o()],Z=[o(),o(),o(),o()];if(C.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(st(Z,j))return!1;const ue=new r.SHA512;ue.update(C.subarray(0,32)),ue.update(j),ue.update(N);const me=ue.digest();return B(me),b(I,Z,me),O(Z,C.subarray(32)),Ke(I,Z),Mt(h,I),!ce(C,h)}a.verify=Oi;function Ee(j){let N=[o(),o(),o(),o()];if(st(N,j))throw new Error("Ed25519: invalid public key");let C=o(),h=o(),I=N[1];he(C,g,I),pe(h,g,I),wt(h,h),Y(C,C,h);let Z=new Uint8Array(32);return ee(Z,C),Z}a.convertPublicKeyToX25519=Ee;function Rr(j){const N=(0,r.hash)(j.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),C}a.convertSecretKeyToX25519=Rr})(Bc);const lb="EdDSA",fb="JWT",Rf=".",Af="base64url",pb="utf8",db="utf8",gb=":",yb="did",vb="key",vl="base58btc",mb="z",wb="K36",_b=32;function Po(a){return To(kc(Bi(a),pb),Af)}function Tf(a){const t=kc(wb,vl),r=mb+To(M0([t,a]),vl);return[yb,vb,r].join(gb)}function bb(a){return To(a,Af)}function Eb(a){return kc([Po(a.header),Po(a.payload)].join(Rf),db)}function Ib(a){return[Po(a.header),Po(a.payload),bb(a.signature)].join(Rf)}function ml(a=pf.randomBytes(_b)){return Bc.generateKeyPairFromSeed(a)}async function xb(a,t,r,n,o=re.fromMiliseconds(Date.now())){const c={alg:lb,typ:fb},f=Tf(n.publicKey),g=o+r,v={iss:f,sub:a,aud:t,iat:o,exp:g},p=Eb({header:c,payload:v}),_=Bc.sign(n.secretKey,p);return Ib({header:c,payload:v,signature:_})}const Pb="PARSE_ERROR",Sb="INVALID_REQUEST",Ob="METHOD_NOT_FOUND",Rb="INVALID_PARAMS",Cf="INTERNAL_ERROR",Fc="SERVER_ERROR",Ab=[-32700,-32600,-32601,-32602,-32603],Zn={[Pb]:{code:-32700,message:"Parse error"},[Sb]:{code:-32600,message:"Invalid Request"},[Ob]:{code:-32601,message:"Method not found"},[Rb]:{code:-32602,message:"Invalid params"},[Cf]:{code:-32603,message:"Internal error"},[Fc]:{code:-32e3,message:"Server error"}},$f=Fc;function Tb(a){return Ab.includes(a)}function wl(a){return Object.keys(Zn).includes(a)?Zn[a]:Zn[$f]}function Cb(a){const t=Object.values(Zn).find(r=>r.code===a);return t||Zn[$f]}function Nf(a,t,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):a}var Df={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $c=function(a,t){return $c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},$c(a,t)};function $b(a,t){$c(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Nc=function(){return Nc=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Nc.apply(this,arguments)};function Nb(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(r[n[o]]=a[n[o]]);return r}function Db(a,t,r,n){var o=arguments.length,c=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function jb(a,t){return function(r,n){t(r,n,a)}}function qb(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function Lb(a,t,r,n){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function g(_){try{p(n.next(_))}catch(x){f(x)}}function v(_){try{p(n.throw(_))}catch(x){f(x)}}function p(_){_.done?c(_.value):o(_.value).then(g,v)}p((n=n.apply(a,t||[])).next())})}function Mb(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(_){return v([p,_])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(_){p=[6,_],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function zb(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function Ub(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Dc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function jf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return c}function Hb(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(jf(arguments[t]));return a}function kb(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function is(a){return this instanceof is?(this.v=a,this):new is(a)}function Kb(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(T){n[T]&&(o[T]=function(D){return new Promise(function(A,J){c.push([T,D,A,J])>1||g(T,D)})})}function g(T,D){try{v(n[T](D))}catch(A){x(c[0][3],A)}}function v(T){T.value instanceof is?Promise.resolve(T.value.v).then(p,_):x(c[0][2],T)}function p(T){g("next",T)}function _(T){g("throw",T)}function x(T,D){T(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function Bb(a){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,c){t[o]=a[o]?function(f){return(r=!r)?{value:is(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function Fb(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Dc=="function"?Dc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(f){return new Promise(function(g,v){f=a[c](f),o(g,v,f.done,f.value)})}}function o(c,f,g,v){Promise.resolve(v).then(function(p){c({value:p,done:g})},f)}}function Vb(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function Gb(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function Wb(a){return a&&a.__esModule?a:{default:a}}function Jb(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function Qb(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Yb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nc},__asyncDelegator:Bb,__asyncGenerator:Kb,__asyncValues:Fb,__await:is,__awaiter:Lb,__classPrivateFieldGet:Jb,__classPrivateFieldSet:Qb,__createBinding:zb,__decorate:Db,__exportStar:Ub,__extends:$b,__generator:Mb,__importDefault:Wb,__importStar:Gb,__makeTemplateObject:Vb,__metadata:qb,__param:jb,__read:jf,__rest:Nb,__spread:Hb,__spreadArrays:kb,__values:Dc},Symbol.toStringTag,{value:"Module"})),Zb=Ro(Yb);var ni={},_l;function Xb(){if(_l)return ni;_l=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(Lr===null||Lr===void 0?void 0:Lr.crypto)||(Lr===null||Lr===void 0?void 0:Lr.msCrypto)||{}}ni.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=t;function r(){return!!a()&&!!t()}return ni.isBrowserCryptoAvailable=r,ni}var si={},bl;function e1(){if(bl)return si;bl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=t;function r(){return!a()&&!t()}return si.isBrowser=r,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=Zb;t.__exportStar(Xb(),a),t.__exportStar(e1(),a)})(Df);function Vc(a=3){const t=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return t+r}function Gc(a=6){return BigInt(Vc(a))}function Ki(a,t,r){return{id:r||Vc(),jsonrpc:"2.0",method:a,params:t}}function jo(a,t){return{id:a,jsonrpc:"2.0",result:t}}function qo(a,t,r){return{id:a,jsonrpc:"2.0",error:t1(t)}}function t1(a,t){return typeof a>"u"?wl(Cf):(typeof a=="string"&&(a=Object.assign(Object.assign({},wl(Fc)),{message:a})),Tb(a.code)&&(a=Cb(a.code)),a)}class r1{}class i1 extends r1{constructor(){super()}}class qf extends i1{constructor(t){super()}}const n1="^https?:",s1="^wss?:";function o1(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Lf(a,t){const r=o1(a);return typeof r>"u"?!1:new RegExp(t).test(r)}function El(a){return Lf(a,n1)}function Il(a){return Lf(a,s1)}function a1(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Mf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Wc(a){return Mf(a)&&"method"in a}function as(a){return Mf(a)&&(ci(a)||Or(a))}function ci(a){return"result"in a}function Or(a){return"error"in a}let c1=class extends qf{constructor(t){super(t),this.events=new yr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ki(t.method,t.params||[],t.id||Gc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Or(c)?o(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),as(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const u1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),h1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",xl=a=>a.split("?")[0],Pl=10,l1=u1();let f1=class{constructor(t){if(this.url=t,this.events=new yr.EventEmitter,this.registering=!1,!Il(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Il(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const o=new URLSearchParams(t).get("origin"),c=Df.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!a1(t)},f=new l1(t,[],c);h1()?f.onerror=g=>{const v=g;n(this.emitError(v.error))}:f.on("error",g=>{n(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),c=qo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Nf(t,xl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Pl&&this.events.setMaxListeners(Pl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${xl(this.url)}`));return this.events.emit("register_error",r),r}};var So={exports:{}};So.exports;(function(a,t){var r=200,n="__lodash_hash_undefined__",o=1,c=2,f=9007199254740991,g="[object Arguments]",v="[object Array]",p="[object AsyncFunction]",_="[object Boolean]",x="[object Date]",T="[object Error]",D="[object Function]",A="[object GeneratorFunction]",J="[object Map]",ee="[object Number]",ce="[object Null]",ae="[object Object]",oe="[object Promise]",te="[object Proxy]",he="[object RegExp]",pe="[object Set]",Y="[object String]",ve="[object Symbol]",wt="[object Undefined]",nt="[object WeakMap]",Ke="[object ArrayBuffer]",Lt="[object DataView]",Mt="[object Float32Array]",b="[object Float64Array]",O="[object Int8Array]",Q="[object Int16Array]",le="[object Int32Array]",k="[object Uint8Array]",H="[object Uint8ClampedArray]",K="[object Uint16Array]",B="[object Uint32Array]",Xe=/[\\^$.*+?()[\]{}|]/g,st=/^\[object .+?Constructor\]$/,Oi=/^(?:0|[1-9]\d*)$/,Ee={};Ee[Mt]=Ee[b]=Ee[O]=Ee[Q]=Ee[le]=Ee[k]=Ee[H]=Ee[K]=Ee[B]=!0,Ee[g]=Ee[v]=Ee[Ke]=Ee[_]=Ee[Lt]=Ee[x]=Ee[T]=Ee[D]=Ee[J]=Ee[ee]=Ee[ae]=Ee[he]=Ee[pe]=Ee[Y]=Ee[nt]=!1;var Rr=typeof Lr=="object"&&Lr&&Lr.Object===Object&&Lr,j=typeof self=="object"&&self&&self.Object===Object&&self,N=Rr||j||Function("return this")(),C=t&&!t.nodeType&&t,h=C&&!0&&a&&!a.nodeType&&a,I=h&&h.exports===C,Z=I&&Rr.process,ue=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=ue&&ue.isTypedArray;function Oe(m,P){for(var z=-1,V=m==null?0:m.length,ze=0,de=[];++z<V;){var Ge=m[z];P(Ge,z,m)&&(de[ze++]=Ge)}return de}function Ae(m,P){for(var z=-1,V=P.length,ze=m.length;++z<V;)m[ze+z]=P[z];return m}function Ie(m,P){for(var z=-1,V=m==null?0:m.length;++z<V;)if(P(m[z],z,m))return!0;return!1}function _t(m,P){for(var z=-1,V=Array(m);++z<m;)V[z]=P(z);return V}function dt(m){return function(P){return m(P)}}function et(m,P){return m.has(P)}function Ce(m,P){return m==null?void 0:m[P]}function Be(m){var P=-1,z=Array(m.size);return m.forEach(function(V,ze){z[++P]=[ze,V]}),z}function Fe(m,P){return function(z){return m(P(z))}}function tt(m){var P=-1,z=Array(m.size);return m.forEach(function(V){z[++P]=V}),z}var je=Array.prototype,Ve=Function.prototype,Re=Object.prototype,Le=N["__core-js_shared__"],ot=Ve.toString,Ne=Re.hasOwnProperty,bt=function(){var m=/[^.]+$/.exec(Le&&Le.keys&&Le.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Tt=Re.toString,zt=RegExp("^"+ot.call(Ne).replace(Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=I?N.Buffer:void 0,Nt=N.Symbol,Gt=N.Uint8Array,Xt=Re.propertyIsEnumerable,Mr=je.splice,Wt=Nt?Nt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,hi=Ut?Ut.isBuffer:void 0,Ri=Fe(Object.keys,Object),at=hr(N,"DataView"),Je=hr(N,"Map"),ct=hr(N,"Promise"),ut=hr(N,"Set"),rt=hr(N,"WeakMap"),Qe=hr(Object,"create"),Et=Wr(at),It=Wr(Je),ht=Wr(ct),xt=Wr(ut),lt=Wr(rt),gt=Nt?Nt.prototype:void 0,ft=gt?gt.valueOf:void 0;function ke(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function Pt(){this.__data__=Qe?Qe(null):{},this.size=0}function St(m){var P=this.has(m)&&delete this.__data__[m];return this.size-=P?1:0,P}function zo(m){var P=this.__data__;if(Qe){var z=P[m];return z===n?void 0:z}return Ne.call(P,m)?P[m]:void 0}function Uo(m){var P=this.__data__;return Qe?P[m]!==void 0:Ne.call(P,m)}function Ho(m,P){var z=this.__data__;return this.size+=this.has(m)?0:1,z[m]=Qe&&P===void 0?n:P,this}ke.prototype.clear=Pt,ke.prototype.delete=St,ke.prototype.get=zo,ke.prototype.has=Uo,ke.prototype.set=Ho;function vr(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function ko(){this.__data__=[],this.size=0}function Ko(m){var P=this.__data__,z=Ai(P,m);if(z<0)return!1;var V=P.length-1;return z==V?P.pop():Mr.call(P,z,1),--this.size,!0}function Bo(m){var P=this.__data__,z=Ai(P,m);return z<0?void 0:P[z][1]}function Fo(m){return Ai(this.__data__,m)>-1}function Vo(m,P){var z=this.__data__,V=Ai(z,m);return V<0?(++this.size,z.push([m,P])):z[V][1]=P,this}vr.prototype.clear=ko,vr.prototype.delete=Ko,vr.prototype.get=Bo,vr.prototype.has=Fo,vr.prototype.set=Vo;function Gr(m){var P=-1,z=m==null?0:m.length;for(this.clear();++P<z;){var V=m[P];this.set(V[0],V[1])}}function Wi(){this.size=0,this.__data__={hash:new ke,map:new(Je||vr),string:new ke}}function Go(m){var P=li(this,m).delete(m);return this.size-=P?1:0,P}function Ji(m){return li(this,m).get(m)}function Wo(m){return li(this,m).has(m)}function Jo(m,P){var z=li(this,m),V=z.size;return z.set(m,P),this.size+=z.size==V?0:1,this}Gr.prototype.clear=Wi,Gr.prototype.delete=Go,Gr.prototype.get=Ji,Gr.prototype.has=Wo,Gr.prototype.set=Jo;function Qi(m){var P=-1,z=m==null?0:m.length;for(this.__data__=new Gr;++P<z;)this.add(m[P])}function us(m){return this.__data__.set(m,n),this}function hs(m){return this.__data__.has(m)}Qi.prototype.add=Qi.prototype.push=us,Qi.prototype.has=hs;function Ar(m){var P=this.__data__=new vr(m);this.size=P.size}function Qo(){this.__data__=new vr,this.size=0}function Yo(m){var P=this.__data__,z=P.delete(m);return this.size=P.size,z}function Zo(m){return this.__data__.get(m)}function Xo(m){return this.__data__.has(m)}function ls(m,P){var z=this.__data__;if(z instanceof vr){var V=z.__data__;if(!Je||V.length<r-1)return V.push([m,P]),this.size=++z.size,this;z=this.__data__=new Gr(V)}return z.set(m,P),this.size=z.size,this}Ar.prototype.clear=Qo,Ar.prototype.delete=Yo,Ar.prototype.get=Zo,Ar.prototype.has=Xo,Ar.prototype.set=ls;function fs(m,P){var z=Xi(m),V=!z&&xs(m),ze=!z&&!V&&Pn(m),de=!z&&!V&&!ze&&Os(m),Ge=z||V||ze||de,Ot=Ge?_t(m.length,String):[],Pe=Ot.length;for(var Ue in m)Ne.call(m,Ue)&&!(Ge&&(Ue=="length"||ze&&(Ue=="offset"||Ue=="parent")||de&&(Ue=="buffer"||Ue=="byteLength"||Ue=="byteOffset")||ws(Ue,Pe)))&&Ot.push(Ue);return Ot}function Ai(m,P){for(var z=m.length;z--;)if(Is(m[z][0],P))return z;return-1}function In(m,P,z){var V=P(m);return Xi(m)?V:Ae(V,z(m))}function Ti(m){return m==null?m===void 0?wt:ce:Wt&&Wt in Object(m)?vs(m):ra(m)}function xn(m){return $i(m)&&Ti(m)==g}function Ci(m,P,z,V,ze){return m===P?!0:m==null||P==null||!$i(m)&&!$i(P)?m!==m&&P!==P:ps(m,P,z,V,Ci,ze)}function ps(m,P,z,V,ze,de){var Ge=Xi(m),Ot=Xi(P),Pe=Ge?v:zr(m),Ue=Ot?v:zr(P);Pe=Pe==g?ae:Pe,Ue=Ue==g?ae:Ue;var yt=Pe==ae,er=Ue==ae,Rt=Pe==Ue;if(Rt&&Pn(m)){if(!Pn(P))return!1;Ge=!0,yt=!1}if(Rt&&!yt)return de||(de=new Ar),Ge||Os(m)?Yi(m,P,z,V,ze,de):ta(m,P,Pe,z,V,ze,de);if(!(z&o)){var We=yt&&Ne.call(m,"__wrapped__"),Jt=er&&Ne.call(P,"__wrapped__");if(We||Jt){var Tr=We?m.value():m,mr=Jt?P.value():P;return de||(de=new Ar),ze(Tr,mr,z,V,de)}}return Rt?(de||(de=new Ar),ys(m,P,z,V,ze,de)):!1}function ea(m){if(!Ss(m)||bs(m))return!1;var P=en(m)?zt:st;return P.test(Wr(m))}function ds(m){return $i(m)&&Ps(m.length)&&!!Ee[Ti(m)]}function gs(m){if(!Es(m))return Ri(m);var P=[];for(var z in Object(m))Ne.call(m,z)&&z!="constructor"&&P.push(z);return P}function Yi(m,P,z,V,ze,de){var Ge=z&o,Ot=m.length,Pe=P.length;if(Ot!=Pe&&!(Ge&&Pe>Ot))return!1;var Ue=de.get(m);if(Ue&&de.get(P))return Ue==P;var yt=-1,er=!0,Rt=z&c?new Qi:void 0;for(de.set(m,P),de.set(P,m);++yt<Ot;){var We=m[yt],Jt=P[yt];if(V)var Tr=Ge?V(Jt,We,yt,P,m,de):V(We,Jt,yt,m,P,de);if(Tr!==void 0){if(Tr)continue;er=!1;break}if(Rt){if(!Ie(P,function(mr,Ur){if(!et(Rt,Ur)&&(We===mr||ze(We,mr,z,V,de)))return Rt.push(Ur)})){er=!1;break}}else if(!(We===Jt||ze(We,Jt,z,V,de))){er=!1;break}}return de.delete(m),de.delete(P),er}function ta(m,P,z,V,ze,de,Ge){switch(z){case Lt:if(m.byteLength!=P.byteLength||m.byteOffset!=P.byteOffset)return!1;m=m.buffer,P=P.buffer;case Ke:return!(m.byteLength!=P.byteLength||!de(new Gt(m),new Gt(P)));case _:case x:case ee:return Is(+m,+P);case T:return m.name==P.name&&m.message==P.message;case he:case Y:return m==P+"";case J:var Ot=Be;case pe:var Pe=V&o;if(Ot||(Ot=tt),m.size!=P.size&&!Pe)return!1;var Ue=Ge.get(m);if(Ue)return Ue==P;V|=c,Ge.set(m,P);var yt=Yi(Ot(m),Ot(P),V,ze,de,Ge);return Ge.delete(m),yt;case ve:if(ft)return ft.call(m)==ft.call(P)}return!1}function ys(m,P,z,V,ze,de){var Ge=z&o,Ot=Zi(m),Pe=Ot.length,Ue=Zi(P),yt=Ue.length;if(Pe!=yt&&!Ge)return!1;for(var er=Pe;er--;){var Rt=Ot[er];if(!(Ge?Rt in P:Ne.call(P,Rt)))return!1}var We=de.get(m);if(We&&de.get(P))return We==P;var Jt=!0;de.set(m,P),de.set(P,m);for(var Tr=Ge;++er<Pe;){Rt=Ot[er];var mr=m[Rt],Ur=P[Rt];if(V)var Sn=Ge?V(Ur,mr,Rt,P,m,de):V(mr,Ur,Rt,m,P,de);if(!(Sn===void 0?mr===Ur||ze(mr,Ur,z,V,de):Sn)){Jt=!1;break}Tr||(Tr=Rt=="constructor")}if(Jt&&!Tr){var Ni=m.constructor,Dt=P.constructor;Ni!=Dt&&"constructor"in m&&"constructor"in P&&!(typeof Ni=="function"&&Ni instanceof Ni&&typeof Dt=="function"&&Dt instanceof Dt)&&(Jt=!1)}return de.delete(m),de.delete(P),Jt}function Zi(m){return In(m,sa,ms)}function li(m,P){var z=m.__data__;return _s(P)?z[typeof P=="string"?"string":"hash"]:z.map}function hr(m,P){var z=Ce(m,P);return ea(z)?z:void 0}function vs(m){var P=Ne.call(m,Wt),z=m[Wt];try{m[Wt]=void 0;var V=!0}catch{}var ze=Tt.call(m);return V&&(P?m[Wt]=z:delete m[Wt]),ze}var ms=Vr?function(m){return m==null?[]:(m=Object(m),Oe(Vr(m),function(P){return Xt.call(m,P)}))}:Me,zr=Ti;(at&&zr(new at(new ArrayBuffer(1)))!=Lt||Je&&zr(new Je)!=J||ct&&zr(ct.resolve())!=oe||ut&&zr(new ut)!=pe||rt&&zr(new rt)!=nt)&&(zr=function(m){var P=Ti(m),z=P==ae?m.constructor:void 0,V=z?Wr(z):"";if(V)switch(V){case Et:return Lt;case It:return J;case ht:return oe;case xt:return pe;case lt:return nt}return P});function ws(m,P){return P=P??f,!!P&&(typeof m=="number"||Oi.test(m))&&m>-1&&m%1==0&&m<P}function _s(m){var P=typeof m;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?m!=="__proto__":m===null}function bs(m){return!!bt&&bt in m}function Es(m){var P=m&&m.constructor,z=typeof P=="function"&&P.prototype||Re;return m===z}function ra(m){return Tt.call(m)}function Wr(m){if(m!=null){try{return ot.call(m)}catch{}try{return m+""}catch{}}return""}function Is(m,P){return m===P||m!==m&&P!==P}var xs=xn(function(){return arguments}())?xn:function(m){return $i(m)&&Ne.call(m,"callee")&&!Xt.call(m,"callee")},Xi=Array.isArray;function ia(m){return m!=null&&Ps(m.length)&&!en(m)}var Pn=hi||qe;function na(m,P){return Ci(m,P)}function en(m){if(!Ss(m))return!1;var P=Ti(m);return P==D||P==A||P==p||P==te}function Ps(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=f}function Ss(m){var P=typeof m;return m!=null&&(P=="object"||P=="function")}function $i(m){return m!=null&&typeof m=="object"}var Os=me?dt(me):ds;function sa(m){return ia(m)?fs(m):gs(m)}function Me(){return[]}function qe(){return!1}a.exports=na})(So,So.exports);var p1=So.exports;const d1=Ao(p1);function g1(a,t){return t=t||{},new Promise(function(r,n){var o=new XMLHttpRequest,c=[],f=[],g={},v=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:v,headers:{keys:function(){return c},entries:function(){return f},get:function(_){return g[_.toLowerCase()]},has:function(_){return _.toLowerCase()in g}}}};for(var p in o.open(t.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(_,x,T){c.push(x=x.toLowerCase()),f.push([x,T]),g[x]=g[x]?g[x]+","+T:T}),r(v())},o.onerror=n,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(p,t.headers[p]);o.send(t.body||null)})}const y1=Object.freeze(Object.defineProperty({__proto__:null,default:g1},Symbol.toStringTag,{value:"Module"})),Sl=Ro(y1);var v1=self.fetch||(self.fetch=Sl.default||Sl);const m1=Ao(v1);var w1={};function _1(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<a.length;o++){var c=a.charAt(o),f=c.charCodeAt(0);if(r[f]!==255)throw new TypeError(c+" is ambiguous");r[f]=o}var g=a.length,v=a.charAt(0),p=Math.log(g)/Math.log(256),_=Math.log(256)/Math.log(g);function x(A){if(A instanceof Uint8Array||(ArrayBuffer.isView(A)?A=new Uint8Array(A.buffer,A.byteOffset,A.byteLength):Array.isArray(A)&&(A=Uint8Array.from(A))),!(A instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(A.length===0)return"";for(var J=0,ee=0,ce=0,ae=A.length;ce!==ae&&A[ce]===0;)ce++,J++;for(var oe=(ae-ce)*_+1>>>0,te=new Uint8Array(oe);ce!==ae;){for(var he=A[ce],pe=0,Y=oe-1;(he!==0||pe<ee)&&Y!==-1;Y--,pe++)he+=256*te[Y]>>>0,te[Y]=he%g>>>0,he=he/g>>>0;if(he!==0)throw new Error("Non-zero carry");ee=pe,ce++}for(var ve=oe-ee;ve!==oe&&te[ve]===0;)ve++;for(var wt=v.repeat(J);ve<oe;++ve)wt+=a.charAt(te[ve]);return wt}function T(A){if(typeof A!="string")throw new TypeError("Expected String");if(A.length===0)return new Uint8Array;var J=0;if(A[J]!==" "){for(var ee=0,ce=0;A[J]===v;)ee++,J++;for(var ae=(A.length-J)*p+1>>>0,oe=new Uint8Array(ae);A[J];){var te=r[A.charCodeAt(J)];if(te===255)return;for(var he=0,pe=ae-1;(te!==0||he<ce)&&pe!==-1;pe--,he++)te+=g*oe[pe]>>>0,oe[pe]=te%256>>>0,te=te/256>>>0;if(te!==0)throw new Error("Non-zero carry");ce=he,J++}if(A[J]!==" "){for(var Y=ae-ce;Y!==ae&&oe[Y]===0;)Y++;for(var ve=new Uint8Array(ee+(ae-Y)),wt=ee;Y!==ae;)ve[wt++]=oe[Y++];return ve}}}function D(A){var J=T(A);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:T,decode:D}}var b1=_1,E1=b1;const zf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},I1=a=>new TextEncoder().encode(a),x1=a=>new TextDecoder().decode(a);class P1{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class S1{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Uf(this,t)}}class O1{constructor(t){this.decoders=t}or(t){return Uf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Uf=(a,t)=>new O1({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class R1{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new P1(t,r,n),this.decoder=new S1(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Lo=({name:a,prefix:t,encode:r,decode:n})=>new R1(a,t,r,n),cs=({prefix:a,name:t,alphabet:r})=>{const{encode:n,decode:o}=E1(r,t);return Lo({prefix:a,name:t,encode:n,decode:c=>zf(o(c))})},A1=(a,t,r,n)=>{const o={};for(let _=0;_<t.length;++_)o[t[_]]=_;let c=a.length;for(;a[c-1]==="=";)--c;const f=new Uint8Array(c*r/8|0);let g=0,v=0,p=0;for(let _=0;_<c;++_){const x=o[a[_]];if(x===void 0)throw new SyntaxError(`Non-${n} character`);v=v<<r|x,g+=r,g>=8&&(g-=8,f[p++]=255&v>>g)}if(g>=r||255&v<<8-g)throw new SyntaxError("Unexpected end of data");return f},T1=(a,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let c="",f=0,g=0;for(let v=0;v<a.length;++v)for(g=g<<8|a[v],f+=8;f>r;)f-=r,c+=t[o&g>>f];if(f&&(c+=t[o&g<<r-f]),n)for(;c.length*r&7;)c+="=";return c},kt=({name:a,prefix:t,bitsPerChar:r,alphabet:n})=>Lo({prefix:t,name:a,encode(o){return T1(o,n,r)},decode(o){return A1(o,n,r,a)}}),C1=Lo({prefix:"\0",name:"identity",encode:a=>x1(a),decode:a=>I1(a)});var $1=Object.freeze({__proto__:null,identity:C1});const N1=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var D1=Object.freeze({__proto__:null,base2:N1});const j1=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var q1=Object.freeze({__proto__:null,base8:j1});const L1=cs({prefix:"9",name:"base10",alphabet:"0123456789"});var M1=Object.freeze({__proto__:null,base10:L1});const z1=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),U1=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var H1=Object.freeze({__proto__:null,base16:z1,base16upper:U1});const k1=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),K1=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B1=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),F1=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V1=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),G1=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W1=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),J1=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Q1=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Y1=Object.freeze({__proto__:null,base32:k1,base32upper:K1,base32pad:B1,base32padupper:F1,base32hex:V1,base32hexupper:G1,base32hexpad:W1,base32hexpadupper:J1,base32z:Q1});const Z1=cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),X1=cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eE=Object.freeze({__proto__:null,base36:Z1,base36upper:X1});const tE=cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rE=cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var iE=Object.freeze({__proto__:null,base58btc:tE,base58flickr:rE});const nE=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sE=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oE=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),aE=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var cE=Object.freeze({__proto__:null,base64:nE,base64pad:sE,base64url:oE,base64urlpad:aE});const Hf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),uE=Hf.reduce((a,t,r)=>(a[r]=t,a),[]),hE=Hf.reduce((a,t,r)=>(a[t.codePointAt(0)]=r,a),[]);function lE(a){return a.reduce((t,r)=>(t+=uE[r],t),"")}function fE(a){const t=[];for(const r of a){const n=hE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const pE=Lo({prefix:"🚀",name:"base256emoji",encode:lE,decode:fE});var dE=Object.freeze({__proto__:null,base256emoji:pE}),gE=kf,Ol=128,yE=127,vE=~yE,mE=Math.pow(2,31);function kf(a,t,r){t=t||[],r=r||0;for(var n=r;a>=mE;)t[r++]=a&255|Ol,a/=128;for(;a&vE;)t[r++]=a&255|Ol,a>>>=7;return t[r]=a|0,kf.bytes=r-n+1,t}var wE=jc,_E=128,Rl=127;function jc(a,n){var r=0,n=n||0,o=0,c=n,f,g=a.length;do{if(c>=g)throw jc.bytes=0,new RangeError("Could not decode varint");f=a[c++],r+=o<28?(f&Rl)<<o:(f&Rl)*Math.pow(2,o),o+=7}while(f>=_E);return jc.bytes=c-n,r}var bE=Math.pow(2,7),EE=Math.pow(2,14),IE=Math.pow(2,21),xE=Math.pow(2,28),PE=Math.pow(2,35),SE=Math.pow(2,42),OE=Math.pow(2,49),RE=Math.pow(2,56),AE=Math.pow(2,63),TE=function(a){return a<bE?1:a<EE?2:a<IE?3:a<xE?4:a<PE?5:a<SE?6:a<OE?7:a<RE?8:a<AE?9:10},CE={encode:gE,decode:wE,encodingLength:TE},Kf=CE;const Al=(a,t,r=0)=>(Kf.encode(a,t,r),t),Tl=a=>Kf.encodingLength(a),qc=(a,t)=>{const r=t.byteLength,n=Tl(a),o=n+Tl(r),c=new Uint8Array(o+r);return Al(a,c,0),Al(r,c,n),c.set(t,o),new $E(a,r,t,c)};class $E{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}const Bf=({name:a,code:t,encode:r})=>new NE(a,t,r);class NE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?qc(this.code,r):r.then(n=>qc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ff=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),DE=Bf({name:"sha2-256",code:18,encode:Ff("SHA-256")}),jE=Bf({name:"sha2-512",code:19,encode:Ff("SHA-512")});var qE=Object.freeze({__proto__:null,sha256:DE,sha512:jE});const Vf=0,LE="identity",Gf=zf,ME=a=>qc(Vf,Gf(a)),zE={code:Vf,name:LE,encode:Gf,digest:ME};var UE=Object.freeze({__proto__:null,identity:zE});new TextEncoder,new TextDecoder;const Cl={...$1,...D1,...q1,...M1,...H1,...Y1,...eE,...iE,...cE,...dE};({...qE,...UE});function Wf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function HE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Jf(a,t,r,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:r},decoder:{decode:n}}}const $l=Jf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),yc=Jf("ascii","a",a=>{let t="a";for(let r=0;r<a.length;r++)t+=String.fromCharCode(a[r]);return t},a=>{a=a.substring(1);const t=HE(a.length);for(let r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return t}),kE={utf8:$l,"utf-8":$l,hex:Cl.base16,latin1:yc,ascii:yc,binary:yc,...Cl};function KE(a,t="utf8"){const r=kE[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const Qf="wc",BE=2,Jc="core",Ii=`${Qf}@2:${Jc}:`,FE={name:Jc,logger:"error"},VE={database:":memory:"},GE="crypto",Nl="client_ed25519_seed",WE=re.ONE_DAY,JE="keychain",QE="0.3",YE="messages",ZE="0.3",XE=re.SIX_HOURS,eI="publisher",Yf="irn",tI="error",Zf="wss://relay.walletconnect.com",Dl="wss://relay.walletconnect.org",rI="relayer",Vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},iI="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},nI=re.ONE_SECOND,sI="2.11.0",oI=1e4,aI="0.3",cI="WALLETCONNECT_CLIENT_ID",jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},uI="subscription",hI="0.3",lI=re.FIVE_SECONDS*1e3,fI="pairing",pI="0.3",Bn={wc_pairingDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:re.ONE_DAY,prompt:!1,tag:0},res:{ttl:re.ONE_DAY,prompt:!1,tag:0}}},Qn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},dI="history",gI="0.3",yI="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},vI="0.3",vc="verify-api",wn="https://verify.walletconnect.com",Lc="https://verify.walletconnect.org",mI=[wn,Lc],wI="echo",_I="https://echo.walletconnect.com";class bI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=JE,this.version=QE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:c}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,vf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?mf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class EI{constructor(t,r,n){this.core=t,this.logger=r,this.name=GE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=ml(o);return Tf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=H0();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),f=ml(c),g=Pc();return await xb(g,o,WE,f)},this.generateSharedKey=(o,c,f)=>{this.isInitialized();const g=this.getPrivateKey(o),v=k0(g,c);return this.setSymKey(v,f)},this.setSymKey=async(o,c)=>{this.isInitialized();const f=c||K0(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,f)=>{this.isInitialized();const g=B0(f),v=Bi(c);if(Xh(g)){const T=g.senderPublicKey,D=g.receiverPublicKey;o=await this.generateSharedKey(T,D)}const p=this.getSymKey(o),{type:_,senderPublicKey:x}=g;return F0({type:_,symKey:p,message:v,senderPublicKey:x})},this.decode=async(o,c,f)=>{this.isInitialized();const g=V0(c,f);if(Xh(g)){const v=g.receiverPublicKey,p=g.senderPublicKey;o=await this.generateSharedKey(v,p)}try{const v=this.getSymKey(o),p=G0({symKey:v,encoded:c});return ss(p)}catch(v){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=o=>{const c=el(o);return W0(c.type)},this.getPayloadSenderPublicKey=o=>{const c=el(o);return c.senderPublicKey?To(c.senderPublicKey,J0):void 0},this.core=t,this.logger=ur(r,this.name),this.keychain=n||new bI(this.core,this.logger)}get context(){return cr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Nl)}catch{t=Pc(),await this.keychain.set(Nl,t)}return KE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class II extends tb{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=YE,this.version=ZE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const c=_n(o);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[c]<"u"||(f[c]=o,this.messages.set(n,f),await this.persist()),c},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const c=this.get(n),f=_n(o);return typeof c[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=ur(t,this.name),this.core=r}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,vf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?mf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xI extends rb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new yr.EventEmitter,this.name=eI,this.queue=new Map,this.publishTimeout=re.toMiliseconds(re.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,c)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}});try{const g=(c==null?void 0:c.ttl)||XE,v=Sc(c),p=(c==null?void 0:c.prompt)||!1,_=(c==null?void 0:c.tag)||0,x=(c==null?void 0:c.id)||Gc().toString(),T={topic:n,message:o,opts:{ttl:g,relay:v,prompt:p,tag:_,id:x}},D=setTimeout(()=>this.queue.set(x,T),this.publishTimeout);try{await await Xn(this.rpcPublish(n,o,g,v,p,_,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(Vt.publish,T)}catch(A){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=c==null?void 0:c.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(x),A;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=t,this.logger=ur(r,this.name),this.registerEventListeners()}get context(){return cr(this.logger)}rpcPublish(t,r,n,o,c,f,g){var v,p,_,x;const T={method:bo(o.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:c,tag:f},id:g};return Ei((v=T.params)==null?void 0:v.prompt)&&((p=T.params)==null||delete p.prompt),Ei((_=T.params)==null?void 0:_.tag)&&((x=T.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:T}),this.relayer.request(T)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:o}=t;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Vt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class PI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const o=n.filter(c=>c!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var SI=Object.defineProperty,OI=Object.defineProperties,RI=Object.getOwnPropertyDescriptors,jl=Object.getOwnPropertySymbols,AI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,ql=(a,t,r)=>t in a?SI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Fn=(a,t)=>{for(var r in t||(t={}))AI.call(t,r)&&ql(a,r,t[r]);if(jl)for(var r of jl(t))TI.call(t,r)&&ql(a,r,t[r]);return a},mc=(a,t)=>OI(a,RI(t));class CI extends sb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new PI,this.events=new yr.EventEmitter,this.name=uI,this.version=hI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ii,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const c=Sc(o),f={topic:n,relay:c};this.pending.set(n,f);const g=await this.rpcSubscribe(n,c);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),g}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,c)=>{const f=new re.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=lI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ur(r,this.name),this.clientId=""}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const o=Sc(n);await this.rpcUnsubscribe(t,r,o);const c=Ft("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const n={method:bo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Xn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}return _n(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:bo(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Xn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}}rpcUnsubscribe(t,r,n){const o={method:bo(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,mc(Fn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Fn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Fn({},r)),this.topicMap.set(r.topic,t),this.events.emit(jr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(jr.deleted,mc(Fn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(jr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(jr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);bn(r)&&this.onBatchSubscribe(r.map((n,o)=>mc(Fn({},t[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Vt.connect,async()=>{await this.onConnect()}),this.relayer.on(Vt.disconnect,()=>{this.onDisconnect()}),this.events.on(jr.created,async t=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(jr.deleted,async t=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var $I=Object.defineProperty,Ll=Object.getOwnPropertySymbols,NI=Object.prototype.hasOwnProperty,DI=Object.prototype.propertyIsEnumerable,Ml=(a,t,r)=>t in a?$I(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,jI=(a,t)=>{for(var r in t||(t={}))NI.call(t,r)&&Ml(a,r,t[r]);if(Ll)for(var r of Ll(t))DI.call(t,r)&&Ml(a,r,t[r]);return a};class qI extends ib{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new yr.EventEmitter,this.name=rI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Vt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Vt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ur(t.logger,this.name):No(Do({level:t.logger||tI})),this.messages=new II(this.logger,t.core),this.subscriber=new CI(this,this.logger),this.publisher=new xI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Zf,this.projectId=t.projectId,this.bundleId=Q0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Dl}...`),await this.restartTransport(Dl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},oI)}get context(){return cr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(o)return o;let c;const f=g=>{g.topic===t&&(this.subscriber.off(jr.created,f),c())};return await Promise.all([new Promise(g=>{c=g,this.subscriber.on(jr.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Xn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(jr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Xn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await tl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new c1(new f1(Y0({sdkVersion:sI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Wc(t)){if(!t.method.endsWith(iI))return;const r=t.params,{topic:n,message:o,publishedAt:c}=r.data,f={topic:n,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(jI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else as(t)&&this.events.emit(Vt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Vt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=jo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Vt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await tl();Z0(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},re.toMiliseconds(nI)))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var LI=Object.defineProperty,zl=Object.getOwnPropertySymbols,MI=Object.prototype.hasOwnProperty,zI=Object.prototype.propertyIsEnumerable,Ul=(a,t,r)=>t in a?LI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Hl=(a,t)=>{for(var r in t||(t={}))MI.call(t,r)&&Ul(a,r,t[r]);if(zl)for(var r of zl(t))zI.call(t,r)&&Ul(a,r,t[r]);return a};class Mo extends nb{constructor(t,r,n,o=Ii,c=void 0){super(t,r,n,o),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=aI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!Ei(f)?this.map.set(this.getKey(f),f):z0(f)?this.map.set(f.id,f):U0(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(v=>d1(g[v],f[v]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const v=Hl(Hl({},this.getData(f)),g);this.map.set(f,v),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=ur(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class UI{constructor(t,r){this.core=t,this.logger=r,this.name=fI,this.version=pI,this.events=new Kc,this.initialized=!1,this.storagePrefix=Ii,this.ignoredPayloadTypes=[df],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Pc(),o=await this.core.crypto.setSymKey(n),c=qr(re.FIVE_MINUTES),f={protocol:Yf},g={topic:o,expiry:c,relay:f,active:!1},v=X0({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:v}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:c,relay:f}=rl(n.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const v=qr(re.FIVE_MINUTES),p={topic:o,relay:f,expiry:v,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,v),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Qn.create,p),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:f})),p},this.activate=async({topic:n})=>{this.isInitialized();const o=qr(re.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:v}=vn();this.events.once(At("pairing_ping",c),({error:p})=>{p?v(p):g()}),await f()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Ft("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,c)=>{const f=Ki(o,c),g=await this.core.crypto.encode(n,f),v=Bn[o].req;return this.core.history.set(n,f),this.core.relayer.publish(n,g,v),f.id},this.sendResult=async(n,o,c)=>{const f=jo(n,c),g=await this.core.crypto.encode(o,f),v=await this.core.history.get(o,n),p=Bn[v.request.method].res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.sendError=async(n,o,c)=>{const f=qo(n,c),g=await this.core.crypto.encode(o,f),v=await this.core.history.get(o,n),p=Bn[v.request.method]?Bn[v.request.method].res:Bn.unregistered_method.res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ft("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>bi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:c}=n,f=(await this.core.history.get(o,c.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,o)=>{const{id:c}=o;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Qn.ping,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,o)=>{const{id:c}=o;setTimeout(()=>{ci(o)?this.events.emit(At("pairing_ping",c),{}):Or(o)&&this.events.emit(At("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Qn.delete,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:c,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=Ft("WC_METHOD_UNSUPPORTED",f);await this.sendError(c,n,g),this.logger.error(g)}catch(g){await this.sendError(c,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ft("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!ar(n)){const{message:f}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(f)}if(!ew(n.uri)){const{message:f}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(f)}const c=rl(n.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:f}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(c!=null&&c.symKey)){const{message:f}=G("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async n=>{if(!ar(n)){const{message:c}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:c}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!mn(n,!1)){const{message:o}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(bi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=t,this.logger=ur(r,this.name),this.pairings=new Mo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return cr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Vt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{Wc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):as(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async t=>{const{topic:r}=gf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Qn.expire,{topic:r}))})}}class HI extends eb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new yr.EventEmitter,this.name=dI,this.version=gI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:c}),this.records.has(o.id))return;const f={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:c,expiry:qr(re.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Br.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Or(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===n){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Br.deleted,c)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Ki(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Br.created,t=>{const r=Br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Br.updated,t=>{const r=Br.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Br.deleted,t=>{const r=Br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{re.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kI extends ob{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new yr.EventEmitter,this.name=yI,this.version=vI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const c=this.formatTarget(n),f={target:c,expiry:o};this.expirations.set(c,f),this.checkExpiry(c,f),this.events.emit(Sr.created,{target:c,expiration:f})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:c})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return tw(t);if(typeof t=="number")return rw(t);const{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;re.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Sr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,t=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.expired,t=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.deleted,t=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class KI extends ab{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=vc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||iw()||!yf())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Lc;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let c;try{c=await this.fetchAttestation(n.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(f),c=await this.fetchAttestation(n.attestationId,Lc)}return c},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const c=this.startAbortTimer(re.ONE_SECOND*2),f=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(c=>{if(document.getElementById(vc))return c();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=vc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=c}),new Promise((c,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},re.toMiliseconds(re.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||wn;return mI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${wn}`),o=wn),o},this.logger=ur(r,this.name),this.verifyUrl=wn,this.abortController=new AbortController,this.isDevEnv=nw()&&w1.IS_VITEST}get context(){return cr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),re.toMiliseconds(t))}}class BI extends cb{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=wI,this.registerDeviceToken=async n=>{const{clientId:o,token:c,notificationType:f,enableEncrypted:g=!1}=n,v=`${_I}/${this.projectId}/clients`;await m1(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:f,token:c,always_raw:g})})},this.logger=ur(r,this.context)}}var FI=Object.defineProperty,kl=Object.getOwnPropertySymbols,VI=Object.prototype.hasOwnProperty,GI=Object.prototype.propertyIsEnumerable,Kl=(a,t,r)=>t in a?FI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Bl=(a,t)=>{for(var r in t||(t={}))VI.call(t,r)&&Kl(a,r,t[r]);if(kl)for(var r of kl(t))GI.call(t,r)&&Kl(a,r,t[r]);return a};class Qc extends X_{constructor(t){super(t),this.protocol=Qf,this.version=BE,this.name=Jc,this.events=new yr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Zf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||FE.logger}));this.logger=ur(r,this.name),this.heartbeat=new En.HeartBeat,this.crypto=new EI(this,this.logger,t==null?void 0:t.keychain),this.history=new HI(this,this.logger),this.expirer=new kI(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new r_(Bl(Bl({},VE),t==null?void 0:t.storageOptions)),this.relayer=new qI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new UI(this,this.logger),this.verify=new KI(this.projectId||"",this.logger),this.echoClient=new BI(this.projectId||"",this.logger)}static async init(t){const r=new Qc(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(cI,n),r}get context(){return cr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const WI=Qc,Xf="wc",ep=2,tp="client",Yc=`${Xf}@${ep}:${tp}:`,wc={name:tp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Fl="WALLETCONNECT_DEEPLINK_CHOICE",JI="proposal",rp="Proposal expired",QI="session",mo=re.SEVEN_DAYS,YI="engine",Vn={wc_sessionPropose:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:re.THIRTY_SECONDS,prompt:!1,tag:1115}}},_c={min:re.FIVE_MINUTES,max:re.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},ZI="request",XI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var ex=Object.defineProperty,tx=Object.defineProperties,rx=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,Gl=(a,t,r)=>t in a?ex(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,sr=(a,t)=>{for(var r in t||(t={}))ix.call(t,r)&&Gl(a,r,t[r]);if(Vl)for(var r of Vl(t))nx.call(t,r)&&Gl(a,r,t[r]);return a},Gn=(a,t)=>tx(a,rx(t));class sx extends hb{constructor(t){super(t),this.name=YI,this.events=new Kc,this.initialized=!1,this.ignoredPayloadTypes=[df],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=re.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Vn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Gn(sr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:g,relays:v}=n;let p=o,_,x=!1;if(p&&(x=this.client.core.pairing.pairings.get(p).active),!p||!x){const{topic:oe,uri:te}=await this.client.core.pairing.create();p=oe,_=te}const T=await this.client.core.crypto.generateKeyPair(),D=sr({requiredNamespaces:c,optionalNamespaces:f,relays:v??[{protocol:Yf}],proposer:{publicKey:T,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:A,resolve:J,done:ee}=vn(re.FIVE_MINUTES,rp);if(this.events.once(At("session_connect"),async({error:oe,session:te})=>{if(oe)A(oe);else if(te){te.self.publicKey=T;const he=Gn(sr({},te),{requiredNamespaces:te.requiredNamespaces,optionalNamespaces:te.optionalNamespaces});await this.client.session.set(te.topic,he),await this.setExpiry(te.topic,te.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:te.peer.metadata}),J(he)}}),!p){const{message:oe}=G("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(oe)}const ce=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),ae=qr(re.FIVE_MINUTES);return await this.setProposal(ce,sr({id:ce,expiry:ae},D)),{uri:_,approval:ee}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:c,sessionProperties:f}=r,g=this.client.proposal.get(n);let{pairingTopic:v,proposer:p,requiredNamespaces:_,optionalNamespaces:x}=g;v=v||"",Eo(_)||(_=ow(c,"approve()"));const T=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,A=await this.client.core.crypto.generateSharedKey(T,D);v&&n&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:p.metadata}),await this.sendResult({id:n,topic:v,result:{relay:{protocol:o??"irn"},responderPublicKey:T}}),await this.client.proposal.delete(n,Ft("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const J=sr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:_,optionalNamespaces:x,pairingTopic:v,controller:{publicKey:T,metadata:this.client.metadata},expiry:qr(mo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(A),await this.sendRequest({topic:A,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const ee=Gn(sr({},J),{topic:A,pairingTopic:v,acknowledged:!1,self:J.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:T});return await this.client.session.set(A,ee),await this.setExpiry(A,qr(mo)),{topic:A,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(A)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,o),await this.client.proposal.delete(n,Ft("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:v}=vn();return this.events.once(At("session_update",c),({error:p})=>{p?v(p):g()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:f,reject:g}=vn();return this.events.once(At("session_extend",o),({error:v})=>{v?g(v):f()}),await this.setExpiry(n,qr(mo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:c,expiry:f}=r,g=Vc(),{done:v,resolve:p,reject:_}=vn(f,"Request expired. Please try again.");return this.events.once(At("session_request",g),({error:x,result:T})=>{x?_(x):p(T)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:g,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:f,throwOnFailedPublish:!0}).catch(T=>_(T)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:n,id:g}),x()}),new Promise(async x=>{const T=await aw(this.client.core.storage,Fl);cw({id:g,topic:c,wcDeepLink:T}),x()}),v()]).then(x=>x[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:c}=o;ci(o)?await this.sendResult({id:c,topic:n,result:o.result,throwOnFailedPublish:!0}):Or(o)&&await this.sendError(c,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:f,reject:g}=vn();this.events.once(At("session_ping",o),({error:v})=>{v?g(v):f()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:c}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Ft("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>uw(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var f,g;return((f=c.peerMetadata)==null?void 0:f.url)&&((g=c.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ft("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Fl).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,Ft("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ft("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Vn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(o,{id:o,topic:c,params:f,verifyContext:g}),n&&this.client.core.expirer.set(o,qr(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:c,expiry:f,relayRpcId:g,clientRpcId:v,throwOnFailedPublish:p}=r,_=Ki(o,c,v);if(yf()&&XI.includes(o)){const D=_n(JSON.stringify(_));this.client.core.verify.register({attestationId:D})}const x=await this.client.core.crypto.encode(n,_),T=Vn[o].req;return f&&(T.ttl=f),g&&(T.id=g),this.client.core.history.set(n,_),p?(T.internal=Gn(sr({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,x,T)):this.client.core.relayer.publish(n,x,T).catch(D=>this.client.logger.error(D)),_.id},this.sendResult=async r=>{const{id:n,topic:o,result:c,throwOnFailedPublish:f}=r,g=jo(n,c),v=await this.client.core.crypto.encode(o,g),p=await this.client.core.history.get(o,n),_=Vn[p.request.method].res;f?(_.internal=Gn(sr({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,v,_)):this.client.core.relayer.publish(o,v,_).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(g)},this.sendError=async(r,n,o)=>{const c=qo(r,o),f=await this.client.core.crypto.encode(n,c),g=await this.client.core.history.get(n,r),v=Vn[g.request.method].res;this.client.core.relayer.publish(n,f,v),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{bi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{bi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,c=(await this.client.core.history.get(n,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:c}=n;try{this.isValidConnect(sr({},n.params));const f=qr(re.FIVE_MINUTES),g=sr({id:c,pairingTopic:r,expiry:f},o);await this.setProposal(c,g);const v=_n(JSON.stringify(n)),p=await this.getVerifyContext(v,g.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:g,verifyContext:p})}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(ci(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const v=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const p=await this.client.core.crypto.generateSharedKey(g,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const _=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:r})}else Or(n)&&(await this.client.proposal.delete(o,Ft("USER_DISCONNECTED")),this.events.emit(At("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:f,controller:g,expiry:v,namespaces:p,requiredNamespaces:_,optionalNamespaces:x,sessionProperties:T,pairingTopic:D}=n.params,A=sr({topic:r,relay:f,expiry:v,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:_,optionalNamespaces:x,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},T&&{sessionProperties:T});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(At("session_connect"),{session:A}),this.cleanupDuplicatePairings(A)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;ci(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(At("session_approve",o),{})):Or(n)&&(await this.client.session.delete(r,Ft("USER_DISCONNECTED")),this.events.emit(At("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:c}=n;try{const f=`${r}_session_update`,g=po.get(f);if(g&&this.isRequestOutOfSync(g,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(sr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),po.set(f,c)}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_update",o),{}):Or(n)&&this.events.emit(At("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,qr(mo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_extend",o),{}):Or(n)&&this.events.emit(At("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{ci(n)?this.events.emit(At("session_ping",o),{}):Or(n)&&this.events.emit(At("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Vt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:c}=n;try{this.isValidRequest(sr({topic:r},c));const f=_n(JSON.stringify(Ki("wc_sessionRequest",c,o))),g=this.client.session.get(r),v=await this.getVerifyContext(f,g.peer.metadata),p={id:o,topic:r,params:c,verifyContext:v};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_request",o),{result:n.result}):Or(n)&&this.events.emit(At("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:c}=n;try{const f=`${r}_session_event_${c.event.name}`,g=po.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(sr({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),po.set(f,o)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},re.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Ki("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!ar(r)){const{message:v}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:f,relays:g}=r;if(Ei(n)||await this.isValidPairingTopic(n),!hw(g)){const{message:v}=G("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(v)}!Ei(o)&&Eo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ei(c)&&Eo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ei(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=lw(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!ar(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:c,sessionProperties:f}=r;await this.isValidProposalId(n);const g=this.client.proposal.get(n),v=uc(o,"approve()");if(v)throw new Error(v.message);const p=il(g.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!mn(c,!0)){const{message:_}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(_)}Ei(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!ar(r)){const{message:c}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!fw(o)){const{message:c}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!ar(r)){const{message:p}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:o,namespaces:c,expiry:f}=r;if(!pw(n)){const{message:p}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const g=dw(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const v=uc(c,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(bi(f)){const{message:p}=G("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!ar(r)){const{message:v}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const c=this.client.session.get(n),f=uc(o,"update()");if(f)throw new Error(f.message);const g=il(c.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!ar(r)){const{message:v}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:n,request:o,chainId:c,expiry:f}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!nl(g,c)){const{message:v}=G("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(v)}if(!gw(o)){const{message:v}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(v)}if(!yw(g,c,o.method)){const{message:v}=G("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(v)}if(f&&!vw(f,_c)){const{message:v}=G("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${_c.min} and ${_c.max}`);throw new Error(v)}},this.isValidRespond=async r=>{var n;if(!ar(r)){const{message:f}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(f)}const{topic:o,response:c}=r;try{await this.isValidSessionTopic(o)}catch(f){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),f}if(!mw(c)){const{message:f}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidPing=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!ar(r)){const{message:g}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:n,event:o,chainId:c}=r;await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!nl(f,c)){const{message:g}=G("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(g)}if(!ww(o)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!_w(f,c,o.name)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||wn,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!mn(o,!1)){const{message:c}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Vt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{Wc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):as(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async t=>{const{topic:r,id:n}=gf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Qn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!mn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!mn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=G("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(mn(t,!1)){const{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!bw(t)){const{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=G("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class ox extends Mo{constructor(t,r){super(t,r,JI,Yc),this.core=t,this.logger=r}}class ax extends Mo{constructor(t,r){super(t,r,QI,Yc),this.core=t,this.logger=r}}class cx extends Mo{constructor(t,r){super(t,r,ZI,Yc,n=>n.id),this.core=t,this.logger=r}}let ux=class ip extends ub{constructor(t){super(t),this.protocol=Xf,this.version=ep,this.name=wc.name,this.events=new yr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||wc.name,this.metadata=(t==null?void 0:t.metadata)||sw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||wc.logger}));this.core=(t==null?void 0:t.core)||new WI(t),this.logger=ur(r,this.name),this.session=new ax(this.core,this.logger),this.proposal=new ox(this.core,this.logger),this.pendingRequest=new cx(this.core,this.logger),this.engine=new sx(this)}static async init(t){const r=new ip(t);return await r.initialize(),r}get context(){return cr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Mc={exports:{}};(function(a,t){var r=typeof self<"u"?self:Lr,n=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(f){var g={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function v(b){return b&&DataView.prototype.isPrototypeOf(b)}if(g.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(b){return b&&p.indexOf(Object.prototype.toString.call(b))>-1};function x(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function T(b){return typeof b!="string"&&(b=String(b)),b}function D(b){var O={next:function(){var Q=b.shift();return{done:Q===void 0,value:Q}}};return g.iterable&&(O[Symbol.iterator]=function(){return O}),O}function A(b){this.map={},b instanceof A?b.forEach(function(O,Q){this.append(Q,O)},this):Array.isArray(b)?b.forEach(function(O){this.append(O[0],O[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(O){this.append(O,b[O])},this)}A.prototype.append=function(b,O){b=x(b),O=T(O);var Q=this.map[b];this.map[b]=Q?Q+", "+O:O},A.prototype.delete=function(b){delete this.map[x(b)]},A.prototype.get=function(b){return b=x(b),this.has(b)?this.map[b]:null},A.prototype.has=function(b){return this.map.hasOwnProperty(x(b))},A.prototype.set=function(b,O){this.map[x(b)]=T(O)},A.prototype.forEach=function(b,O){for(var Q in this.map)this.map.hasOwnProperty(Q)&&b.call(O,this.map[Q],Q,this)},A.prototype.keys=function(){var b=[];return this.forEach(function(O,Q){b.push(Q)}),D(b)},A.prototype.values=function(){var b=[];return this.forEach(function(O){b.push(O)}),D(b)},A.prototype.entries=function(){var b=[];return this.forEach(function(O,Q){b.push([Q,O])}),D(b)},g.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function J(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function ee(b){return new Promise(function(O,Q){b.onload=function(){O(b.result)},b.onerror=function(){Q(b.error)}})}function ce(b){var O=new FileReader,Q=ee(O);return O.readAsArrayBuffer(b),Q}function ae(b){var O=new FileReader,Q=ee(O);return O.readAsText(b),Q}function oe(b){for(var O=new Uint8Array(b),Q=new Array(O.length),le=0;le<O.length;le++)Q[le]=String.fromCharCode(O[le]);return Q.join("")}function te(b){if(b.slice)return b.slice(0);var O=new Uint8Array(b.byteLength);return O.set(new Uint8Array(b)),O.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:g.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:g.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():g.arrayBuffer&&g.blob&&v(b)?(this._bodyArrayBuffer=te(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||_(b))?this._bodyArrayBuffer=te(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var b=J(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?J(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ce)}),this.text=function(){var b=J(this);if(b)return b;if(this._bodyBlob)return ae(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(oe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(wt)}),this.json=function(){return this.text().then(JSON.parse)},this}var pe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Y(b){var O=b.toUpperCase();return pe.indexOf(O)>-1?O:b}function ve(b,O){O=O||{};var Q=O.body;if(b instanceof ve){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,O.headers||(this.headers=new A(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!Q&&b._bodyInit!=null&&(Q=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new A(O.headers)),this.method=Y(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Q)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Q)}ve.prototype.clone=function(){return new ve(this,{body:this._bodyInit})};function wt(b){var O=new FormData;return b.trim().split("&").forEach(function(Q){if(Q){var le=Q.split("="),k=le.shift().replace(/\+/g," "),H=le.join("=").replace(/\+/g," ");O.append(decodeURIComponent(k),decodeURIComponent(H))}}),O}function nt(b){var O=new A,Q=b.replace(/\r?\n[\t ]+/g," ");return Q.split(/\r?\n/).forEach(function(le){var k=le.split(":"),H=k.shift().trim();if(H){var K=k.join(":").trim();O.append(H,K)}}),O}he.call(ve.prototype);function Ke(b,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new A(O.headers),this.url=O.url||"",this._initBody(b)}he.call(Ke.prototype),Ke.prototype.clone=function(){return new Ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},Ke.error=function(){var b=new Ke(null,{status:0,statusText:""});return b.type="error",b};var Lt=[301,302,303,307,308];Ke.redirect=function(b,O){if(Lt.indexOf(O)===-1)throw new RangeError("Invalid status code");return new Ke(null,{status:O,headers:{location:b}})},f.DOMException=c.DOMException;try{new f.DOMException}catch{f.DOMException=function(O,Q){this.message=O,this.name=Q;var le=Error(O);this.stack=le.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Mt(b,O){return new Promise(function(Q,le){var k=new ve(b,O);if(k.signal&&k.signal.aborted)return le(new f.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function K(){H.abort()}H.onload=function(){var B={status:H.status,statusText:H.statusText,headers:nt(H.getAllResponseHeaders()||"")};B.url="responseURL"in H?H.responseURL:B.headers.get("X-Request-URL");var Xe="response"in H?H.response:H.responseText;Q(new Ke(Xe,B))},H.onerror=function(){le(new TypeError("Network request failed"))},H.ontimeout=function(){le(new TypeError("Network request failed"))},H.onabort=function(){le(new f.DOMException("Aborted","AbortError"))},H.open(k.method,k.url,!0),k.credentials==="include"?H.withCredentials=!0:k.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&g.blob&&(H.responseType="blob"),k.headers.forEach(function(B,Xe){H.setRequestHeader(Xe,B)}),k.signal&&(k.signal.addEventListener("abort",K),H.onreadystatechange=function(){H.readyState===4&&k.signal.removeEventListener("abort",K)}),H.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return Mt.polyfill=!0,c.fetch||(c.fetch=Mt,c.Headers=A,c.Request=ve,c.Response=Ke),f.Headers=A,f.Request=ve,f.Response=Ke,f.fetch=Mt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(Mc,Mc.exports);var hx=Mc.exports;const Wl=Ao(hx);var lx=Object.defineProperty,fx=Object.defineProperties,px=Object.getOwnPropertyDescriptors,Jl=Object.getOwnPropertySymbols,dx=Object.prototype.hasOwnProperty,gx=Object.prototype.propertyIsEnumerable,Ql=(a,t,r)=>t in a?lx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Yl=(a,t)=>{for(var r in t||(t={}))dx.call(t,r)&&Ql(a,r,t[r]);if(Jl)for(var r of Jl(t))gx.call(t,r)&&Ql(a,r,t[r]);return a},Zl=(a,t)=>fx(a,px(t));const yx={Accept:"application/json","Content-Type":"application/json"},vx="POST",Xl={headers:yx,method:vx},ef=10;let Pi=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new yr.EventEmitter,this.isAvailable=!1,this.registering=!1,!El(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Bi(t),n=await(await Wl(this.url,Zl(Yl({},Xl),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!El(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Bi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Wl(t,Zl(Yl({},Xl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),c=qo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Nf(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ef&&this.events.setMaxListeners(ef)}};class Si extends qf{constructor(t){super(t),this.events=new yr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ki(t.method,t.params||[],t.id||Gc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Or(c)?o(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),as(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const tf="error",mx="wss://relay.walletconnect.com",wx="wc",_x="universal_provider",rf=`${wx}@2:${_x}:`,bx="https://rpc.walletconnect.com/v1/",ui={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var r,n="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",p=500,_="__lodash_placeholder__",x=1,T=2,D=4,A=1,J=2,ee=1,ce=2,ae=4,oe=8,te=16,he=32,pe=64,Y=128,ve=256,wt=512,nt=30,Ke="...",Lt=800,Mt=16,b=1,O=2,Q=3,le=1/0,k=9007199254740991,H=17976931348623157e292,K=NaN,B=4294967295,Xe=B-1,st=B>>>1,Oi=[["ary",Y],["bind",ee],["bindKey",ce],["curry",oe],["curryRight",te],["flip",wt],["partial",he],["partialRight",pe],["rearg",ve]],Ee="[object Arguments]",Rr="[object Array]",j="[object AsyncFunction]",N="[object Boolean]",C="[object Date]",h="[object DOMException]",I="[object Error]",Z="[object Function]",ue="[object GeneratorFunction]",me="[object Map]",Oe="[object Number]",Ae="[object Null]",Ie="[object Object]",_t="[object Promise]",dt="[object Proxy]",et="[object RegExp]",Ce="[object Set]",Be="[object String]",Fe="[object Symbol]",tt="[object Undefined]",je="[object WeakMap]",Ve="[object WeakSet]",Re="[object ArrayBuffer]",Le="[object DataView]",ot="[object Float32Array]",Ne="[object Float64Array]",bt="[object Int8Array]",Tt="[object Int16Array]",zt="[object Int32Array]",Ut="[object Uint8Array]",Nt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",Xt="[object Uint32Array]",Mr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,hi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,at=RegExp(hi.source),Je=RegExp(Ri.source),ct=/<%-([\s\S]+?)%>/g,ut=/<%([\s\S]+?)%>/g,rt=/<%=([\s\S]+?)%>/g,Qe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ht=/[\\^$.*+?()[\]{}|]/g,xt=RegExp(ht.source),lt=/^\s+/,gt=/\s/,ft=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ke=/\{\n\/\* \[wrapped with (.+)\] \*/,Pt=/,? & /,St=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zo=/[()=,{}\[\]\/\s]/,Uo=/\\(\\)?/g,Ho=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,ko=/^[-+]0x[0-9a-f]+$/i,Ko=/^0b[01]+$/i,Bo=/^\[object .+?Constructor\]$/,Fo=/^0o[0-7]+$/i,Vo=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,Ji="\\ud800-\\udfff",Wo="\\u0300-\\u036f",Jo="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",us=Wo+Jo+Qi,hs="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",Qo="\\xac\\xb1\\xd7\\xf7",Yo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zo="\\u2000-\\u206f",Xo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ls="A-Z\\xc0-\\xd6\\xd8-\\xde",fs="\\ufe0e\\ufe0f",Ai=Qo+Yo+Zo+Xo,In="['’]",Ti="["+Ji+"]",xn="["+Ai+"]",Ci="["+us+"]",ps="\\d+",ea="["+hs+"]",ds="["+Ar+"]",gs="[^"+Ji+Ai+ps+hs+Ar+ls+"]",Yi="\\ud83c[\\udffb-\\udfff]",ta="(?:"+Ci+"|"+Yi+")",ys="[^"+Ji+"]",Zi="(?:\\ud83c[\\udde6-\\uddff]){2}",li="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+ls+"]",vs="\\u200d",ms="(?:"+ds+"|"+gs+")",zr="(?:"+hr+"|"+gs+")",ws="(?:"+In+"(?:d|ll|m|re|s|t|ve))?",_s="(?:"+In+"(?:D|LL|M|RE|S|T|VE))?",bs=ta+"?",Es="["+fs+"]?",ra="(?:"+vs+"(?:"+[ys,Zi,li].join("|")+")"+Es+bs+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Is="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xs=Es+bs+ra,Xi="(?:"+[ea,Zi,li].join("|")+")"+xs,ia="(?:"+[ys+Ci+"?",Ci,Zi,li,Ti].join("|")+")",Pn=RegExp(In,"g"),na=RegExp(Ci,"g"),en=RegExp(Yi+"(?="+Yi+")|"+ia+xs,"g"),Ps=RegExp([hr+"?"+ds+"+"+ws+"(?="+[xn,hr,"$"].join("|")+")",zr+"+"+_s+"(?="+[xn,hr+ms,"$"].join("|")+")",hr+"?"+ms+"+"+ws,hr+"+"+_s,Is,Wr,ps,Xi].join("|"),"g"),Ss=RegExp("["+vs+Ji+us+fs+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Os=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sa=-1,Me={};Me[ot]=Me[Ne]=Me[bt]=Me[Tt]=Me[zt]=Me[Ut]=Me[Nt]=Me[Gt]=Me[Xt]=!0,Me[Ee]=Me[Rr]=Me[Re]=Me[N]=Me[Le]=Me[C]=Me[I]=Me[Z]=Me[me]=Me[Oe]=Me[Ie]=Me[et]=Me[Ce]=Me[Be]=Me[je]=!1;var qe={};qe[Ee]=qe[Rr]=qe[Re]=qe[Le]=qe[N]=qe[C]=qe[ot]=qe[Ne]=qe[bt]=qe[Tt]=qe[zt]=qe[me]=qe[Oe]=qe[Ie]=qe[et]=qe[Ce]=qe[Be]=qe[Fe]=qe[Ut]=qe[Nt]=qe[Gt]=qe[Xt]=!0,qe[I]=qe[Z]=qe[je]=!1;var m={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ze=parseFloat,de=parseInt,Ge=typeof Wn=="object"&&Wn&&Wn.Object===Object&&Wn,Ot=typeof self=="object"&&self&&self.Object===Object&&self,Pe=Ge||Ot||Function("return this")(),Ue=t&&!t.nodeType&&t,yt=Ue&&!0&&a&&!a.nodeType&&a,er=yt&&yt.exports===Ue,Rt=er&&Ge.process,We=function(){try{var S=yt&&yt.require&&yt.require("util").types;return S||Rt&&Rt.binding&&Rt.binding("util")}catch{}}(),Jt=We&&We.isArrayBuffer,Tr=We&&We.isDate,mr=We&&We.isMap,Ur=We&&We.isRegExp,Sn=We&&We.isSet,Ni=We&&We.isTypedArray;function Dt(S,q,$){switch($.length){case 0:return S.call(q);case 1:return S.call(q,$[0]);case 2:return S.call(q,$[0],$[1]);case 3:return S.call(q,$[0],$[1],$[2])}return S.apply(q,$)}function op(S,q,$,W){for(var fe=-1,Te=S==null?0:S.length;++fe<Te;){var Ct=S[fe];q(W,Ct,$(Ct),S)}return W}function wr(S,q){for(var $=-1,W=S==null?0:S.length;++$<W&&q(S[$],$,S)!==!1;);return S}function ap(S,q){for(var $=S==null?0:S.length;$--&&q(S[$],$,S)!==!1;);return S}function eu(S,q){for(var $=-1,W=S==null?0:S.length;++$<W;)if(!q(S[$],$,S))return!1;return!0}function fi(S,q){for(var $=-1,W=S==null?0:S.length,fe=0,Te=[];++$<W;){var Ct=S[$];q(Ct,$,S)&&(Te[fe++]=Ct)}return Te}function Rs(S,q){var $=S==null?0:S.length;return!!$&&tn(S,q,0)>-1}function oa(S,q,$){for(var W=-1,fe=S==null?0:S.length;++W<fe;)if($(q,S[W]))return!0;return!1}function Ye(S,q){for(var $=-1,W=S==null?0:S.length,fe=Array(W);++$<W;)fe[$]=q(S[$],$,S);return fe}function pi(S,q){for(var $=-1,W=q.length,fe=S.length;++$<W;)S[fe+$]=q[$];return S}function aa(S,q,$,W){var fe=-1,Te=S==null?0:S.length;for(W&&Te&&($=S[++fe]);++fe<Te;)$=q($,S[fe],fe,S);return $}function cp(S,q,$,W){var fe=S==null?0:S.length;for(W&&fe&&($=S[--fe]);fe--;)$=q($,S[fe],fe,S);return $}function ca(S,q){for(var $=-1,W=S==null?0:S.length;++$<W;)if(q(S[$],$,S))return!0;return!1}var up=ua("length");function hp(S){return S.split("")}function lp(S){return S.match(St)||[]}function tu(S,q,$){var W;return $(S,function(fe,Te,Ct){if(q(fe,Te,Ct))return W=Te,!1}),W}function As(S,q,$,W){for(var fe=S.length,Te=$+(W?1:-1);W?Te--:++Te<fe;)if(q(S[Te],Te,S))return Te;return-1}function tn(S,q,$){return q===q?Ip(S,q,$):As(S,ru,$)}function fp(S,q,$,W){for(var fe=$-1,Te=S.length;++fe<Te;)if(W(S[fe],q))return fe;return-1}function ru(S){return S!==S}function iu(S,q){var $=S==null?0:S.length;return $?la(S,q)/$:K}function ua(S){return function(q){return q==null?r:q[S]}}function ha(S){return function(q){return S==null?r:S[q]}}function nu(S,q,$,W,fe){return fe(S,function(Te,Ct,He){$=W?(W=!1,Te):q($,Te,Ct,He)}),$}function pp(S,q){var $=S.length;for(S.sort(q);$--;)S[$]=S[$].value;return S}function la(S,q){for(var $,W=-1,fe=S.length;++W<fe;){var Te=q(S[W]);Te!==r&&($=$===r?Te:$+Te)}return $}function fa(S,q){for(var $=-1,W=Array(S);++$<S;)W[$]=q($);return W}function dp(S,q){return Ye(q,function($){return[$,S[$]]})}function su(S){return S&&S.slice(0,uu(S)+1).replace(lt,"")}function lr(S){return function(q){return S(q)}}function pa(S,q){return Ye(q,function($){return S[$]})}function On(S,q){return S.has(q)}function ou(S,q){for(var $=-1,W=S.length;++$<W&&tn(q,S[$],0)>-1;);return $}function au(S,q){for(var $=S.length;$--&&tn(q,S[$],0)>-1;);return $}function gp(S,q){for(var $=S.length,W=0;$--;)S[$]===q&&++W;return W}var yp=ha(m),vp=ha(P);function mp(S){return"\\"+V[S]}function wp(S,q){return S==null?r:S[q]}function rn(S){return Ss.test(S)}function _p(S){return $i.test(S)}function bp(S){for(var q,$=[];!(q=S.next()).done;)$.push(q.value);return $}function da(S){var q=-1,$=Array(S.size);return S.forEach(function(W,fe){$[++q]=[fe,W]}),$}function cu(S,q){return function($){return S(q($))}}function di(S,q){for(var $=-1,W=S.length,fe=0,Te=[];++$<W;){var Ct=S[$];(Ct===q||Ct===_)&&(S[$]=_,Te[fe++]=$)}return Te}function Ts(S){var q=-1,$=Array(S.size);return S.forEach(function(W){$[++q]=W}),$}function Ep(S){var q=-1,$=Array(S.size);return S.forEach(function(W){$[++q]=[W,W]}),$}function Ip(S,q,$){for(var W=$-1,fe=S.length;++W<fe;)if(S[W]===q)return W;return-1}function xp(S,q,$){for(var W=$+1;W--;)if(S[W]===q)return W;return W}function nn(S){return rn(S)?Sp(S):up(S)}function Cr(S){return rn(S)?Op(S):hp(S)}function uu(S){for(var q=S.length;q--&&gt.test(S.charAt(q)););return q}var Pp=ha(z);function Sp(S){for(var q=en.lastIndex=0;en.test(S);)++q;return q}function Op(S){return S.match(en)||[]}function Rp(S){return S.match(Ps)||[]}var Ap=function S(q){q=q==null?Pe:sn.defaults(Pe.Object(),q,sn.pick(Pe,Os));var $=q.Array,W=q.Date,fe=q.Error,Te=q.Function,Ct=q.Math,He=q.Object,ga=q.RegExp,Tp=q.String,_r=q.TypeError,Cs=$.prototype,Cp=Te.prototype,on=He.prototype,$s=q["__core-js_shared__"],Ns=Cp.toString,De=on.hasOwnProperty,$p=0,hu=function(){var e=/[^.]+$/.exec($s&&$s.keys&&$s.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ds=on.toString,Np=Ns.call(He),Dp=Pe._,jp=ga("^"+Ns.call(De).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),js=er?q.Buffer:r,gi=q.Symbol,qs=q.Uint8Array,lu=js?js.allocUnsafe:r,Ls=cu(He.getPrototypeOf,He),fu=He.create,pu=on.propertyIsEnumerable,Ms=Cs.splice,du=gi?gi.isConcatSpreadable:r,Rn=gi?gi.iterator:r,Di=gi?gi.toStringTag:r,zs=function(){try{var e=zi(He,"defineProperty");return e({},"",{}),e}catch{}}(),qp=q.clearTimeout!==Pe.clearTimeout&&q.clearTimeout,Lp=W&&W.now!==Pe.Date.now&&W.now,Mp=q.setTimeout!==Pe.setTimeout&&q.setTimeout,Us=Ct.ceil,Hs=Ct.floor,ya=He.getOwnPropertySymbols,zp=js?js.isBuffer:r,gu=q.isFinite,Up=Cs.join,Hp=cu(He.keys,He),$t=Ct.max,Kt=Ct.min,kp=W.now,Kp=q.parseInt,yu=Ct.random,Bp=Cs.reverse,va=zi(q,"DataView"),An=zi(q,"Map"),ma=zi(q,"Promise"),an=zi(q,"Set"),Tn=zi(q,"WeakMap"),Cn=zi(He,"create"),ks=Tn&&new Tn,cn={},Fp=Ui(va),Vp=Ui(An),Gp=Ui(ma),Wp=Ui(an),Jp=Ui(Tn),Ks=gi?gi.prototype:r,$n=Ks?Ks.valueOf:r,vu=Ks?Ks.toString:r;function d(e){if(pt(e)&&!ge(e)&&!(e instanceof xe)){if(e instanceof br)return e;if(De.call(e,"__wrapped__"))return mh(e)}return new br(e)}var un=function(){function e(){}return function(i){if(!it(i))return{};if(fu)return fu(i);e.prototype=i;var s=new e;return e.prototype=r,s}}();function Bs(){}function br(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:ct,evaluate:ut,interpolate:rt,variable:"",imports:{_:d}},d.prototype=Bs.prototype,d.prototype.constructor=d,br.prototype=un(Bs.prototype),br.prototype.constructor=br;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function Qp(){var e=new xe(this.__wrapped__);return e.__actions__=tr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=tr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=tr(this.__views__),e}function Yp(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Zp(){var e=this.__wrapped__.value(),i=this.__dir__,s=ge(e),u=i<0,l=s?e.length:0,y=hg(0,l,this.__views__),w=y.start,E=y.end,R=E-w,L=u?E:w-1,M=this.__iteratees__,U=M.length,F=0,X=Kt(R,this.__takeCount__);if(!s||!u&&l==R&&X==R)return Hu(e,this.__actions__);var ne=[];e:for(;R--&&F<X;){L+=i;for(var we=-1,se=e[L];++we<U;){var be=M[we],Se=be.iteratee,dr=be.type,Zt=Se(se);if(dr==O)se=Zt;else if(!Zt){if(dr==b)continue e;break e}}ne[F++]=se}return ne}xe.prototype=un(Bs.prototype),xe.prototype.constructor=xe;function ji(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Xp(){this.__data__=Cn?Cn(null):{},this.size=0}function ed(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function td(e){var i=this.__data__;if(Cn){var s=i[e];return s===v?r:s}return De.call(i,e)?i[e]:r}function rd(e){var i=this.__data__;return Cn?i[e]!==r:De.call(i,e)}function id(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Cn&&i===r?v:i,this}ji.prototype.clear=Xp,ji.prototype.delete=ed,ji.prototype.get=td,ji.prototype.has=rd,ji.prototype.set=id;function Jr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function nd(){this.__data__=[],this.size=0}function sd(e){var i=this.__data__,s=Fs(i,e);if(s<0)return!1;var u=i.length-1;return s==u?i.pop():Ms.call(i,s,1),--this.size,!0}function od(e){var i=this.__data__,s=Fs(i,e);return s<0?r:i[s][1]}function ad(e){return Fs(this.__data__,e)>-1}function cd(e,i){var s=this.__data__,u=Fs(s,e);return u<0?(++this.size,s.push([e,i])):s[u][1]=i,this}Jr.prototype.clear=nd,Jr.prototype.delete=sd,Jr.prototype.get=od,Jr.prototype.has=ad,Jr.prototype.set=cd;function Qr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function ud(){this.size=0,this.__data__={hash:new ji,map:new(An||Jr),string:new ji}}function hd(e){var i=io(this,e).delete(e);return this.size-=i?1:0,i}function ld(e){return io(this,e).get(e)}function fd(e){return io(this,e).has(e)}function pd(e,i){var s=io(this,e),u=s.size;return s.set(e,i),this.size+=s.size==u?0:1,this}Qr.prototype.clear=ud,Qr.prototype.delete=hd,Qr.prototype.get=ld,Qr.prototype.has=fd,Qr.prototype.set=pd;function qi(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Qr;++i<s;)this.add(e[i])}function dd(e){return this.__data__.set(e,v),this}function gd(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=dd,qi.prototype.has=gd;function $r(e){var i=this.__data__=new Jr(e);this.size=i.size}function yd(){this.__data__=new Jr,this.size=0}function vd(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function md(e){return this.__data__.get(e)}function wd(e){return this.__data__.has(e)}function _d(e,i){var s=this.__data__;if(s instanceof Jr){var u=s.__data__;if(!An||u.length<o-1)return u.push([e,i]),this.size=++s.size,this;s=this.__data__=new Qr(u)}return s.set(e,i),this.size=s.size,this}$r.prototype.clear=yd,$r.prototype.delete=vd,$r.prototype.get=md,$r.prototype.has=wd,$r.prototype.set=_d;function mu(e,i){var s=ge(e),u=!s&&Hi(e),l=!s&&!u&&_i(e),y=!s&&!u&&!l&&pn(e),w=s||u||l||y,E=w?fa(e.length,Tp):[],R=E.length;for(var L in e)(i||De.call(e,L))&&!(w&&(L=="length"||l&&(L=="offset"||L=="parent")||y&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||ei(L,R)))&&E.push(L);return E}function wu(e){var i=e.length;return i?e[Aa(0,i-1)]:r}function bd(e,i){return no(tr(e),Li(i,0,e.length))}function Ed(e){return no(tr(e))}function wa(e,i,s){(s!==r&&!Nr(e[i],s)||s===r&&!(i in e))&&Yr(e,i,s)}function Nn(e,i,s){var u=e[i];(!(De.call(e,i)&&Nr(u,s))||s===r&&!(i in e))&&Yr(e,i,s)}function Fs(e,i){for(var s=e.length;s--;)if(Nr(e[s][0],i))return s;return-1}function Id(e,i,s,u){return yi(e,function(l,y,w){i(u,l,s(l),w)}),u}function _u(e,i){return e&&kr(i,jt(i),e)}function xd(e,i){return e&&kr(i,ir(i),e)}function Yr(e,i,s){i=="__proto__"&&zs?zs(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function _a(e,i){for(var s=-1,u=i.length,l=$(u),y=e==null;++s<u;)l[s]=y?r:ec(e,i[s]);return l}function Li(e,i,s){return e===e&&(s!==r&&(e=e<=s?e:s),i!==r&&(e=e>=i?e:i)),e}function Er(e,i,s,u,l,y){var w,E=i&x,R=i&T,L=i&D;if(s&&(w=l?s(e,u,l,y):s(e)),w!==r)return w;if(!it(e))return e;var M=ge(e);if(M){if(w=fg(e),!E)return tr(e,w)}else{var U=Bt(e),F=U==Z||U==ue;if(_i(e))return Bu(e,E);if(U==Ie||U==Ee||F&&!l){if(w=R||F?{}:uh(e),!E)return R?tg(e,xd(w,e)):eg(e,_u(w,e))}else{if(!qe[U])return l?e:{};w=pg(e,U,E)}}y||(y=new $r);var X=y.get(e);if(X)return X;y.set(e,w),Mh(e)?e.forEach(function(se){w.add(Er(se,i,s,se,e,y))}):qh(e)&&e.forEach(function(se,be){w.set(be,Er(se,i,s,be,e,y))});var ne=L?R?Ua:za:R?ir:jt,we=M?r:ne(e);return wr(we||e,function(se,be){we&&(be=se,se=e[be]),Nn(w,be,Er(se,i,s,be,e,y))}),w}function Pd(e){var i=jt(e);return function(s){return bu(s,e,i)}}function bu(e,i,s){var u=s.length;if(e==null)return!u;for(e=He(e);u--;){var l=s[u],y=i[l],w=e[l];if(w===r&&!(l in e)||!y(w))return!1}return!0}function Eu(e,i,s){if(typeof e!="function")throw new _r(f);return Un(function(){e.apply(r,s)},i)}function Dn(e,i,s,u){var l=-1,y=Rs,w=!0,E=e.length,R=[],L=i.length;if(!E)return R;s&&(i=Ye(i,lr(s))),u?(y=oa,w=!1):i.length>=o&&(y=On,w=!1,i=new qi(i));e:for(;++l<E;){var M=e[l],U=s==null?M:s(M);if(M=u||M!==0?M:0,w&&U===U){for(var F=L;F--;)if(i[F]===U)continue e;R.push(M)}else y(i,U,u)||R.push(M)}return R}var yi=Ju(Hr),Iu=Ju(Ea,!0);function Sd(e,i){var s=!0;return yi(e,function(u,l,y){return s=!!i(u,l,y),s}),s}function Vs(e,i,s){for(var u=-1,l=e.length;++u<l;){var y=e[u],w=i(y);if(w!=null&&(E===r?w===w&&!pr(w):s(w,E)))var E=w,R=y}return R}function Od(e,i,s,u){var l=e.length;for(s=ye(s),s<0&&(s=-s>l?0:l+s),u=u===r||u>l?l:ye(u),u<0&&(u+=l),u=s>u?0:Uh(u);s<u;)e[s++]=i;return e}function xu(e,i){var s=[];return yi(e,function(u,l,y){i(u,l,y)&&s.push(u)}),s}function Ht(e,i,s,u,l){var y=-1,w=e.length;for(s||(s=gg),l||(l=[]);++y<w;){var E=e[y];i>0&&s(E)?i>1?Ht(E,i-1,s,u,l):pi(l,E):u||(l[l.length]=E)}return l}var ba=Qu(),Pu=Qu(!0);function Hr(e,i){return e&&ba(e,i,jt)}function Ea(e,i){return e&&Pu(e,i,jt)}function Gs(e,i){return fi(i,function(s){return ti(e[s])})}function Mi(e,i){i=mi(i,e);for(var s=0,u=i.length;e!=null&&s<u;)e=e[Kr(i[s++])];return s&&s==u?e:r}function Su(e,i,s){var u=i(e);return ge(e)?u:pi(u,s(e))}function Qt(e){return e==null?e===r?tt:Ae:Di&&Di in He(e)?ug(e):Eg(e)}function Ia(e,i){return e>i}function Rd(e,i){return e!=null&&De.call(e,i)}function Ad(e,i){return e!=null&&i in He(e)}function Td(e,i,s){return e>=Kt(i,s)&&e<$t(i,s)}function xa(e,i,s){for(var u=s?oa:Rs,l=e[0].length,y=e.length,w=y,E=$(y),R=1/0,L=[];w--;){var M=e[w];w&&i&&(M=Ye(M,lr(i))),R=Kt(M.length,R),E[w]=!s&&(i||l>=120&&M.length>=120)?new qi(w&&M):r}M=e[0];var U=-1,F=E[0];e:for(;++U<l&&L.length<R;){var X=M[U],ne=i?i(X):X;if(X=s||X!==0?X:0,!(F?On(F,ne):u(L,ne,s))){for(w=y;--w;){var we=E[w];if(!(we?On(we,ne):u(e[w],ne,s)))continue e}F&&F.push(ne),L.push(X)}}return L}function Cd(e,i,s,u){return Hr(e,function(l,y,w){i(u,s(l),y,w)}),u}function jn(e,i,s){i=mi(i,e),e=ph(e,i);var u=e==null?e:e[Kr(xr(i))];return u==null?r:Dt(u,e,s)}function Ou(e){return pt(e)&&Qt(e)==Ee}function $d(e){return pt(e)&&Qt(e)==Re}function Nd(e){return pt(e)&&Qt(e)==C}function qn(e,i,s,u,l){return e===i?!0:e==null||i==null||!pt(e)&&!pt(i)?e!==e&&i!==i:Dd(e,i,s,u,qn,l)}function Dd(e,i,s,u,l,y){var w=ge(e),E=ge(i),R=w?Rr:Bt(e),L=E?Rr:Bt(i);R=R==Ee?Ie:R,L=L==Ee?Ie:L;var M=R==Ie,U=L==Ie,F=R==L;if(F&&_i(e)){if(!_i(i))return!1;w=!0,M=!1}if(F&&!M)return y||(y=new $r),w||pn(e)?oh(e,i,s,u,l,y):ag(e,i,R,s,u,l,y);if(!(s&A)){var X=M&&De.call(e,"__wrapped__"),ne=U&&De.call(i,"__wrapped__");if(X||ne){var we=X?e.value():e,se=ne?i.value():i;return y||(y=new $r),l(we,se,s,u,y)}}return F?(y||(y=new $r),cg(e,i,s,u,l,y)):!1}function jd(e){return pt(e)&&Bt(e)==me}function Pa(e,i,s,u){var l=s.length,y=l,w=!u;if(e==null)return!y;for(e=He(e);l--;){var E=s[l];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++l<y;){E=s[l];var R=E[0],L=e[R],M=E[1];if(w&&E[2]){if(L===r&&!(R in e))return!1}else{var U=new $r;if(u)var F=u(L,M,R,e,i,U);if(!(F===r?qn(M,L,A|J,u,U):F))return!1}}return!0}function Ru(e){if(!it(e)||vg(e))return!1;var i=ti(e)?jp:Bo;return i.test(Ui(e))}function qd(e){return pt(e)&&Qt(e)==et}function Ld(e){return pt(e)&&Bt(e)==Ce}function Md(e){return pt(e)&&ho(e.length)&&!!Me[Qt(e)]}function Au(e){return typeof e=="function"?e:e==null?nr:typeof e=="object"?ge(e)?$u(e[0],e[1]):Cu(e):Yh(e)}function Sa(e){if(!zn(e))return Hp(e);var i=[];for(var s in He(e))De.call(e,s)&&s!="constructor"&&i.push(s);return i}function zd(e){if(!it(e))return bg(e);var i=zn(e),s=[];for(var u in e)u=="constructor"&&(i||!De.call(e,u))||s.push(u);return s}function Oa(e,i){return e<i}function Tu(e,i){var s=-1,u=rr(e)?$(e.length):[];return yi(e,function(l,y,w){u[++s]=i(l,y,w)}),u}function Cu(e){var i=ka(e);return i.length==1&&i[0][2]?lh(i[0][0],i[0][1]):function(s){return s===e||Pa(s,e,i)}}function $u(e,i){return Ba(e)&&hh(i)?lh(Kr(e),i):function(s){var u=ec(s,e);return u===r&&u===i?tc(s,e):qn(i,u,A|J)}}function Ws(e,i,s,u,l){e!==i&&ba(i,function(y,w){if(l||(l=new $r),it(y))Ud(e,i,w,s,Ws,u,l);else{var E=u?u(Va(e,w),y,w+"",e,i,l):r;E===r&&(E=y),wa(e,w,E)}},ir)}function Ud(e,i,s,u,l,y,w){var E=Va(e,s),R=Va(i,s),L=w.get(R);if(L){wa(e,s,L);return}var M=y?y(E,R,s+"",e,i,w):r,U=M===r;if(U){var F=ge(R),X=!F&&_i(R),ne=!F&&!X&&pn(R);M=R,F||X||ne?ge(E)?M=E:vt(E)?M=tr(E):X?(U=!1,M=Bu(R,!0)):ne?(U=!1,M=Fu(R,!0)):M=[]:Hn(R)||Hi(R)?(M=E,Hi(E)?M=Hh(E):(!it(E)||ti(E))&&(M=uh(R))):U=!1}U&&(w.set(R,M),l(M,R,u,y,w),w.delete(R)),wa(e,s,M)}function Nu(e,i){var s=e.length;if(s)return i+=i<0?s:0,ei(i,s)?e[i]:r}function Du(e,i,s){i.length?i=Ye(i,function(y){return ge(y)?function(w){return Mi(w,y.length===1?y[0]:y)}:y}):i=[nr];var u=-1;i=Ye(i,lr(ie()));var l=Tu(e,function(y,w,E){var R=Ye(i,function(L){return L(y)});return{criteria:R,index:++u,value:y}});return pp(l,function(y,w){return Xd(y,w,s)})}function Hd(e,i){return ju(e,i,function(s,u){return tc(e,u)})}function ju(e,i,s){for(var u=-1,l=i.length,y={};++u<l;){var w=i[u],E=Mi(e,w);s(E,w)&&Ln(y,mi(w,e),E)}return y}function kd(e){return function(i){return Mi(i,e)}}function Ra(e,i,s,u){var l=u?fp:tn,y=-1,w=i.length,E=e;for(e===i&&(i=tr(i)),s&&(E=Ye(e,lr(s)));++y<w;)for(var R=0,L=i[y],M=s?s(L):L;(R=l(E,M,R,u))>-1;)E!==e&&Ms.call(E,R,1),Ms.call(e,R,1);return e}function qu(e,i){for(var s=e?i.length:0,u=s-1;s--;){var l=i[s];if(s==u||l!==y){var y=l;ei(l)?Ms.call(e,l,1):$a(e,l)}}return e}function Aa(e,i){return e+Hs(yu()*(i-e+1))}function Kd(e,i,s,u){for(var l=-1,y=$t(Us((i-e)/(s||1)),0),w=$(y);y--;)w[u?y:++l]=e,e+=s;return w}function Ta(e,i){var s="";if(!e||i<1||i>k)return s;do i%2&&(s+=e),i=Hs(i/2),i&&(e+=e);while(i);return s}function _e(e,i){return Ga(fh(e,i,nr),e+"")}function Bd(e){return wu(dn(e))}function Fd(e,i){var s=dn(e);return no(s,Li(i,0,s.length))}function Ln(e,i,s,u){if(!it(e))return e;i=mi(i,e);for(var l=-1,y=i.length,w=y-1,E=e;E!=null&&++l<y;){var R=Kr(i[l]),L=s;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var M=E[R];L=u?u(M,R,E):r,L===r&&(L=it(M)?M:ei(i[l+1])?[]:{})}Nn(E,R,L),E=E[R]}return e}var Lu=ks?function(e,i){return ks.set(e,i),e}:nr,Vd=zs?function(e,i){return zs(e,"toString",{configurable:!0,enumerable:!1,value:ic(i),writable:!0})}:nr;function Gd(e){return no(dn(e))}function Ir(e,i,s){var u=-1,l=e.length;i<0&&(i=-i>l?0:l+i),s=s>l?l:s,s<0&&(s+=l),l=i>s?0:s-i>>>0,i>>>=0;for(var y=$(l);++u<l;)y[u]=e[u+i];return y}function Wd(e,i){var s;return yi(e,function(u,l,y){return s=i(u,l,y),!s}),!!s}function Js(e,i,s){var u=0,l=e==null?u:e.length;if(typeof i=="number"&&i===i&&l<=st){for(;u<l;){var y=u+l>>>1,w=e[y];w!==null&&!pr(w)&&(s?w<=i:w<i)?u=y+1:l=y}return l}return Ca(e,i,nr,s)}function Ca(e,i,s,u){var l=0,y=e==null?0:e.length;if(y===0)return 0;i=s(i);for(var w=i!==i,E=i===null,R=pr(i),L=i===r;l<y;){var M=Hs((l+y)/2),U=s(e[M]),F=U!==r,X=U===null,ne=U===U,we=pr(U);if(w)var se=u||ne;else L?se=ne&&(u||F):E?se=ne&&F&&(u||!X):R?se=ne&&F&&!X&&(u||!we):X||we?se=!1:se=u?U<=i:U<i;se?l=M+1:y=M}return Kt(y,Xe)}function Mu(e,i){for(var s=-1,u=e.length,l=0,y=[];++s<u;){var w=e[s],E=i?i(w):w;if(!s||!Nr(E,R)){var R=E;y[l++]=w===0?0:w}}return y}function zu(e){return typeof e=="number"?e:pr(e)?K:+e}function fr(e){if(typeof e=="string")return e;if(ge(e))return Ye(e,fr)+"";if(pr(e))return vu?vu.call(e):"";var i=e+"";return i=="0"&&1/e==-le?"-0":i}function vi(e,i,s){var u=-1,l=Rs,y=e.length,w=!0,E=[],R=E;if(s)w=!1,l=oa;else if(y>=o){var L=i?null:sg(e);if(L)return Ts(L);w=!1,l=On,R=new qi}else R=i?[]:E;e:for(;++u<y;){var M=e[u],U=i?i(M):M;if(M=s||M!==0?M:0,w&&U===U){for(var F=R.length;F--;)if(R[F]===U)continue e;i&&R.push(U),E.push(M)}else l(R,U,s)||(R!==E&&R.push(U),E.push(M))}return E}function $a(e,i){return i=mi(i,e),e=ph(e,i),e==null||delete e[Kr(xr(i))]}function Uu(e,i,s,u){return Ln(e,i,s(Mi(e,i)),u)}function Qs(e,i,s,u){for(var l=e.length,y=u?l:-1;(u?y--:++y<l)&&i(e[y],y,e););return s?Ir(e,u?0:y,u?y+1:l):Ir(e,u?y+1:0,u?l:y)}function Hu(e,i){var s=e;return s instanceof xe&&(s=s.value()),aa(i,function(u,l){return l.func.apply(l.thisArg,pi([u],l.args))},s)}function Na(e,i,s){var u=e.length;if(u<2)return u?vi(e[0]):[];for(var l=-1,y=$(u);++l<u;)for(var w=e[l],E=-1;++E<u;)E!=l&&(y[l]=Dn(y[l]||w,e[E],i,s));return vi(Ht(y,1),i,s)}function ku(e,i,s){for(var u=-1,l=e.length,y=i.length,w={};++u<l;){var E=u<y?i[u]:r;s(w,e[u],E)}return w}function Da(e){return vt(e)?e:[]}function ja(e){return typeof e=="function"?e:nr}function mi(e,i){return ge(e)?e:Ba(e,i)?[e]:vh($e(e))}var Jd=_e;function wi(e,i,s){var u=e.length;return s=s===r?u:s,!i&&s>=u?e:Ir(e,i,s)}var Ku=qp||function(e){return Pe.clearTimeout(e)};function Bu(e,i){if(i)return e.slice();var s=e.length,u=lu?lu(s):new e.constructor(s);return e.copy(u),u}function qa(e){var i=new e.constructor(e.byteLength);return new qs(i).set(new qs(e)),i}function Qd(e,i){var s=i?qa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Yd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function Zd(e){return $n?He($n.call(e)):{}}function Fu(e,i){var s=i?qa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Vu(e,i){if(e!==i){var s=e!==r,u=e===null,l=e===e,y=pr(e),w=i!==r,E=i===null,R=i===i,L=pr(i);if(!E&&!L&&!y&&e>i||y&&w&&R&&!E&&!L||u&&w&&R||!s&&R||!l)return 1;if(!u&&!y&&!L&&e<i||L&&s&&l&&!u&&!y||E&&s&&l||!w&&l||!R)return-1}return 0}function Xd(e,i,s){for(var u=-1,l=e.criteria,y=i.criteria,w=l.length,E=s.length;++u<w;){var R=Vu(l[u],y[u]);if(R){if(u>=E)return R;var L=s[u];return R*(L=="desc"?-1:1)}}return e.index-i.index}function Gu(e,i,s,u){for(var l=-1,y=e.length,w=s.length,E=-1,R=i.length,L=$t(y-w,0),M=$(R+L),U=!u;++E<R;)M[E]=i[E];for(;++l<w;)(U||l<y)&&(M[s[l]]=e[l]);for(;L--;)M[E++]=e[l++];return M}function Wu(e,i,s,u){for(var l=-1,y=e.length,w=-1,E=s.length,R=-1,L=i.length,M=$t(y-E,0),U=$(M+L),F=!u;++l<M;)U[l]=e[l];for(var X=l;++R<L;)U[X+R]=i[R];for(;++w<E;)(F||l<y)&&(U[X+s[w]]=e[l++]);return U}function tr(e,i){var s=-1,u=e.length;for(i||(i=$(u));++s<u;)i[s]=e[s];return i}function kr(e,i,s,u){var l=!s;s||(s={});for(var y=-1,w=i.length;++y<w;){var E=i[y],R=u?u(s[E],e[E],E,s,e):r;R===r&&(R=e[E]),l?Yr(s,E,R):Nn(s,E,R)}return s}function eg(e,i){return kr(e,Ka(e),i)}function tg(e,i){return kr(e,ah(e),i)}function Ys(e,i){return function(s,u){var l=ge(s)?op:Id,y=i?i():{};return l(s,e,ie(u,2),y)}}function hn(e){return _e(function(i,s){var u=-1,l=s.length,y=l>1?s[l-1]:r,w=l>2?s[2]:r;for(y=e.length>3&&typeof y=="function"?(l--,y):r,w&&Yt(s[0],s[1],w)&&(y=l<3?r:y,l=1),i=He(i);++u<l;){var E=s[u];E&&e(i,E,u,y)}return i})}function Ju(e,i){return function(s,u){if(s==null)return s;if(!rr(s))return e(s,u);for(var l=s.length,y=i?l:-1,w=He(s);(i?y--:++y<l)&&u(w[y],y,w)!==!1;);return s}}function Qu(e){return function(i,s,u){for(var l=-1,y=He(i),w=u(i),E=w.length;E--;){var R=w[e?E:++l];if(s(y[R],R,y)===!1)break}return i}}function rg(e,i,s){var u=i&ee,l=Mn(e);function y(){var w=this&&this!==Pe&&this instanceof y?l:e;return w.apply(u?s:this,arguments)}return y}function Yu(e){return function(i){i=$e(i);var s=rn(i)?Cr(i):r,u=s?s[0]:i.charAt(0),l=s?wi(s,1).join(""):i.slice(1);return u[e]()+l}}function ln(e){return function(i){return aa(Jh(Wh(i).replace(Pn,"")),e,"")}}function Mn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=un(e.prototype),u=e.apply(s,i);return it(u)?u:s}}function ig(e,i,s){var u=Mn(e);function l(){for(var y=arguments.length,w=$(y),E=y,R=fn(l);E--;)w[E]=arguments[E];var L=y<3&&w[0]!==R&&w[y-1]!==R?[]:di(w,R);if(y-=L.length,y<s)return rh(e,i,Zs,l.placeholder,r,w,L,r,r,s-y);var M=this&&this!==Pe&&this instanceof l?u:e;return Dt(M,this,w)}return l}function Zu(e){return function(i,s,u){var l=He(i);if(!rr(i)){var y=ie(s,3);i=jt(i),s=function(E){return y(l[E],E,l)}}var w=e(i,s,u);return w>-1?l[y?i[w]:w]:r}}function Xu(e){return Xr(function(i){var s=i.length,u=s,l=br.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new _r(f);if(l&&!w&&ro(y)=="wrapper")var w=new br([],!0)}for(u=w?u:s;++u<s;){y=i[u];var E=ro(y),R=E=="wrapper"?Ha(y):r;R&&Fa(R[0])&&R[1]==(Y|oe|he|ve)&&!R[4].length&&R[9]==1?w=w[ro(R[0])].apply(w,R[3]):w=y.length==1&&Fa(y)?w[E]():w.thru(y)}return function(){var L=arguments,M=L[0];if(w&&L.length==1&&ge(M))return w.plant(M).value();for(var U=0,F=s?i[U].apply(this,L):M;++U<s;)F=i[U].call(this,F);return F}})}function Zs(e,i,s,u,l,y,w,E,R,L){var M=i&Y,U=i&ee,F=i&ce,X=i&(oe|te),ne=i&wt,we=F?r:Mn(e);function se(){for(var be=arguments.length,Se=$(be),dr=be;dr--;)Se[dr]=arguments[dr];if(X)var Zt=fn(se),gr=gp(Se,Zt);if(u&&(Se=Gu(Se,u,l,X)),y&&(Se=Wu(Se,y,w,X)),be-=gr,X&&be<L){var mt=di(Se,Zt);return rh(e,i,Zs,se.placeholder,s,Se,mt,E,R,L-be)}var Dr=U?s:this,ii=F?Dr[e]:e;return be=Se.length,E?Se=Ig(Se,E):ne&&be>1&&Se.reverse(),M&&R<be&&(Se.length=R),this&&this!==Pe&&this instanceof se&&(ii=we||Mn(ii)),ii.apply(Dr,Se)}return se}function eh(e,i){return function(s,u){return Cd(s,e,i(u),{})}}function Xs(e,i){return function(s,u){var l;if(s===r&&u===r)return i;if(s!==r&&(l=s),u!==r){if(l===r)return u;typeof s=="string"||typeof u=="string"?(s=fr(s),u=fr(u)):(s=zu(s),u=zu(u)),l=e(s,u)}return l}}function La(e){return Xr(function(i){return i=Ye(i,lr(ie())),_e(function(s){var u=this;return e(i,function(l){return Dt(l,u,s)})})})}function eo(e,i){i=i===r?" ":fr(i);var s=i.length;if(s<2)return s?Ta(i,e):i;var u=Ta(i,Us(e/nn(i)));return rn(i)?wi(Cr(u),0,e).join(""):u.slice(0,e)}function ng(e,i,s,u){var l=i&ee,y=Mn(e);function w(){for(var E=-1,R=arguments.length,L=-1,M=u.length,U=$(M+R),F=this&&this!==Pe&&this instanceof w?y:e;++L<M;)U[L]=u[L];for(;R--;)U[L++]=arguments[++E];return Dt(F,l?s:this,U)}return w}function th(e){return function(i,s,u){return u&&typeof u!="number"&&Yt(i,s,u)&&(s=u=r),i=ri(i),s===r?(s=i,i=0):s=ri(s),u=u===r?i<s?1:-1:ri(u),Kd(i,s,u,e)}}function to(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=Pr(i),s=Pr(s)),e(i,s)}}function rh(e,i,s,u,l,y,w,E,R,L){var M=i&oe,U=M?w:r,F=M?r:w,X=M?y:r,ne=M?r:y;i|=M?he:pe,i&=~(M?pe:he),i&ae||(i&=~(ee|ce));var we=[e,i,l,X,U,ne,F,E,R,L],se=s.apply(r,we);return Fa(e)&&dh(se,we),se.placeholder=u,gh(se,e,i)}function Ma(e){var i=Ct[e];return function(s,u){if(s=Pr(s),u=u==null?0:Kt(ye(u),292),u&&gu(s)){var l=($e(s)+"e").split("e"),y=i(l[0]+"e"+(+l[1]+u));return l=($e(y)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return i(s)}}var sg=an&&1/Ts(new an([,-0]))[1]==le?function(e){return new an(e)}:oc;function ih(e){return function(i){var s=Bt(i);return s==me?da(i):s==Ce?Ep(i):dp(i,e(i))}}function Zr(e,i,s,u,l,y,w,E){var R=i&ce;if(!R&&typeof e!="function")throw new _r(f);var L=u?u.length:0;if(L||(i&=~(he|pe),u=l=r),w=w===r?w:$t(ye(w),0),E=E===r?E:ye(E),L-=l?l.length:0,i&pe){var M=u,U=l;u=l=r}var F=R?r:Ha(e),X=[e,i,s,u,l,M,U,y,w,E];if(F&&_g(X,F),e=X[0],i=X[1],s=X[2],u=X[3],l=X[4],E=X[9]=X[9]===r?R?0:e.length:$t(X[9]-L,0),!E&&i&(oe|te)&&(i&=~(oe|te)),!i||i==ee)var ne=rg(e,i,s);else i==oe||i==te?ne=ig(e,i,E):(i==he||i==(ee|he))&&!l.length?ne=ng(e,i,s,u):ne=Zs.apply(r,X);var we=F?Lu:dh;return gh(we(ne,X),e,i)}function nh(e,i,s,u){return e===r||Nr(e,on[s])&&!De.call(u,s)?i:e}function sh(e,i,s,u,l,y){return it(e)&&it(i)&&(y.set(i,e),Ws(e,i,r,sh,y),y.delete(i)),e}function og(e){return Hn(e)?r:e}function oh(e,i,s,u,l,y){var w=s&A,E=e.length,R=i.length;if(E!=R&&!(w&&R>E))return!1;var L=y.get(e),M=y.get(i);if(L&&M)return L==i&&M==e;var U=-1,F=!0,X=s&J?new qi:r;for(y.set(e,i),y.set(i,e);++U<E;){var ne=e[U],we=i[U];if(u)var se=w?u(we,ne,U,i,e,y):u(ne,we,U,e,i,y);if(se!==r){if(se)continue;F=!1;break}if(X){if(!ca(i,function(be,Se){if(!On(X,Se)&&(ne===be||l(ne,be,s,u,y)))return X.push(Se)})){F=!1;break}}else if(!(ne===we||l(ne,we,s,u,y))){F=!1;break}}return y.delete(e),y.delete(i),F}function ag(e,i,s,u,l,y,w){switch(s){case Le:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Re:return!(e.byteLength!=i.byteLength||!y(new qs(e),new qs(i)));case N:case C:case Oe:return Nr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case et:case Be:return e==i+"";case me:var E=da;case Ce:var R=u&A;if(E||(E=Ts),e.size!=i.size&&!R)return!1;var L=w.get(e);if(L)return L==i;u|=J,w.set(e,i);var M=oh(E(e),E(i),u,l,y,w);return w.delete(e),M;case Fe:if($n)return $n.call(e)==$n.call(i)}return!1}function cg(e,i,s,u,l,y){var w=s&A,E=za(e),R=E.length,L=za(i),M=L.length;if(R!=M&&!w)return!1;for(var U=R;U--;){var F=E[U];if(!(w?F in i:De.call(i,F)))return!1}var X=y.get(e),ne=y.get(i);if(X&&ne)return X==i&&ne==e;var we=!0;y.set(e,i),y.set(i,e);for(var se=w;++U<R;){F=E[U];var be=e[F],Se=i[F];if(u)var dr=w?u(Se,be,F,i,e,y):u(be,Se,F,e,i,y);if(!(dr===r?be===Se||l(be,Se,s,u,y):dr)){we=!1;break}se||(se=F=="constructor")}if(we&&!se){var Zt=e.constructor,gr=i.constructor;Zt!=gr&&"constructor"in e&&"constructor"in i&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof gr=="function"&&gr instanceof gr)&&(we=!1)}return y.delete(e),y.delete(i),we}function Xr(e){return Ga(fh(e,r,bh),e+"")}function za(e){return Su(e,jt,Ka)}function Ua(e){return Su(e,ir,ah)}var Ha=ks?function(e){return ks.get(e)}:oc;function ro(e){for(var i=e.name+"",s=cn[i],u=De.call(cn,i)?s.length:0;u--;){var l=s[u],y=l.func;if(y==null||y==e)return l.name}return i}function fn(e){var i=De.call(d,"placeholder")?d:e;return i.placeholder}function ie(){var e=d.iteratee||nc;return e=e===nc?Au:e,arguments.length?e(arguments[0],arguments[1]):e}function io(e,i){var s=e.__data__;return yg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function ka(e){for(var i=jt(e),s=i.length;s--;){var u=i[s],l=e[u];i[s]=[u,l,hh(l)]}return i}function zi(e,i){var s=wp(e,i);return Ru(s)?s:r}function ug(e){var i=De.call(e,Di),s=e[Di];try{e[Di]=r;var u=!0}catch{}var l=Ds.call(e);return u&&(i?e[Di]=s:delete e[Di]),l}var Ka=ya?function(e){return e==null?[]:(e=He(e),fi(ya(e),function(i){return pu.call(e,i)}))}:ac,ah=ya?function(e){for(var i=[];e;)pi(i,Ka(e)),e=Ls(e);return i}:ac,Bt=Qt;(va&&Bt(new va(new ArrayBuffer(1)))!=Le||An&&Bt(new An)!=me||ma&&Bt(ma.resolve())!=_t||an&&Bt(new an)!=Ce||Tn&&Bt(new Tn)!=je)&&(Bt=function(e){var i=Qt(e),s=i==Ie?e.constructor:r,u=s?Ui(s):"";if(u)switch(u){case Fp:return Le;case Vp:return me;case Gp:return _t;case Wp:return Ce;case Jp:return je}return i});function hg(e,i,s){for(var u=-1,l=s.length;++u<l;){var y=s[u],w=y.size;switch(y.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Kt(i,e+w);break;case"takeRight":e=$t(e,i-w);break}}return{start:e,end:i}}function lg(e){var i=e.match(ke);return i?i[1].split(Pt):[]}function ch(e,i,s){i=mi(i,e);for(var u=-1,l=i.length,y=!1;++u<l;){var w=Kr(i[u]);if(!(y=e!=null&&s(e,w)))break;e=e[w]}return y||++u!=l?y:(l=e==null?0:e.length,!!l&&ho(l)&&ei(w,l)&&(ge(e)||Hi(e)))}function fg(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&De.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function uh(e){return typeof e.constructor=="function"&&!zn(e)?un(Ls(e)):{}}function pg(e,i,s){var u=e.constructor;switch(i){case Re:return qa(e);case N:case C:return new u(+e);case Le:return Qd(e,s);case ot:case Ne:case bt:case Tt:case zt:case Ut:case Nt:case Gt:case Xt:return Fu(e,s);case me:return new u;case Oe:case Be:return new u(e);case et:return Yd(e);case Ce:return new u;case Fe:return Zd(e)}}function dg(e,i){var s=i.length;if(!s)return e;var u=s-1;return i[u]=(s>1?"& ":"")+i[u],i=i.join(s>2?", ":" "),e.replace(ft,`{
/* [wrapped with `+i+`] */
`)}function gg(e){return ge(e)||Hi(e)||!!(du&&e&&e[du])}function ei(e,i){var s=typeof e;return i=i??k,!!i&&(s=="number"||s!="symbol"&&Vo.test(e))&&e>-1&&e%1==0&&e<i}function Yt(e,i,s){if(!it(s))return!1;var u=typeof i;return(u=="number"?rr(s)&&ei(i,s.length):u=="string"&&i in s)?Nr(s[i],e):!1}function Ba(e,i){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:Et.test(e)||!Qe.test(e)||i!=null&&e in He(i)}function yg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Fa(e){var i=ro(e),s=d[i];if(typeof s!="function"||!(i in xe.prototype))return!1;if(e===s)return!0;var u=Ha(s);return!!u&&e===u[0]}function vg(e){return!!hu&&hu in e}var mg=$s?ti:cc;function zn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||on;return e===s}function hh(e){return e===e&&!it(e)}function lh(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==r||e in He(s))}}function wg(e){var i=co(e,function(u){return s.size===p&&s.clear(),u}),s=i.cache;return i}function _g(e,i){var s=e[1],u=i[1],l=s|u,y=l<(ee|ce|Y),w=u==Y&&s==oe||u==Y&&s==ve&&e[7].length<=i[8]||u==(Y|ve)&&i[7].length<=i[8]&&s==oe;if(!(y||w))return e;u&ee&&(e[2]=i[2],l|=s&ee?0:ae);var E=i[3];if(E){var R=e[3];e[3]=R?Gu(R,E,i[4]):E,e[4]=R?di(e[3],_):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?Wu(R,E,i[6]):E,e[6]=R?di(e[5],_):i[6]),E=i[7],E&&(e[7]=E),u&Y&&(e[8]=e[8]==null?i[8]:Kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function bg(e){var i=[];if(e!=null)for(var s in He(e))i.push(s);return i}function Eg(e){return Ds.call(e)}function fh(e,i,s){return i=$t(i===r?e.length-1:i,0),function(){for(var u=arguments,l=-1,y=$t(u.length-i,0),w=$(y);++l<y;)w[l]=u[i+l];l=-1;for(var E=$(i+1);++l<i;)E[l]=u[l];return E[i]=s(w),Dt(e,this,E)}}function ph(e,i){return i.length<2?e:Mi(e,Ir(i,0,-1))}function Ig(e,i){for(var s=e.length,u=Kt(i.length,s),l=tr(e);u--;){var y=i[u];e[u]=ei(y,s)?l[y]:r}return e}function Va(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var dh=yh(Lu),Un=Mp||function(e,i){return Pe.setTimeout(e,i)},Ga=yh(Vd);function gh(e,i,s){var u=i+"";return Ga(e,dg(u,xg(lg(u),s)))}function yh(e){var i=0,s=0;return function(){var u=kp(),l=Mt-(u-s);if(s=u,l>0){if(++i>=Lt)return arguments[0]}else i=0;return e.apply(r,arguments)}}function no(e,i){var s=-1,u=e.length,l=u-1;for(i=i===r?u:i;++s<i;){var y=Aa(s,l),w=e[y];e[y]=e[s],e[s]=w}return e.length=i,e}var vh=wg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(It,function(s,u,l,y){i.push(l?y.replace(Uo,"$1"):u||s)}),i});function Kr(e){if(typeof e=="string"||pr(e))return e;var i=e+"";return i=="0"&&1/e==-le?"-0":i}function Ui(e){if(e!=null){try{return Ns.call(e)}catch{}try{return e+""}catch{}}return""}function xg(e,i){return wr(Oi,function(s){var u="_."+s[0];i&s[1]&&!Rs(e,u)&&e.push(u)}),e.sort()}function mh(e){if(e instanceof xe)return e.clone();var i=new br(e.__wrapped__,e.__chain__);return i.__actions__=tr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Pg(e,i,s){(s?Yt(e,i,s):i===r)?i=1:i=$t(ye(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var l=0,y=0,w=$(Us(u/i));l<u;)w[y++]=Ir(e,l,l+=i);return w}function Sg(e){for(var i=-1,s=e==null?0:e.length,u=0,l=[];++i<s;){var y=e[i];y&&(l[u++]=y)}return l}function Og(){var e=arguments.length;if(!e)return[];for(var i=$(e-1),s=arguments[0],u=e;u--;)i[u-1]=arguments[u];return pi(ge(s)?tr(s):[s],Ht(i,1))}var Rg=_e(function(e,i){return vt(e)?Dn(e,Ht(i,1,vt,!0)):[]}),Ag=_e(function(e,i){var s=xr(i);return vt(s)&&(s=r),vt(e)?Dn(e,Ht(i,1,vt,!0),ie(s,2)):[]}),Tg=_e(function(e,i){var s=xr(i);return vt(s)&&(s=r),vt(e)?Dn(e,Ht(i,1,vt,!0),r,s):[]});function Cg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),Ir(e,i<0?0:i,u)):[]}function $g(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),i=u-i,Ir(e,0,i<0?0:i)):[]}function Ng(e,i){return e&&e.length?Qs(e,ie(i,3),!0,!0):[]}function Dg(e,i){return e&&e.length?Qs(e,ie(i,3),!0):[]}function jg(e,i,s,u){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Yt(e,i,s)&&(s=0,u=l),Od(e,i,s,u)):[]}function wh(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(u+l,0)),As(e,ie(i,3),l)}function _h(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u-1;return s!==r&&(l=ye(s),l=s<0?$t(u+l,0):Kt(l,u-1)),As(e,ie(i,3),l,!0)}function bh(e){var i=e==null?0:e.length;return i?Ht(e,1):[]}function qg(e){var i=e==null?0:e.length;return i?Ht(e,le):[]}function Lg(e,i){var s=e==null?0:e.length;return s?(i=i===r?1:ye(i),Ht(e,i)):[]}function Mg(e){for(var i=-1,s=e==null?0:e.length,u={};++i<s;){var l=e[i];u[l[0]]=l[1]}return u}function Eh(e){return e&&e.length?e[0]:r}function zg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(u+l,0)),tn(e,i,l)}function Ug(e){var i=e==null?0:e.length;return i?Ir(e,0,-1):[]}var Hg=_e(function(e){var i=Ye(e,Da);return i.length&&i[0]===e[0]?xa(i):[]}),kg=_e(function(e){var i=xr(e),s=Ye(e,Da);return i===xr(s)?i=r:s.pop(),s.length&&s[0]===e[0]?xa(s,ie(i,2)):[]}),Kg=_e(function(e){var i=xr(e),s=Ye(e,Da);return i=typeof i=="function"?i:r,i&&s.pop(),s.length&&s[0]===e[0]?xa(s,r,i):[]});function Bg(e,i){return e==null?"":Up.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Fg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u;return s!==r&&(l=ye(s),l=l<0?$t(u+l,0):Kt(l,u-1)),i===i?xp(e,i,l):As(e,ru,l,!0)}function Vg(e,i){return e&&e.length?Nu(e,ye(i)):r}var Gg=_e(Ih);function Ih(e,i){return e&&e.length&&i&&i.length?Ra(e,i):e}function Wg(e,i,s){return e&&e.length&&i&&i.length?Ra(e,i,ie(s,2)):e}function Jg(e,i,s){return e&&e.length&&i&&i.length?Ra(e,i,r,s):e}var Qg=Xr(function(e,i){var s=e==null?0:e.length,u=_a(e,i);return qu(e,Ye(i,function(l){return ei(l,s)?+l:l}).sort(Vu)),u});function Yg(e,i){var s=[];if(!(e&&e.length))return s;var u=-1,l=[],y=e.length;for(i=ie(i,3);++u<y;){var w=e[u];i(w,u,e)&&(s.push(w),l.push(u))}return qu(e,l),s}function Wa(e){return e==null?e:Bp.call(e)}function Zg(e,i,s){var u=e==null?0:e.length;return u?(s&&typeof s!="number"&&Yt(e,i,s)?(i=0,s=u):(i=i==null?0:ye(i),s=s===r?u:ye(s)),Ir(e,i,s)):[]}function Xg(e,i){return Js(e,i)}function ey(e,i,s){return Ca(e,i,ie(s,2))}function ty(e,i){var s=e==null?0:e.length;if(s){var u=Js(e,i);if(u<s&&Nr(e[u],i))return u}return-1}function ry(e,i){return Js(e,i,!0)}function iy(e,i,s){return Ca(e,i,ie(s,2),!0)}function ny(e,i){var s=e==null?0:e.length;if(s){var u=Js(e,i,!0)-1;if(Nr(e[u],i))return u}return-1}function sy(e){return e&&e.length?Mu(e):[]}function oy(e,i){return e&&e.length?Mu(e,ie(i,2)):[]}function ay(e){var i=e==null?0:e.length;return i?Ir(e,1,i):[]}function cy(e,i,s){return e&&e.length?(i=s||i===r?1:ye(i),Ir(e,0,i<0?0:i)):[]}function uy(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),i=u-i,Ir(e,i<0?0:i,u)):[]}function hy(e,i){return e&&e.length?Qs(e,ie(i,3),!1,!0):[]}function ly(e,i){return e&&e.length?Qs(e,ie(i,3)):[]}var fy=_e(function(e){return vi(Ht(e,1,vt,!0))}),py=_e(function(e){var i=xr(e);return vt(i)&&(i=r),vi(Ht(e,1,vt,!0),ie(i,2))}),dy=_e(function(e){var i=xr(e);return i=typeof i=="function"?i:r,vi(Ht(e,1,vt,!0),r,i)});function gy(e){return e&&e.length?vi(e):[]}function yy(e,i){return e&&e.length?vi(e,ie(i,2)):[]}function vy(e,i){return i=typeof i=="function"?i:r,e&&e.length?vi(e,r,i):[]}function Ja(e){if(!(e&&e.length))return[];var i=0;return e=fi(e,function(s){if(vt(s))return i=$t(s.length,i),!0}),fa(i,function(s){return Ye(e,ua(s))})}function xh(e,i){if(!(e&&e.length))return[];var s=Ja(e);return i==null?s:Ye(s,function(u){return Dt(i,r,u)})}var my=_e(function(e,i){return vt(e)?Dn(e,i):[]}),wy=_e(function(e){return Na(fi(e,vt))}),_y=_e(function(e){var i=xr(e);return vt(i)&&(i=r),Na(fi(e,vt),ie(i,2))}),by=_e(function(e){var i=xr(e);return i=typeof i=="function"?i:r,Na(fi(e,vt),r,i)}),Ey=_e(Ja);function Iy(e,i){return ku(e||[],i||[],Nn)}function xy(e,i){return ku(e||[],i||[],Ln)}var Py=_e(function(e){var i=e.length,s=i>1?e[i-1]:r;return s=typeof s=="function"?(e.pop(),s):r,xh(e,s)});function Ph(e){var i=d(e);return i.__chain__=!0,i}function Sy(e,i){return i(e),e}function so(e,i){return i(e)}var Oy=Xr(function(e){var i=e.length,s=i?e[0]:0,u=this.__wrapped__,l=function(y){return _a(y,e)};return i>1||this.__actions__.length||!(u instanceof xe)||!ei(s)?this.thru(l):(u=u.slice(s,+s+(i?1:0)),u.__actions__.push({func:so,args:[l],thisArg:r}),new br(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function Ry(){return Ph(this)}function Ay(){return new br(this.value(),this.__chain__)}function Ty(){this.__values__===r&&(this.__values__=zh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Cy(){return this}function $y(e){for(var i,s=this;s instanceof Bs;){var u=mh(s);u.__index__=0,u.__values__=r,i?l.__wrapped__=u:i=u;var l=u;s=s.__wrapped__}return l.__wrapped__=e,i}function Ny(){var e=this.__wrapped__;if(e instanceof xe){var i=e;return this.__actions__.length&&(i=new xe(this)),i=i.reverse(),i.__actions__.push({func:so,args:[Wa],thisArg:r}),new br(i,this.__chain__)}return this.thru(Wa)}function Dy(){return Hu(this.__wrapped__,this.__actions__)}var jy=Ys(function(e,i,s){De.call(e,s)?++e[s]:Yr(e,s,1)});function qy(e,i,s){var u=ge(e)?eu:Sd;return s&&Yt(e,i,s)&&(i=r),u(e,ie(i,3))}function Ly(e,i){var s=ge(e)?fi:xu;return s(e,ie(i,3))}var My=Zu(wh),zy=Zu(_h);function Uy(e,i){return Ht(oo(e,i),1)}function Hy(e,i){return Ht(oo(e,i),le)}function ky(e,i,s){return s=s===r?1:ye(s),Ht(oo(e,i),s)}function Sh(e,i){var s=ge(e)?wr:yi;return s(e,ie(i,3))}function Oh(e,i){var s=ge(e)?ap:Iu;return s(e,ie(i,3))}var Ky=Ys(function(e,i,s){De.call(e,s)?e[s].push(i):Yr(e,s,[i])});function By(e,i,s,u){e=rr(e)?e:dn(e),s=s&&!u?ye(s):0;var l=e.length;return s<0&&(s=$t(l+s,0)),lo(e)?s<=l&&e.indexOf(i,s)>-1:!!l&&tn(e,i,s)>-1}var Fy=_e(function(e,i,s){var u=-1,l=typeof i=="function",y=rr(e)?$(e.length):[];return yi(e,function(w){y[++u]=l?Dt(i,w,s):jn(w,i,s)}),y}),Vy=Ys(function(e,i,s){Yr(e,s,i)});function oo(e,i){var s=ge(e)?Ye:Tu;return s(e,ie(i,3))}function Gy(e,i,s,u){return e==null?[]:(ge(i)||(i=i==null?[]:[i]),s=u?r:s,ge(s)||(s=s==null?[]:[s]),Du(e,i,s))}var Wy=Ys(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function Jy(e,i,s){var u=ge(e)?aa:nu,l=arguments.length<3;return u(e,ie(i,4),s,l,yi)}function Qy(e,i,s){var u=ge(e)?cp:nu,l=arguments.length<3;return u(e,ie(i,4),s,l,Iu)}function Yy(e,i){var s=ge(e)?fi:xu;return s(e,uo(ie(i,3)))}function Zy(e){var i=ge(e)?wu:Bd;return i(e)}function Xy(e,i,s){(s?Yt(e,i,s):i===r)?i=1:i=ye(i);var u=ge(e)?bd:Fd;return u(e,i)}function ev(e){var i=ge(e)?Ed:Gd;return i(e)}function tv(e){if(e==null)return 0;if(rr(e))return lo(e)?nn(e):e.length;var i=Bt(e);return i==me||i==Ce?e.size:Sa(e).length}function rv(e,i,s){var u=ge(e)?ca:Wd;return s&&Yt(e,i,s)&&(i=r),u(e,ie(i,3))}var iv=_e(function(e,i){if(e==null)return[];var s=i.length;return s>1&&Yt(e,i[0],i[1])?i=[]:s>2&&Yt(i[0],i[1],i[2])&&(i=[i[0]]),Du(e,Ht(i,1),[])}),ao=Lp||function(){return Pe.Date.now()};function nv(e,i){if(typeof i!="function")throw new _r(f);return e=ye(e),function(){if(--e<1)return i.apply(this,arguments)}}function Rh(e,i,s){return i=s?r:i,i=e&&i==null?e.length:i,Zr(e,Y,r,r,r,r,i)}function Ah(e,i){var s;if(typeof i!="function")throw new _r(f);return e=ye(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=r),s}}var Qa=_e(function(e,i,s){var u=ee;if(s.length){var l=di(s,fn(Qa));u|=he}return Zr(e,u,i,s,l)}),Th=_e(function(e,i,s){var u=ee|ce;if(s.length){var l=di(s,fn(Th));u|=he}return Zr(i,u,e,s,l)});function Ch(e,i,s){i=s?r:i;var u=Zr(e,oe,r,r,r,r,r,i);return u.placeholder=Ch.placeholder,u}function $h(e,i,s){i=s?r:i;var u=Zr(e,te,r,r,r,r,r,i);return u.placeholder=$h.placeholder,u}function Nh(e,i,s){var u,l,y,w,E,R,L=0,M=!1,U=!1,F=!0;if(typeof e!="function")throw new _r(f);i=Pr(i)||0,it(s)&&(M=!!s.leading,U="maxWait"in s,y=U?$t(Pr(s.maxWait)||0,i):y,F="trailing"in s?!!s.trailing:F);function X(mt){var Dr=u,ii=l;return u=l=r,L=mt,w=e.apply(ii,Dr),w}function ne(mt){return L=mt,E=Un(be,i),M?X(mt):w}function we(mt){var Dr=mt-R,ii=mt-L,Zh=i-Dr;return U?Kt(Zh,y-ii):Zh}function se(mt){var Dr=mt-R,ii=mt-L;return R===r||Dr>=i||Dr<0||U&&ii>=y}function be(){var mt=ao();if(se(mt))return Se(mt);E=Un(be,we(mt))}function Se(mt){return E=r,F&&u?X(mt):(u=l=r,w)}function dr(){E!==r&&Ku(E),L=0,u=R=l=E=r}function Zt(){return E===r?w:Se(ao())}function gr(){var mt=ao(),Dr=se(mt);if(u=arguments,l=this,R=mt,Dr){if(E===r)return ne(R);if(U)return Ku(E),E=Un(be,i),X(R)}return E===r&&(E=Un(be,i)),w}return gr.cancel=dr,gr.flush=Zt,gr}var sv=_e(function(e,i){return Eu(e,1,i)}),ov=_e(function(e,i,s){return Eu(e,Pr(i)||0,s)});function av(e){return Zr(e,wt)}function co(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new _r(f);var s=function(){var u=arguments,l=i?i.apply(this,u):u[0],y=s.cache;if(y.has(l))return y.get(l);var w=e.apply(this,u);return s.cache=y.set(l,w)||y,w};return s.cache=new(co.Cache||Qr),s}co.Cache=Qr;function uo(e){if(typeof e!="function")throw new _r(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function cv(e){return Ah(2,e)}var uv=Jd(function(e,i){i=i.length==1&&ge(i[0])?Ye(i[0],lr(ie())):Ye(Ht(i,1),lr(ie()));var s=i.length;return _e(function(u){for(var l=-1,y=Kt(u.length,s);++l<y;)u[l]=i[l].call(this,u[l]);return Dt(e,this,u)})}),Ya=_e(function(e,i){var s=di(i,fn(Ya));return Zr(e,he,r,i,s)}),Dh=_e(function(e,i){var s=di(i,fn(Dh));return Zr(e,pe,r,i,s)}),hv=Xr(function(e,i){return Zr(e,ve,r,r,r,i)});function lv(e,i){if(typeof e!="function")throw new _r(f);return i=i===r?i:ye(i),_e(e,i)}function fv(e,i){if(typeof e!="function")throw new _r(f);return i=i==null?0:$t(ye(i),0),_e(function(s){var u=s[i],l=wi(s,0,i);return u&&pi(l,u),Dt(e,this,l)})}function pv(e,i,s){var u=!0,l=!0;if(typeof e!="function")throw new _r(f);return it(s)&&(u="leading"in s?!!s.leading:u,l="trailing"in s?!!s.trailing:l),Nh(e,i,{leading:u,maxWait:i,trailing:l})}function dv(e){return Rh(e,1)}function gv(e,i){return Ya(ja(i),e)}function yv(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function vv(e){return Er(e,D)}function mv(e,i){return i=typeof i=="function"?i:r,Er(e,D,i)}function wv(e){return Er(e,x|D)}function _v(e,i){return i=typeof i=="function"?i:r,Er(e,x|D,i)}function bv(e,i){return i==null||bu(e,i,jt(i))}function Nr(e,i){return e===i||e!==e&&i!==i}var Ev=to(Ia),Iv=to(function(e,i){return e>=i}),Hi=Ou(function(){return arguments}())?Ou:function(e){return pt(e)&&De.call(e,"callee")&&!pu.call(e,"callee")},ge=$.isArray,xv=Jt?lr(Jt):$d;function rr(e){return e!=null&&ho(e.length)&&!ti(e)}function vt(e){return pt(e)&&rr(e)}function Pv(e){return e===!0||e===!1||pt(e)&&Qt(e)==N}var _i=zp||cc,Sv=Tr?lr(Tr):Nd;function Ov(e){return pt(e)&&e.nodeType===1&&!Hn(e)}function Rv(e){if(e==null)return!0;if(rr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||_i(e)||pn(e)||Hi(e)))return!e.length;var i=Bt(e);if(i==me||i==Ce)return!e.size;if(zn(e))return!Sa(e).length;for(var s in e)if(De.call(e,s))return!1;return!0}function Av(e,i){return qn(e,i)}function Tv(e,i,s){s=typeof s=="function"?s:r;var u=s?s(e,i):r;return u===r?qn(e,i,r,s):!!u}function Za(e){if(!pt(e))return!1;var i=Qt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Hn(e)}function Cv(e){return typeof e=="number"&&gu(e)}function ti(e){if(!it(e))return!1;var i=Qt(e);return i==Z||i==ue||i==j||i==dt}function jh(e){return typeof e=="number"&&e==ye(e)}function ho(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function it(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function pt(e){return e!=null&&typeof e=="object"}var qh=mr?lr(mr):jd;function $v(e,i){return e===i||Pa(e,i,ka(i))}function Nv(e,i,s){return s=typeof s=="function"?s:r,Pa(e,i,ka(i),s)}function Dv(e){return Lh(e)&&e!=+e}function jv(e){if(mg(e))throw new fe(c);return Ru(e)}function qv(e){return e===null}function Lv(e){return e==null}function Lh(e){return typeof e=="number"||pt(e)&&Qt(e)==Oe}function Hn(e){if(!pt(e)||Qt(e)!=Ie)return!1;var i=Ls(e);if(i===null)return!0;var s=De.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Ns.call(s)==Np}var Xa=Ur?lr(Ur):qd;function Mv(e){return jh(e)&&e>=-k&&e<=k}var Mh=Sn?lr(Sn):Ld;function lo(e){return typeof e=="string"||!ge(e)&&pt(e)&&Qt(e)==Be}function pr(e){return typeof e=="symbol"||pt(e)&&Qt(e)==Fe}var pn=Ni?lr(Ni):Md;function zv(e){return e===r}function Uv(e){return pt(e)&&Bt(e)==je}function Hv(e){return pt(e)&&Qt(e)==Ve}var kv=to(Oa),Kv=to(function(e,i){return e<=i});function zh(e){if(!e)return[];if(rr(e))return lo(e)?Cr(e):tr(e);if(Rn&&e[Rn])return bp(e[Rn]());var i=Bt(e),s=i==me?da:i==Ce?Ts:dn;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Pr(e),e===le||e===-le){var i=e<0?-1:1;return i*H}return e===e?e:0}function ye(e){var i=ri(e),s=i%1;return i===i?s?i-s:i:0}function Uh(e){return e?Li(ye(e),0,B):0}function Pr(e){if(typeof e=="number")return e;if(pr(e))return K;if(it(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=it(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=su(e);var s=Ko.test(e);return s||Fo.test(e)?de(e.slice(2),s?2:8):ko.test(e)?K:+e}function Hh(e){return kr(e,ir(e))}function Bv(e){return e?Li(ye(e),-k,k):e===0?e:0}function $e(e){return e==null?"":fr(e)}var Fv=hn(function(e,i){if(zn(i)||rr(i)){kr(i,jt(i),e);return}for(var s in i)De.call(i,s)&&Nn(e,s,i[s])}),kh=hn(function(e,i){kr(i,ir(i),e)}),fo=hn(function(e,i,s,u){kr(i,ir(i),e,u)}),Vv=hn(function(e,i,s,u){kr(i,jt(i),e,u)}),Gv=Xr(_a);function Wv(e,i){var s=un(e);return i==null?s:_u(s,i)}var Jv=_e(function(e,i){e=He(e);var s=-1,u=i.length,l=u>2?i[2]:r;for(l&&Yt(i[0],i[1],l)&&(u=1);++s<u;)for(var y=i[s],w=ir(y),E=-1,R=w.length;++E<R;){var L=w[E],M=e[L];(M===r||Nr(M,on[L])&&!De.call(e,L))&&(e[L]=y[L])}return e}),Qv=_e(function(e){return e.push(r,sh),Dt(Kh,r,e)});function Yv(e,i){return tu(e,ie(i,3),Hr)}function Zv(e,i){return tu(e,ie(i,3),Ea)}function Xv(e,i){return e==null?e:ba(e,ie(i,3),ir)}function em(e,i){return e==null?e:Pu(e,ie(i,3),ir)}function tm(e,i){return e&&Hr(e,ie(i,3))}function rm(e,i){return e&&Ea(e,ie(i,3))}function im(e){return e==null?[]:Gs(e,jt(e))}function nm(e){return e==null?[]:Gs(e,ir(e))}function ec(e,i,s){var u=e==null?r:Mi(e,i);return u===r?s:u}function sm(e,i){return e!=null&&ch(e,i,Rd)}function tc(e,i){return e!=null&&ch(e,i,Ad)}var om=eh(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Ds.call(i)),e[i]=s},ic(nr)),am=eh(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Ds.call(i)),De.call(e,i)?e[i].push(s):e[i]=[s]},ie),cm=_e(jn);function jt(e){return rr(e)?mu(e):Sa(e)}function ir(e){return rr(e)?mu(e,!0):zd(e)}function um(e,i){var s={};return i=ie(i,3),Hr(e,function(u,l,y){Yr(s,i(u,l,y),u)}),s}function hm(e,i){var s={};return i=ie(i,3),Hr(e,function(u,l,y){Yr(s,l,i(u,l,y))}),s}var lm=hn(function(e,i,s){Ws(e,i,s)}),Kh=hn(function(e,i,s,u){Ws(e,i,s,u)}),fm=Xr(function(e,i){var s={};if(e==null)return s;var u=!1;i=Ye(i,function(y){return y=mi(y,e),u||(u=y.length>1),y}),kr(e,Ua(e),s),u&&(s=Er(s,x|T|D,og));for(var l=i.length;l--;)$a(s,i[l]);return s});function pm(e,i){return Bh(e,uo(ie(i)))}var dm=Xr(function(e,i){return e==null?{}:Hd(e,i)});function Bh(e,i){if(e==null)return{};var s=Ye(Ua(e),function(u){return[u]});return i=ie(i),ju(e,s,function(u,l){return i(u,l[0])})}function gm(e,i,s){i=mi(i,e);var u=-1,l=i.length;for(l||(l=1,e=r);++u<l;){var y=e==null?r:e[Kr(i[u])];y===r&&(u=l,y=s),e=ti(y)?y.call(e):y}return e}function ym(e,i,s){return e==null?e:Ln(e,i,s)}function vm(e,i,s,u){return u=typeof u=="function"?u:r,e==null?e:Ln(e,i,s,u)}var Fh=ih(jt),Vh=ih(ir);function mm(e,i,s){var u=ge(e),l=u||_i(e)||pn(e);if(i=ie(i,4),s==null){var y=e&&e.constructor;l?s=u?new y:[]:it(e)?s=ti(y)?un(Ls(e)):{}:s={}}return(l?wr:Hr)(e,function(w,E,R){return i(s,w,E,R)}),s}function wm(e,i){return e==null?!0:$a(e,i)}function _m(e,i,s){return e==null?e:Uu(e,i,ja(s))}function bm(e,i,s,u){return u=typeof u=="function"?u:r,e==null?e:Uu(e,i,ja(s),u)}function dn(e){return e==null?[]:pa(e,jt(e))}function Em(e){return e==null?[]:pa(e,ir(e))}function Im(e,i,s){return s===r&&(s=i,i=r),s!==r&&(s=Pr(s),s=s===s?s:0),i!==r&&(i=Pr(i),i=i===i?i:0),Li(Pr(e),i,s)}function xm(e,i,s){return i=ri(i),s===r?(s=i,i=0):s=ri(s),e=Pr(e),Td(e,i,s)}function Pm(e,i,s){if(s&&typeof s!="boolean"&&Yt(e,i,s)&&(i=s=r),s===r&&(typeof i=="boolean"?(s=i,i=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ri(e),i===r?(i=e,e=0):i=ri(i)),e>i){var u=e;e=i,i=u}if(s||e%1||i%1){var l=yu();return Kt(e+l*(i-e+ze("1e-"+((l+"").length-1))),i)}return Aa(e,i)}var Sm=ln(function(e,i,s){return i=i.toLowerCase(),e+(s?Gh(i):i)});function Gh(e){return rc($e(e).toLowerCase())}function Wh(e){return e=$e(e),e&&e.replace(Gr,yp).replace(na,"")}function Om(e,i,s){e=$e(e),i=fr(i);var u=e.length;s=s===r?u:Li(ye(s),0,u);var l=s;return s-=i.length,s>=0&&e.slice(s,l)==i}function Rm(e){return e=$e(e),e&&Je.test(e)?e.replace(Ri,vp):e}function Am(e){return e=$e(e),e&&xt.test(e)?e.replace(ht,"\\$&"):e}var Tm=ln(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),Cm=ln(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),$m=Yu("toLowerCase");function Nm(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;if(!i||u>=i)return e;var l=(i-u)/2;return eo(Hs(l),s)+e+eo(Us(l),s)}function Dm(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;return i&&u<i?e+eo(i-u,s):e}function jm(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;return i&&u<i?eo(i-u,s)+e:e}function qm(e,i,s){return s||i==null?i=0:i&&(i=+i),Kp($e(e).replace(lt,""),i||0)}function Lm(e,i,s){return(s?Yt(e,i,s):i===r)?i=1:i=ye(i),Ta($e(e),i)}function Mm(){var e=arguments,i=$e(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var zm=ln(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function Um(e,i,s){return s&&typeof s!="number"&&Yt(e,i,s)&&(i=s=r),s=s===r?B:s>>>0,s?(e=$e(e),e&&(typeof i=="string"||i!=null&&!Xa(i))&&(i=fr(i),!i&&rn(e))?wi(Cr(e),0,s):e.split(i,s)):[]}var Hm=ln(function(e,i,s){return e+(s?" ":"")+rc(i)});function km(e,i,s){return e=$e(e),s=s==null?0:Li(ye(s),0,e.length),i=fr(i),e.slice(s,s+i.length)==i}function Km(e,i,s){var u=d.templateSettings;s&&Yt(e,i,s)&&(i=r),e=$e(e),i=fo({},i,u,nh);var l=fo({},i.imports,u.imports,nh),y=jt(l),w=pa(l,y),E,R,L=0,M=i.interpolate||Wi,U="__p += '",F=ga((i.escape||Wi).source+"|"+M.source+"|"+(M===rt?Ho:Wi).source+"|"+(i.evaluate||Wi).source+"|$","g"),X="//# sourceURL="+(De.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++sa+"]")+`
`;e.replace(F,function(se,be,Se,dr,Zt,gr){return Se||(Se=dr),U+=e.slice(L,gr).replace(Go,mp),be&&(E=!0,U+=`' +
__e(`+be+`) +
'`),Zt&&(R=!0,U+=`';
`+Zt+`;
__p += '`),Se&&(U+=`' +
((__t = (`+Se+`)) == null ? '' : __t) +
'`),L=gr+se.length,se}),U+=`';
`;var ne=De.call(i,"variable")&&i.variable;if(!ne)U=`with (obj) {
`+U+`
}
`;else if(zo.test(ne))throw new fe(g);U=(R?U.replace(Mr,""):U).replace(Wt,"$1").replace(Vr,"$1;"),U="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var we=Qh(function(){return Te(y,X+"return "+U).apply(r,w)});if(we.source=U,Za(we))throw we;return we}function Bm(e){return $e(e).toLowerCase()}function Fm(e){return $e(e).toUpperCase()}function Vm(e,i,s){if(e=$e(e),e&&(s||i===r))return su(e);if(!e||!(i=fr(i)))return e;var u=Cr(e),l=Cr(i),y=ou(u,l),w=au(u,l)+1;return wi(u,y,w).join("")}function Gm(e,i,s){if(e=$e(e),e&&(s||i===r))return e.slice(0,uu(e)+1);if(!e||!(i=fr(i)))return e;var u=Cr(e),l=au(u,Cr(i))+1;return wi(u,0,l).join("")}function Wm(e,i,s){if(e=$e(e),e&&(s||i===r))return e.replace(lt,"");if(!e||!(i=fr(i)))return e;var u=Cr(e),l=ou(u,Cr(i));return wi(u,l).join("")}function Jm(e,i){var s=nt,u=Ke;if(it(i)){var l="separator"in i?i.separator:l;s="length"in i?ye(i.length):s,u="omission"in i?fr(i.omission):u}e=$e(e);var y=e.length;if(rn(e)){var w=Cr(e);y=w.length}if(s>=y)return e;var E=s-nn(u);if(E<1)return u;var R=w?wi(w,0,E).join(""):e.slice(0,E);if(l===r)return R+u;if(w&&(E+=R.length-E),Xa(l)){if(e.slice(E).search(l)){var L,M=R;for(l.global||(l=ga(l.source,$e(vr.exec(l))+"g")),l.lastIndex=0;L=l.exec(M);)var U=L.index;R=R.slice(0,U===r?E:U)}}else if(e.indexOf(fr(l),E)!=E){var F=R.lastIndexOf(l);F>-1&&(R=R.slice(0,F))}return R+u}function Qm(e){return e=$e(e),e&&at.test(e)?e.replace(hi,Pp):e}var Ym=ln(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),rc=Yu("toUpperCase");function Jh(e,i,s){return e=$e(e),i=s?r:i,i===r?_p(e)?Rp(e):lp(e):e.match(i)||[]}var Qh=_e(function(e,i){try{return Dt(e,r,i)}catch(s){return Za(s)?s:new fe(s)}}),Zm=Xr(function(e,i){return wr(i,function(s){s=Kr(s),Yr(e,s,Qa(e[s],e))}),e});function Xm(e){var i=e==null?0:e.length,s=ie();return e=i?Ye(e,function(u){if(typeof u[1]!="function")throw new _r(f);return[s(u[0]),u[1]]}):[],_e(function(u){for(var l=-1;++l<i;){var y=e[l];if(Dt(y[0],this,u))return Dt(y[1],this,u)}})}function e0(e){return Pd(Er(e,x))}function ic(e){return function(){return e}}function t0(e,i){return e==null||e!==e?i:e}var r0=Xu(),i0=Xu(!0);function nr(e){return e}function nc(e){return Au(typeof e=="function"?e:Er(e,x))}function n0(e){return Cu(Er(e,x))}function s0(e,i){return $u(e,Er(i,x))}var o0=_e(function(e,i){return function(s){return jn(s,e,i)}}),a0=_e(function(e,i){return function(s){return jn(e,s,i)}});function sc(e,i,s){var u=jt(i),l=Gs(i,u);s==null&&!(it(i)&&(l.length||!u.length))&&(s=i,i=e,e=this,l=Gs(i,jt(i)));var y=!(it(s)&&"chain"in s)||!!s.chain,w=ti(e);return wr(l,function(E){var R=i[E];e[E]=R,w&&(e.prototype[E]=function(){var L=this.__chain__;if(y||L){var M=e(this.__wrapped__),U=M.__actions__=tr(this.__actions__);return U.push({func:R,args:arguments,thisArg:e}),M.__chain__=L,M}return R.apply(e,pi([this.value()],arguments))})}),e}function c0(){return Pe._===this&&(Pe._=Dp),this}function oc(){}function u0(e){return e=ye(e),_e(function(i){return Nu(i,e)})}var h0=La(Ye),l0=La(eu),f0=La(ca);function Yh(e){return Ba(e)?ua(Kr(e)):kd(e)}function p0(e){return function(i){return e==null?r:Mi(e,i)}}var d0=th(),g0=th(!0);function ac(){return[]}function cc(){return!1}function y0(){return{}}function v0(){return""}function m0(){return!0}function w0(e,i){if(e=ye(e),e<1||e>k)return[];var s=B,u=Kt(e,B);i=ie(i),e-=B;for(var l=fa(u,i);++s<e;)i(s);return l}function _0(e){return ge(e)?Ye(e,Kr):pr(e)?[e]:tr(vh($e(e)))}function b0(e){var i=++$p;return $e(e)+i}var E0=Xs(function(e,i){return e+i},0),I0=Ma("ceil"),x0=Xs(function(e,i){return e/i},1),P0=Ma("floor");function S0(e){return e&&e.length?Vs(e,nr,Ia):r}function O0(e,i){return e&&e.length?Vs(e,ie(i,2),Ia):r}function R0(e){return iu(e,nr)}function A0(e,i){return iu(e,ie(i,2))}function T0(e){return e&&e.length?Vs(e,nr,Oa):r}function C0(e,i){return e&&e.length?Vs(e,ie(i,2),Oa):r}var $0=Xs(function(e,i){return e*i},1),N0=Ma("round"),D0=Xs(function(e,i){return e-i},0);function j0(e){return e&&e.length?la(e,nr):0}function q0(e,i){return e&&e.length?la(e,ie(i,2)):0}return d.after=nv,d.ary=Rh,d.assign=Fv,d.assignIn=kh,d.assignInWith=fo,d.assignWith=Vv,d.at=Gv,d.before=Ah,d.bind=Qa,d.bindAll=Zm,d.bindKey=Th,d.castArray=yv,d.chain=Ph,d.chunk=Pg,d.compact=Sg,d.concat=Og,d.cond=Xm,d.conforms=e0,d.constant=ic,d.countBy=jy,d.create=Wv,d.curry=Ch,d.curryRight=$h,d.debounce=Nh,d.defaults=Jv,d.defaultsDeep=Qv,d.defer=sv,d.delay=ov,d.difference=Rg,d.differenceBy=Ag,d.differenceWith=Tg,d.drop=Cg,d.dropRight=$g,d.dropRightWhile=Ng,d.dropWhile=Dg,d.fill=jg,d.filter=Ly,d.flatMap=Uy,d.flatMapDeep=Hy,d.flatMapDepth=ky,d.flatten=bh,d.flattenDeep=qg,d.flattenDepth=Lg,d.flip=av,d.flow=r0,d.flowRight=i0,d.fromPairs=Mg,d.functions=im,d.functionsIn=nm,d.groupBy=Ky,d.initial=Ug,d.intersection=Hg,d.intersectionBy=kg,d.intersectionWith=Kg,d.invert=om,d.invertBy=am,d.invokeMap=Fy,d.iteratee=nc,d.keyBy=Vy,d.keys=jt,d.keysIn=ir,d.map=oo,d.mapKeys=um,d.mapValues=hm,d.matches=n0,d.matchesProperty=s0,d.memoize=co,d.merge=lm,d.mergeWith=Kh,d.method=o0,d.methodOf=a0,d.mixin=sc,d.negate=uo,d.nthArg=u0,d.omit=fm,d.omitBy=pm,d.once=cv,d.orderBy=Gy,d.over=h0,d.overArgs=uv,d.overEvery=l0,d.overSome=f0,d.partial=Ya,d.partialRight=Dh,d.partition=Wy,d.pick=dm,d.pickBy=Bh,d.property=Yh,d.propertyOf=p0,d.pull=Gg,d.pullAll=Ih,d.pullAllBy=Wg,d.pullAllWith=Jg,d.pullAt=Qg,d.range=d0,d.rangeRight=g0,d.rearg=hv,d.reject=Yy,d.remove=Yg,d.rest=lv,d.reverse=Wa,d.sampleSize=Xy,d.set=ym,d.setWith=vm,d.shuffle=ev,d.slice=Zg,d.sortBy=iv,d.sortedUniq=sy,d.sortedUniqBy=oy,d.split=Um,d.spread=fv,d.tail=ay,d.take=cy,d.takeRight=uy,d.takeRightWhile=hy,d.takeWhile=ly,d.tap=Sy,d.throttle=pv,d.thru=so,d.toArray=zh,d.toPairs=Fh,d.toPairsIn=Vh,d.toPath=_0,d.toPlainObject=Hh,d.transform=mm,d.unary=dv,d.union=fy,d.unionBy=py,d.unionWith=dy,d.uniq=gy,d.uniqBy=yy,d.uniqWith=vy,d.unset=wm,d.unzip=Ja,d.unzipWith=xh,d.update=_m,d.updateWith=bm,d.values=dn,d.valuesIn=Em,d.without=my,d.words=Jh,d.wrap=gv,d.xor=wy,d.xorBy=_y,d.xorWith=by,d.zip=Ey,d.zipObject=Iy,d.zipObjectDeep=xy,d.zipWith=Py,d.entries=Fh,d.entriesIn=Vh,d.extend=kh,d.extendWith=fo,sc(d,d),d.add=E0,d.attempt=Qh,d.camelCase=Sm,d.capitalize=Gh,d.ceil=I0,d.clamp=Im,d.clone=vv,d.cloneDeep=wv,d.cloneDeepWith=_v,d.cloneWith=mv,d.conformsTo=bv,d.deburr=Wh,d.defaultTo=t0,d.divide=x0,d.endsWith=Om,d.eq=Nr,d.escape=Rm,d.escapeRegExp=Am,d.every=qy,d.find=My,d.findIndex=wh,d.findKey=Yv,d.findLast=zy,d.findLastIndex=_h,d.findLastKey=Zv,d.floor=P0,d.forEach=Sh,d.forEachRight=Oh,d.forIn=Xv,d.forInRight=em,d.forOwn=tm,d.forOwnRight=rm,d.get=ec,d.gt=Ev,d.gte=Iv,d.has=sm,d.hasIn=tc,d.head=Eh,d.identity=nr,d.includes=By,d.indexOf=zg,d.inRange=xm,d.invoke=cm,d.isArguments=Hi,d.isArray=ge,d.isArrayBuffer=xv,d.isArrayLike=rr,d.isArrayLikeObject=vt,d.isBoolean=Pv,d.isBuffer=_i,d.isDate=Sv,d.isElement=Ov,d.isEmpty=Rv,d.isEqual=Av,d.isEqualWith=Tv,d.isError=Za,d.isFinite=Cv,d.isFunction=ti,d.isInteger=jh,d.isLength=ho,d.isMap=qh,d.isMatch=$v,d.isMatchWith=Nv,d.isNaN=Dv,d.isNative=jv,d.isNil=Lv,d.isNull=qv,d.isNumber=Lh,d.isObject=it,d.isObjectLike=pt,d.isPlainObject=Hn,d.isRegExp=Xa,d.isSafeInteger=Mv,d.isSet=Mh,d.isString=lo,d.isSymbol=pr,d.isTypedArray=pn,d.isUndefined=zv,d.isWeakMap=Uv,d.isWeakSet=Hv,d.join=Bg,d.kebabCase=Tm,d.last=xr,d.lastIndexOf=Fg,d.lowerCase=Cm,d.lowerFirst=$m,d.lt=kv,d.lte=Kv,d.max=S0,d.maxBy=O0,d.mean=R0,d.meanBy=A0,d.min=T0,d.minBy=C0,d.stubArray=ac,d.stubFalse=cc,d.stubObject=y0,d.stubString=v0,d.stubTrue=m0,d.multiply=$0,d.nth=Vg,d.noConflict=c0,d.noop=oc,d.now=ao,d.pad=Nm,d.padEnd=Dm,d.padStart=jm,d.parseInt=qm,d.random=Pm,d.reduce=Jy,d.reduceRight=Qy,d.repeat=Lm,d.replace=Mm,d.result=gm,d.round=N0,d.runInContext=S,d.sample=Zy,d.size=tv,d.snakeCase=zm,d.some=rv,d.sortedIndex=Xg,d.sortedIndexBy=ey,d.sortedIndexOf=ty,d.sortedLastIndex=ry,d.sortedLastIndexBy=iy,d.sortedLastIndexOf=ny,d.startCase=Hm,d.startsWith=km,d.subtract=D0,d.sum=j0,d.sumBy=q0,d.template=Km,d.times=w0,d.toFinite=ri,d.toInteger=ye,d.toLength=Uh,d.toLower=Bm,d.toNumber=Pr,d.toSafeInteger=Bv,d.toString=$e,d.toUpper=Fm,d.trim=Vm,d.trimEnd=Gm,d.trimStart=Wm,d.truncate=Jm,d.unescape=Qm,d.uniqueId=b0,d.upperCase=Ym,d.upperFirst=rc,d.each=Sh,d.eachRight=Oh,d.first=Eh,sc(d,function(){var e={};return Hr(d,function(i,s){De.call(d.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),d.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),wr(["drop","take"],function(e,i){xe.prototype[e]=function(s){s=s===r?1:$t(ye(s),0);var u=this.__filtered__&&!i?new xe(this):this.clone();return u.__filtered__?u.__takeCount__=Kt(s,u.__takeCount__):u.__views__.push({size:Kt(s,B),type:e+(u.__dir__<0?"Right":"")}),u},xe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,i){var s=i+1,u=s==b||s==Q;xe.prototype[e]=function(l){var y=this.clone();return y.__iteratees__.push({iteratee:ie(l,3),type:s}),y.__filtered__=y.__filtered__||u,y}}),wr(["head","last"],function(e,i){var s="take"+(i?"Right":"");xe.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[s](1)}}),xe.prototype.compact=function(){return this.filter(nr)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=_e(function(e,i){return typeof e=="function"?new xe(this):this.map(function(s){return jn(s,e,i)})}),xe.prototype.reject=function(e){return this.filter(uo(ie(e)))},xe.prototype.slice=function(e,i){e=ye(e);var s=this;return s.__filtered__&&(e>0||i<0)?new xe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==r&&(i=ye(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(B)},Hr(xe.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),l=d[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,E=u?[1]:arguments,R=w instanceof xe,L=E[0],M=R||ge(w),U=function(be){var Se=l.apply(d,pi([be],E));return u&&F?Se[0]:Se};M&&s&&typeof L=="function"&&L.length!=1&&(R=M=!1);var F=this.__chain__,X=!!this.__actions__.length,ne=y&&!F,we=R&&!X;if(!y&&M){w=we?w:new xe(this);var se=e.apply(w,E);return se.__actions__.push({func:so,args:[U],thisArg:r}),new br(se,F)}return ne&&we?e.apply(this,E):(se=this.thru(U),ne?u?se.value()[0]:se.value():se)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Cs[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(ge(y)?y:[],l)}return this[s](function(w){return i.apply(ge(w)?w:[],l)})}}),Hr(xe.prototype,function(e,i){var s=d[i];if(s){var u=s.name+"";De.call(cn,u)||(cn[u]=[]),cn[u].push({name:i,func:s})}}),cn[Zs(r,ce).name]=[{name:"wrapper",func:r}],xe.prototype.clone=Qp,xe.prototype.reverse=Yp,xe.prototype.value=Zp,d.prototype.at=Oy,d.prototype.chain=Ry,d.prototype.commit=Ay,d.prototype.next=Ty,d.prototype.plant=$y,d.prototype.reverse=Ny,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Dy,d.prototype.first=d.prototype.head,Rn&&(d.prototype[Rn]=Cy),d},sn=Ap();yt?((yt.exports=sn)._=sn,Ue._=sn):Pe._=sn}).call(Wn)})(zc,zc.exports);var Ex=Object.defineProperty,Ix=Object.defineProperties,xx=Object.getOwnPropertyDescriptors,nf=Object.getOwnPropertySymbols,Px=Object.prototype.hasOwnProperty,Sx=Object.prototype.propertyIsEnumerable,sf=(a,t,r)=>t in a?Ex(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,wo=(a,t)=>{for(var r in t||(t={}))Px.call(t,r)&&sf(a,r,t[r]);if(nf)for(var r of nf(t))Sx.call(t,r)&&sf(a,r,t[r]);return a},Ox=(a,t)=>Ix(a,xx(t));function xi(a,t,r){var n;const o=Ew(a);return((n=t.rpcMap)==null?void 0:n[o.reference])||`${bx}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Gi(a){return a.includes(":")?a.split(":")[1]:a}function np(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Rx(a,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!r.length)return[];const n=[];return r.forEach(o=>{const c=t.namespaces[o].accounts;n.push(...c)}),n}function Ax(a={},t={}){const r=of(a),n=of(t);return zc.exports.merge(r,n)}function of(a){var t,r,n,o;const c={};if(!Eo(a))return c;for(const[f,g]of Object.entries(a)){const v=wf(f)?[f]:g.chains,p=g.methods||[],_=g.events||[],x=g.rpcMap||{},T=Jn(f);c[T]=Ox(wo(wo({},c[T]),g),{chains:hc(v,(t=c[T])==null?void 0:t.chains),methods:hc(p,(r=c[T])==null?void 0:r.methods),events:hc(_,(n=c[T])==null?void 0:n.events),rpcMap:wo(wo({},x),(o=c[T])==null?void 0:o.rpcMap)})}return c}function Tx(a){return a.includes(":")?a.split(":")[2]:a}function Cx(a){const t={};for(const[r,n]of Object.entries(a)){const o=n.methods||[],c=n.events||[],f=n.accounts||[],g=wf(r)?[r]:n.chains?n.chains:np(n.accounts);t[r]={chains:g,methods:o,events:c,accounts:f}}return t}function bc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const sp={},Ze=a=>sp[a],Ec=(a,t)=>{sp[a]=t};class $x{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Nx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||xi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=parseInt(Gi(r));t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Dx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class jx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class qx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),o=Gi(r);t[o]=this.createHttpProvider(o,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Lx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Mx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class zx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||xi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace);return typeof n>"u"?void 0:new Si(new Pi(n,Ze("disableProviderPing")))}}var Ux=Object.defineProperty,Hx=Object.defineProperties,kx=Object.getOwnPropertyDescriptors,af=Object.getOwnPropertySymbols,Kx=Object.prototype.hasOwnProperty,Bx=Object.prototype.propertyIsEnumerable,cf=(a,t,r)=>t in a?Ux(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,_o=(a,t)=>{for(var r in t||(t={}))Kx.call(t,r)&&cf(a,r,t[r]);if(af)for(var r of af(t))Bx.call(t,r)&&cf(a,r,t[r]);return a},Ic=(a,t)=>Hx(a,kx(t));class Zc{constructor(t){this.events=new Kc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||tf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Zc(t);return await r.initialize(),r}async request(t,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:_o({},t),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(t,r,n){const o=new Date().getTime();this.request(t,n).then(c=>r(null,jo(o,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Ft("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=Cx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==rp)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,o]=this.validateChain(t);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(bn(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ux.init({logger:this.providerOpts.logger||tf,relayUrl:this.providerOpts.relayUrl||mx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Jn(r)))];Ec("client",this.client),Ec("events",this.events),Ec("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=Rx(r,this.session),o=np(n),c=Ax(this.namespaces,this.optionalNamespaces),f=Ic(_o({},c[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new Nx({namespace:f});break;case"solana":this.rpcProviders[r]=new Dx({namespace:f});break;case"cosmos":this.rpcProviders[r]=new jx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new $x({namespace:f});break;case"cip34":this.rpcProviders[r]=new qx({namespace:f});break;case"elrond":this.rpcProviders[r]=new Lx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new Mx({namespace:f});break;case"near":this.rpcProviders[r]=new zx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&bn(o)&&this.events.emit("accountsChanged",o.map(Tx))}else if(n.name==="chainChanged"){const o=r.chainId,c=r.event.data,f=Jn(o),g=bc(o)!==bc(c)?`${f}:${bc(c)}`:o;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:o}=r,c=(n=this.client)==null?void 0:n.session.get(t);this.session=Ic(_o({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ic(_o({},Ft("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ui.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(f=>Jn(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Jn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[o,c]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(c),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${rf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${rf}/${t}`)}}const Fx=Zc,Vx="wc",Gx="ethereum_provider",Wx=`${Vx}@2:${Gx}:`,Jx="https://rpc.walletconnect.com/v1/",Uc=["eth_sendTransaction","personal_sign"],Qx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Hc=["chainChanged","accountsChanged"],Yx=["chainChanged","accountsChanged","message","disconnect","connect"];var Zx=Object.defineProperty,Xx=Object.defineProperties,eP=Object.getOwnPropertyDescriptors,uf=Object.getOwnPropertySymbols,tP=Object.prototype.hasOwnProperty,rP=Object.prototype.propertyIsEnumerable,hf=(a,t,r)=>t in a?Zx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Yn=(a,t)=>{for(var r in t||(t={}))tP.call(t,r)&&hf(a,r,t[r]);if(uf)for(var r of uf(t))rP.call(t,r)&&hf(a,r,t[r]);return a},lf=(a,t)=>Xx(a,eP(t));function Oo(a){return Number(a[0].split(":")[1])}function xc(a){return`0x${a.toString(16)}`}function iP(a){const{chains:t,optionalChains:r,methods:n,optionalMethods:o,events:c,optionalEvents:f,rpcMap:g}=a;if(!bn(t))throw new Error("Invalid chains");const v={chains:t,methods:n||Uc,events:c||Hc,rpcMap:Yn({},t.length?{[Oo(t)]:g[Oo(t)]}:{})},p=c==null?void 0:c.filter(D=>!Hc.includes(D)),_=n==null?void 0:n.filter(D=>!Uc.includes(D));if(!r&&!f&&!o&&!(p!=null&&p.length)&&!(_!=null&&_.length))return{required:t.length?v:void 0};const x=(p==null?void 0:p.length)&&(_==null?void 0:_.length)||!r,T={chains:[...new Set(x?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(o!=null&&o.length?o:Qx))],events:[...new Set(v.events.concat(f!=null&&f.length?f:Yx))],rpcMap:g};return{required:t.length?v:void 0,optional:r.length?T:void 0}}class Xc{constructor(){this.events=new yr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Wx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Xc;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=iP(this.rpc);try{const o=await new Promise(async(f,g)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(lf(Yn({namespaces:Yn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{f(p)}).catch(p=>{g(new Error(p.message))})});if(!o)return;const c=Iw(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:xc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",xc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",lf(Yn({},Ft("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",xc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,o]=t.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const o=(r=t==null?void 0:t.chains)!=null?r:[],c=(n=t==null?void 0:t.optionalChains)!=null?n:[],f=o.concat(c);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(t==null?void 0:t.methods)||Uc:[],v=o.length?(t==null?void 0:t.events)||Hc:[],p=(t==null?void 0:t.optionalMethods)||[],_=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),T=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:g,events:v,optionalMethods:p,optionalEvents:_,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:T,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Oo(this.rpc.chains):Oo(this.rpc.optionalChains),this.signer=await Fx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await xw(()=>import("./index-DQDEnq1p.js").then(o=>o.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Yn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:o}=t;r&&bn(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),n&&bn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${Jx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const IP=Xc;export{IP as EthereumProvider,Yx as OPTIONAL_EVENTS,Qx as OPTIONAL_METHODS,Hc as REQUIRED_EVENTS,Uc as REQUIRED_METHODS,Xc as default};
